{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.6", "generated_at": "2024-10-27T22:29:22.812661Z", "invocation_id": "88fdf0f5-854e-43ff-803c-97163b3937cc", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T22:29:16.052232Z", "completed_at": "2024-10-27T22:29:16.061901Z"}, {"name": "execute", "started_at": "2024-10-27T22:29:16.061901Z", "completed_at": "2024-10-27T22:29:21.171947Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.121370077133179, "adapter_response": {"_message": "CREATE TABLE (5.9k rows, 573.9 KiB processed)", "code": "CREATE TABLE", "rows_affected": 5877, "bytes_processed": 587686, "bytes_billed": 10485760, "location": "US", "project_id": "key-polymer-434418-m6", "job_id": "649c0394-98a3-4f18-af60-270933d3cdb0", "slot_ms": 128463}, "message": "CREATE TABLE (5.9k rows, 573.9 KiB processed)", "failures": null, "unique_id": "model.airnow_dbt.airnow_hist_stage", "compiled": true, "compiled_code": "/*** AirNow Historical Observations Staging Model ***/\n/**\nThe below model converts all columns, except for 'DateObserved,' to the correct data type. 'DateObserved' is already\na TIMESTAMP data type.\n**/\n\n\n\nWITH airnow_hist_source AS (\n    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`\n),\n\nairnow_hist_update AS (\n    SELECT\n        *,\n        CAST(HourObserved AS INT) AS HourObserved_update,\n        CAST(Latitude AS DECIMAL) AS Latitude_update,\n        CAST(Longitude AS DECIMAL) AS Longitude_update,\n        CAST(AQI AS INT) AQI_update,\n        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,\n        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber\n    FROM airnow_hist_source\n),\n\nairnow_hist_final AS (\n    SELECT\n        DateObserved,\n        HourObserved_update AS HourObserved,\n        LocalTimeZone,\n        ReportingArea,\n        StateCode,\n        Latitude_update AS Latitude,\n        Longitude_update AS Longitude,\n        ParameterName,\n        AQI_update AS AQI,\n        AQICategory,\n        AQICategoryNumber\n    FROM airnow_hist_update\n)\n\nSELECT \n    * \nFROM airnow_hist_final", "relation_name": "`key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`"}, {"status": "fail", "timing": [{"name": "compile", "started_at": "2024-10-27T22:29:21.184749Z", "completed_at": "2024-10-27T22:29:21.191600Z"}, {"name": "execute", "started_at": "2024-10-27T22:29:21.191600Z", "completed_at": "2024-10-27T22:29:22.812661Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.640714406967163, "adapter_response": {"_message": "SELECT (1.0 rows, 45.9 KiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 47016, "bytes_billed": 10485760, "location": "US", "project_id": "key-polymer-434418-m6", "job_id": "927088ce-64e1-4eaf-9399-1e5293f99a58", "slot_ms": 6201}, "message": "Got 1 result, configured to fail if != 0", "failures": 1, "unique_id": "test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99", "compiled": true, "compiled_code": "\n\nWITH date_range AS (\n    -- Dynamically calculate the minimum and maximum dates in the data\n    SELECT\n        MIN(DATE(DateObserved)) AS start_date,\n        MAX(DATE(DateObserved)) AS end_date\n    FROM\n        `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`\n),\n\ndate_spine AS (\n    -- Generate a date spine based on the calculated start and end dates\n    SELECT\n        start_date + INTERVAL n DAY AS date_day\n    FROM\n        date_range,\n        UNNEST(GENERATE_ARRAY(0, DATE_DIFF(end_date, start_date, DAY))) AS n\n),\n\nmissing_dates AS (\n    -- Find the missing dates by performing a LEFT JOIN between the date spine and the actual data\n    SELECT\n        ds.date_day\n    FROM\n        date_spine ds\n    LEFT JOIN (\n        SELECT DISTINCT DATE(DateObserved) AS date_day\n        FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`\n    ) AS model_dates\n    ON ds.date_day = model_dates.date_day\n    WHERE model_dates.date_day IS NULL\n)\n\n-- Return the missing dates\nSELECT *\nFROM missing_dates\n\n", "relation_name": null}], "elapsed_time": 7.764561176300049, "args": {"partial_parse_file_diff": true, "require_explicit_package_overrides_for_builtin_materializations": true, "require_resource_names_without_spaces": false, "write_json": true, "populate_cache": true, "indirect_selection": "eager", "resource_types": [], "cache_selected_only": false, "printer_width": 80, "warn_error_options": {"include": [], "exclude": []}, "partial_parse": true, "export_saved_queries": false, "target_path": "target\\airnow_dbt_dbt_assets-5fd17a4-f2d5ccb", "log_level": "info", "version_check": true, "log_format_file": "json", "show": false, "source_freshness_run_project_hooks": false, "vars": {}, "log_format": "json", "macro_debugging": false, "send_anonymous_usage_stats": false, "static_parser": true, "defer": false, "profiles_dir": "C:\\Users\\javier.flores\\.dbt", "introspect": true, "include_saved_query": false, "print": true, "which": "build", "select": ["airnow_dbt.airnow_staging.airnow_hist_stage"], "enable_legacy_logger": false, "quiet": false, "exclude_resource_types": [], "empty": false, "project_dir": "C:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt", "log_file_max_bytes": 10485760, "favor_state": false, "invocation_command": "dbt build --select airnow_dbt.airnow_staging.airnow_hist_stage", "log_level_file": "debug", "use_colors_file": true, "exclude": [], "strict_mode": false, "use_colors": true, "show_resource_report": false, "log_path": "C:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\target\\airnow_dbt_dbt_assets-5fd17a4-f2d5ccb"}}