[0m20:32:03.959447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67F1478F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D67E2888F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D601B28FE0>]}


============================== 20:32:03.959447 | d1020170-e3e2-4cd2-a428-5cbd7a9bd74e ==============================
[0m20:32:03.959447 [info ] [MainThread]: Running with dbt=1.8.6
[0m20:32:03.959447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:32:03.978956 [info ] [MainThread]: dbt version: 1.8.6
[0m20:32:03.978956 [info ] [MainThread]: python version: 3.12.3
[0m20:32:03.991018 [info ] [MainThread]: python path: C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\.venv\Scripts\python.exe
[0m20:32:03.991018 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m20:32:04.719624 [info ] [MainThread]: Using profiles dir at C:\Users\javier.flores\.dbt
[0m20:32:04.719624 [info ] [MainThread]: Using profiles.yml file at C:\Users\javier.flores\.dbt\profiles.yml
[0m20:32:04.719624 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\airnow_dbt\dbt_project.yml
[0m20:32:04.719624 [info ] [MainThread]: adapter type: bigquery
[0m20:32:04.724389 [info ] [MainThread]: adapter version: 1.8.2
[0m20:32:04.775954 [info ] [MainThread]: Configuration:
[0m20:32:04.775954 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:32:04.775954 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:32:04.775954 [info ] [MainThread]: Required dependencies:
[0m20:32:04.775954 [debug] [MainThread]: Executing "git --help"
[0m20:32:04.842402 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:32:04.842402 [debug] [MainThread]: STDERR: "b''"
[0m20:32:04.842402 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:32:04.842402 [info ] [MainThread]: Connection:
[0m20:32:04.842402 [info ] [MainThread]:   method: oauth
[0m20:32:04.842402 [info ] [MainThread]:   database: key-polymer-434418-m6
[0m20:32:04.842402 [info ] [MainThread]:   execution_project: key-polymer-434418-m6
[0m20:32:04.842402 [info ] [MainThread]:   schema: airnow_raw
[0m20:32:04.842402 [info ] [MainThread]:   location: US
[0m20:32:04.842402 [info ] [MainThread]:   priority: interactive
[0m20:32:04.842402 [info ] [MainThread]:   maximum_bytes_billed: None
[0m20:32:04.842402 [info ] [MainThread]:   impersonate_service_account: None
[0m20:32:04.852057 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m20:32:04.852057 [info ] [MainThread]:   job_retries: 1
[0m20:32:04.853057 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m20:32:04.853057 [info ] [MainThread]:   job_execution_timeout_seconds: 120
[0m20:32:04.854053 [info ] [MainThread]:   timeout_seconds: 120
[0m20:32:04.854053 [info ] [MainThread]:   client_id: None
[0m20:32:04.855049 [info ] [MainThread]:   token_uri: None
[0m20:32:04.855049 [info ] [MainThread]:   dataproc_region: None
[0m20:32:04.856324 [info ] [MainThread]:   dataproc_cluster_name: None
[0m20:32:04.856715 [info ] [MainThread]:   gcs_bucket: None
[0m20:32:04.856715 [info ] [MainThread]:   dataproc_batch: None
[0m20:32:04.857714 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m20:32:04.858712 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m20:32:04.858712 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:32:16.903420 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  Failed to authenticate with supplied credentials
  error:
  Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.'
[0m20:32:16.904402 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:32:16.906522 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:32:16.908514 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  Runtime Error
    Failed to authenticate with supplied credentials
    error:
    Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:32:16.911998 [debug] [MainThread]: Command `dbt debug` failed at 20:32:16.911998 after 13.11 seconds
[0m20:32:16.913029 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:32:16.914032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D62C4D8A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D62C5B6120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D601A2DC40>]}
[0m20:32:16.914032 [debug] [MainThread]: Flushing usage events
[0m20:39:42.951309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC99DF58B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC97899730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC99DF4650>]}


============================== 20:39:42.956299 | b522ec21-cf3f-417c-b795-d35c39eb8003 ==============================
[0m20:39:42.956299 [info ] [MainThread]: Running with dbt=1.8.6
[0m20:39:42.957910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:39:42.974019 [info ] [MainThread]: dbt version: 1.8.6
[0m20:39:42.974444 [info ] [MainThread]: python version: 3.12.3
[0m20:39:42.974444 [info ] [MainThread]: python path: C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\.venv\Scripts\python.exe
[0m20:39:42.975561 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m20:39:43.705823 [info ] [MainThread]: Using profiles dir at C:\Users\javier.flores\.dbt
[0m20:39:43.707489 [info ] [MainThread]: Using profiles.yml file at C:\Users\javier.flores\.dbt\profiles.yml
[0m20:39:43.707489 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\airnow_dbt\dbt_project.yml
[0m20:39:43.708486 [info ] [MainThread]: adapter type: bigquery
[0m20:39:43.708486 [info ] [MainThread]: adapter version: 1.8.2
[0m20:39:43.769977 [info ] [MainThread]: Configuration:
[0m20:39:43.770341 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:39:43.771354 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:39:43.771354 [info ] [MainThread]: Required dependencies:
[0m20:39:43.772350 [debug] [MainThread]: Executing "git --help"
[0m20:39:43.828707 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:39:43.828707 [debug] [MainThread]: STDERR: "b''"
[0m20:39:43.829896 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:39:43.829964 [info ] [MainThread]: Connection:
[0m20:39:43.831050 [info ] [MainThread]:   method: oauth
[0m20:39:43.832000 [info ] [MainThread]:   database: key-polymer-434418-m6
[0m20:39:43.832000 [info ] [MainThread]:   execution_project: key-polymer-434418-m6
[0m20:39:43.833020 [info ] [MainThread]:   schema: airnow_raw
[0m20:39:43.833020 [info ] [MainThread]:   location: US
[0m20:39:43.834046 [info ] [MainThread]:   priority: interactive
[0m20:39:43.835040 [info ] [MainThread]:   maximum_bytes_billed: None
[0m20:39:43.835040 [info ] [MainThread]:   impersonate_service_account: None
[0m20:39:43.836034 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m20:39:43.837039 [info ] [MainThread]:   job_retries: 1
[0m20:39:43.837642 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m20:39:43.837642 [info ] [MainThread]:   job_execution_timeout_seconds: 120
[0m20:39:43.838730 [info ] [MainThread]:   timeout_seconds: 120
[0m20:39:43.838730 [info ] [MainThread]:   client_id: None
[0m20:39:43.839723 [info ] [MainThread]:   token_uri: None
[0m20:39:43.839723 [info ] [MainThread]:   dataproc_region: None
[0m20:39:43.840736 [info ] [MainThread]:   dataproc_cluster_name: None
[0m20:39:43.840736 [info ] [MainThread]:   gcs_bucket: None
[0m20:39:43.841721 [info ] [MainThread]:   dataproc_batch: None
[0m20:39:43.842710 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m20:39:43.843720 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m20:39:43.843720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:55.943591 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: 'Runtime Error
  Failed to authenticate with supplied credentials
  error:
  Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.'
[0m20:39:55.944605 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m20:39:55.946586 [info ] [MainThread]: [31m1 check failed:[0m
[0m20:39:55.947585 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  Runtime Error
    Failed to authenticate with supplied credentials
    error:
    Your default credentials were not found. To set up Application Default Credentials, see https://cloud.google.com/docs/authentication/external/set-up-adc for more information.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m20:39:55.952719 [debug] [MainThread]: Command `dbt debug` failed at 20:39:55.951721 after 13.15 seconds
[0m20:39:55.953723 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:39:55.954712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC99988740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC2C4CD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ACC4E57470>]}
[0m20:39:55.954712 [debug] [MainThread]: Flushing usage events
[0m20:44:38.028972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010CF36180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010CF351C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010CF37B60>]}


============================== 20:44:38.035027 | b4bc4301-1c83-41a2-82e4-ad603a20184a ==============================
[0m20:44:38.035027 [info ] [MainThread]: Running with dbt=1.8.6
[0m20:44:38.037035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:44:38.049268 [info ] [MainThread]: dbt version: 1.8.6
[0m20:44:38.050204 [info ] [MainThread]: python version: 3.12.3
[0m20:44:38.051184 [info ] [MainThread]: python path: C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\.venv\Scripts\python.exe
[0m20:44:38.051184 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m20:44:38.772475 [info ] [MainThread]: Using profiles dir at C:\Users\javier.flores\.dbt
[0m20:44:38.773545 [info ] [MainThread]: Using profiles.yml file at C:\Users\javier.flores\.dbt\profiles.yml
[0m20:44:38.774584 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\airnow_dbt\dbt_project.yml
[0m20:44:38.774584 [info ] [MainThread]: adapter type: bigquery
[0m20:44:38.775577 [info ] [MainThread]: adapter version: 1.8.2
[0m20:44:38.836388 [info ] [MainThread]: Configuration:
[0m20:44:38.837354 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:44:38.838368 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:44:38.838970 [info ] [MainThread]: Required dependencies:
[0m20:44:38.839573 [debug] [MainThread]: Executing "git --help"
[0m20:44:38.895484 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:44:38.896487 [debug] [MainThread]: STDERR: "b''"
[0m20:44:38.896487 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:44:38.897491 [info ] [MainThread]: Connection:
[0m20:44:38.898632 [info ] [MainThread]:   method: service-account
[0m20:44:38.899630 [info ] [MainThread]:   database: key-polymer-434418-m6
[0m20:44:38.899630 [info ] [MainThread]:   execution_project: key-polymer-434418-m6
[0m20:44:38.901038 [info ] [MainThread]:   schema: airnow_raw
[0m20:44:38.901038 [info ] [MainThread]:   location: US
[0m20:44:38.901038 [info ] [MainThread]:   priority: interactive
[0m20:44:38.902364 [info ] [MainThread]:   maximum_bytes_billed: None
[0m20:44:38.902364 [info ] [MainThread]:   impersonate_service_account: None
[0m20:44:38.903375 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m20:44:38.903375 [info ] [MainThread]:   job_retries: 1
[0m20:44:38.904372 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m20:44:38.905368 [info ] [MainThread]:   job_execution_timeout_seconds: 120
[0m20:44:38.905368 [info ] [MainThread]:   timeout_seconds: 120
[0m20:44:38.906365 [info ] [MainThread]:   client_id: None
[0m20:44:38.906365 [info ] [MainThread]:   token_uri: None
[0m20:44:38.907361 [info ] [MainThread]:   dataproc_region: None
[0m20:44:38.907361 [info ] [MainThread]:   dataproc_cluster_name: None
[0m20:44:38.907361 [info ] [MainThread]:   gcs_bucket: None
[0m20:44:38.908358 [info ] [MainThread]:   dataproc_batch: None
[0m20:44:38.909354 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m20:44:38.909354 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m20:44:38.909354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:44:38.911356 [debug] [MainThread]: On debug: select 1 as id
[0m20:44:39.951146 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:de07569f-c191-41b9-89cb-ac1c9a05ecac&page=queryresults
[0m20:44:40.549094 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:44:40.551128 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:44:40.553095 [debug] [MainThread]: Command `dbt debug` succeeded at 20:44:40.553095 after 2.68 seconds
[0m20:44:40.554102 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:44:40.555179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010D2A74A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020136559730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010D475BB0>]}
[0m20:44:40.556171 [debug] [MainThread]: Flushing usage events
[0m20:45:23.777813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029647877650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029649B92AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029649B92480>]}


============================== 20:45:23.782346 | 4b177a78-0ebd-46ba-94f9-94274e5619be ==============================
[0m20:45:23.782346 [info ] [MainThread]: Running with dbt=1.8.6
[0m20:45:23.784357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:45:24.605045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b177a78-0ebd-46ba-94f9-94274e5619be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296720CA5A0>]}
[0m20:45:24.643411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b177a78-0ebd-46ba-94f9-94274e5619be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029672222630>]}
[0m20:45:24.645002 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m20:45:24.651359 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m20:45:24.756981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:45:24.757978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:45:24.781665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b177a78-0ebd-46ba-94f9-94274e5619be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029674CBC3B0>]}
[0m20:45:24.854360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b177a78-0ebd-46ba-94f9-94274e5619be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029674F26660>]}
[0m20:45:24.854360 [info ] [MainThread]: Found 2 models, 4 data tests, 473 macros
[0m20:45:24.854360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b177a78-0ebd-46ba-94f9-94274e5619be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029674C32990>]}
[0m20:45:24.854360 [info ] [MainThread]: 
[0m20:45:24.854360 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:45:24.862564 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m20:45:24.862564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:25.369657 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw'
[0m20:45:25.370644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:25.914189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b177a78-0ebd-46ba-94f9-94274e5619be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002964A3916D0>]}
[0m20:45:25.914347 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:45:25.915402 [info ] [MainThread]: 
[0m20:45:25.923641 [debug] [Thread-1 (]: Began running node model.airnow_dbt.my_first_dbt_model
[0m20:45:25.924296 [info ] [Thread-1 (]: 1 of 2 START sql table model airnow_raw.my_first_dbt_model ..................... [RUN]
[0m20:45:25.926293 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.my_first_dbt_model'
[0m20:45:25.927307 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.my_first_dbt_model
[0m20:45:25.938480 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.my_first_dbt_model"
[0m20:45:25.940437 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.my_first_dbt_model
[0m20:45:25.967829 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.my_first_dbt_model"
[0m20:45:25.971847 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:45:25.972778 [debug] [Thread-1 (]: On model.airnow_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.my_first_dbt_model"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_raw`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m20:45:26.624148 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:4695d640-3cfe-4cf6-b07d-02e07dda003d&page=queryresults
[0m20:45:28.706004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b177a78-0ebd-46ba-94f9-94274e5619be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029674FD02F0>]}
[0m20:45:28.707010 [info ] [Thread-1 (]: 1 of 2 OK created sql table model airnow_raw.my_first_dbt_model ................ [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.78s]
[0m20:45:28.708007 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.my_first_dbt_model
[0m20:45:28.709003 [debug] [Thread-3 (]: Began running node model.airnow_dbt.my_second_dbt_model
[0m20:45:28.710000 [info ] [Thread-3 (]: 2 of 2 START sql view model airnow_raw.my_second_dbt_model ..................... [RUN]
[0m20:45:28.710000 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.airnow_dbt.my_second_dbt_model'
[0m20:45:28.710997 [debug] [Thread-3 (]: Began compiling node model.airnow_dbt.my_second_dbt_model
[0m20:45:28.712990 [debug] [Thread-3 (]: Writing injected SQL for node "model.airnow_dbt.my_second_dbt_model"
[0m20:45:28.714613 [debug] [Thread-3 (]: Began executing node model.airnow_dbt.my_second_dbt_model
[0m20:45:28.730237 [debug] [Thread-3 (]: Writing runtime sql for node "model.airnow_dbt.my_second_dbt_model"
[0m20:45:28.732230 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:45:28.733227 [debug] [Thread-3 (]: On model.airnow_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.my_second_dbt_model"} */


  create or replace view `key-polymer-434418-m6`.`airnow_raw`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `key-polymer-434418-m6`.`airnow_raw`.`my_first_dbt_model`
where id = 1;


[0m20:45:29.421904 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:a22e9881-37bd-4012-8a34-87f2c9f8b838&page=queryresults
[0m20:45:29.960210 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b177a78-0ebd-46ba-94f9-94274e5619be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029675045070>]}
[0m20:45:29.961195 [info ] [Thread-3 (]: 2 of 2 OK created sql view model airnow_raw.my_second_dbt_model ................ [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m20:45:29.963180 [debug] [Thread-3 (]: Finished running node model.airnow_dbt.my_second_dbt_model
[0m20:45:29.965968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:29.965968 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m20:45:29.967039 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw' was properly closed.
[0m20:45:29.967039 [debug] [MainThread]: Connection 'model.airnow_dbt.my_first_dbt_model' was properly closed.
[0m20:45:29.967991 [debug] [MainThread]: Connection 'model.airnow_dbt.my_second_dbt_model' was properly closed.
[0m20:45:29.967991 [info ] [MainThread]: 
[0m20:45:29.969048 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m20:45:29.970985 [debug] [MainThread]: Command end result
[0m20:45:29.994327 [info ] [MainThread]: 
[0m20:45:29.995358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:45:29.995898 [info ] [MainThread]: 
[0m20:45:29.996901 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m20:45:29.997905 [debug] [MainThread]: Command `dbt run` succeeded at 20:45:29.997905 after 6.35 seconds
[0m20:45:29.997905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029647F11280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296469B8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029649371A30>]}
[0m20:45:29.998891 [debug] [MainThread]: Flushing usage events
[0m15:19:42.152787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AB006C1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AB02049B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AAF189160>]}


============================== 15:19:42.152787 | 17955af5-02df-4fad-a8be-a0a29249287f ==============================
[0m15:19:42.152787 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:19:42.152787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:19:43.279876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17955af5-02df-4fad-a8be-a0a29249287f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADD452FC0>]}
[0m15:19:43.319509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17955af5-02df-4fad-a8be-a0a29249287f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADD2B4E00>]}
[0m15:19:43.319509 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:19:43.329588 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m15:19:43.384897 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:19:43.384897 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m15:19:43.384897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17955af5-02df-4fad-a8be-a0a29249287f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADD654530>]}
[0m15:19:44.403102 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m15:19:44.418270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17955af5-02df-4fad-a8be-a0a29249287f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADD657EF0>]}
[0m15:19:44.501531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17955af5-02df-4fad-a8be-a0a29249287f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADD95C770>]}
[0m15:19:44.501531 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 473 macros
[0m15:19:44.501531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17955af5-02df-4fad-a8be-a0a29249287f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADD91E780>]}
[0m15:19:44.501531 [info ] [MainThread]: 
[0m15:19:44.501531 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:19:44.501531 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m15:19:44.501531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:56.665716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_key-polymer-434418-m6, now create_key-polymer-434418-m6_airnow_raw_staging)
[0m15:19:56.665716 [debug] [ThreadPool]: Creating schema "database: "key-polymer-434418-m6"
schema: "airnow_raw_staging"
"
[0m15:19:56.680424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:56.680424 [debug] [ThreadPool]: On create_key-polymer-434418-m6_airnow_raw_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "connection_name": "create_key-polymer-434418-m6_airnow_raw_staging"} */
create schema if not exists `key-polymer-434418-m6`.`airnow_raw_staging`
  
[0m15:19:57.529371 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:70f792db-403d-4cd7-b9a7-9ab3a8d65191&page=queryresults
[0m15:19:58.599713 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw'
[0m15:19:58.600712 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_staging'
[0m15:19:58.601712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:58.601712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:59.920249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17955af5-02df-4fad-a8be-a0a29249287f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADD8E13A0>]}
[0m15:19:59.927299 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:19:59.928272 [info ] [MainThread]: 
[0m15:19:59.928272 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_test_model
[0m15:19:59.928272 [info ] [Thread-1 (]: 1 of 1 START sql view model airnow_raw_staging.airnow_test_model ............... [RUN]
[0m15:19:59.928272 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_test_model'
[0m15:19:59.928272 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_test_model
[0m15:19:59.949052 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_test_model"
[0m15:19:59.949052 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_test_model
[0m15:19:59.966527 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_test_model"
[0m15:19:59.966527 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:19:59.966527 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_test_model: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_test_model"} */


  create or replace view `key-polymer-434418-m6`.`airnow_raw_staging`.`airnow_test_model`
  OPTIONS()
  as 

WITH hist_test AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
)

SELECT * FROM hist_test;


[0m15:20:07.732634 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:8007dd08-fc44-4b67-b8c0-afc4ea8c4286&page=queryresults
[0m15:20:08.124048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17955af5-02df-4fad-a8be-a0a29249287f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ADBA327B0>]}
[0m15:20:08.124048 [info ] [Thread-1 (]: 1 of 1 OK created sql view model airnow_raw_staging.airnow_test_model .......... [[32mCREATE VIEW (0 processed)[0m in 8.20s]
[0m15:20:08.124048 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_test_model
[0m15:20:08.124048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:20:08.124048 [debug] [MainThread]: Connection 'create_key-polymer-434418-m6_airnow_raw_staging' was properly closed.
[0m15:20:08.124048 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw' was properly closed.
[0m15:20:08.124048 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_staging' was properly closed.
[0m15:20:08.124048 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_test_model' was properly closed.
[0m15:20:08.124048 [info ] [MainThread]: 
[0m15:20:08.124048 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 23.62 seconds (23.62s).
[0m15:20:08.124048 [debug] [MainThread]: Command end result
[0m15:20:08.140652 [info ] [MainThread]: 
[0m15:20:08.152954 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:20:08.153543 [info ] [MainThread]: 
[0m15:20:08.153543 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:20:08.155241 [debug] [MainThread]: Command `cli run` succeeded at 15:20:08.154239 after 26.16 seconds
[0m15:20:08.155241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AB006C1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AB29E2D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AB1E14BC0>]}
[0m15:20:08.156242 [debug] [MainThread]: Flushing usage events
[0m15:48:23.776885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2DA23D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2DA21B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2DA21910>]}


============================== 15:48:23.782851 | 9905b812-2629-4daf-8210-cfaff24e8ed7 ==============================
[0m15:48:23.782851 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:48:23.783856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:24.676439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9905b812-2629-4daf-8210-cfaff24e8ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2D344E00>]}
[0m15:48:24.715425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9905b812-2629-4daf-8210-cfaff24e8ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2D344E00>]}
[0m15:48:24.716263 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:48:24.722347 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:48:24.841559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:24.841559 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:24.845302 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m15:48:24.873621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9905b812-2629-4daf-8210-cfaff24e8ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B58DEBF20>]}
[0m15:48:24.901705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9905b812-2629-4daf-8210-cfaff24e8ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B58EEE000>]}
[0m15:48:24.901705 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 473 macros
[0m15:48:24.902702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9905b812-2629-4daf-8210-cfaff24e8ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B58CB1C40>]}
[0m15:48:24.905386 [info ] [MainThread]: 
[0m15:48:24.906448 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:48:24.909787 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw'
[0m15:48:24.909787 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_staging'
[0m15:48:24.910822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:24.910822 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:25.858965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9905b812-2629-4daf-8210-cfaff24e8ed7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B58EC30B0>]}
[0m15:48:25.859889 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:48:25.861397 [info ] [MainThread]: 
[0m15:48:25.868621 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_test_model
[0m15:48:25.869632 [debug] [Thread-2 (]: Began running node model.airnow_dbt.my_first_dbt_model
[0m15:48:25.870627 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_test_model'
[0m15:48:25.871624 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.airnow_dbt.my_first_dbt_model'
[0m15:48:25.871624 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_test_model
[0m15:48:25.872621 [debug] [Thread-2 (]: Began compiling node model.airnow_dbt.my_first_dbt_model
[0m15:48:25.880130 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_test_model"
[0m15:48:25.882051 [debug] [Thread-2 (]: Writing injected SQL for node "model.airnow_dbt.my_first_dbt_model"
[0m15:48:25.884050 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_test_model
[0m15:48:25.884050 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_test_model
[0m15:48:25.885551 [debug] [Thread-2 (]: Began executing node model.airnow_dbt.my_first_dbt_model
[0m15:48:25.886554 [debug] [Thread-2 (]: Finished running node model.airnow_dbt.my_first_dbt_model
[0m15:48:25.887556 [debug] [Thread-4 (]: Began running node model.airnow_dbt.my_second_dbt_model
[0m15:48:25.887556 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.airnow_dbt.my_second_dbt_model'
[0m15:48:25.888556 [debug] [Thread-3 (]: Began running node test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:48:25.888556 [debug] [Thread-1 (]: Began running node test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321
[0m15:48:25.888556 [debug] [Thread-4 (]: Began compiling node model.airnow_dbt.my_second_dbt_model
[0m15:48:25.889593 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:48:25.890556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airnow_dbt.airnow_test_model, now test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m15:48:25.891867 [debug] [Thread-4 (]: Writing injected SQL for node "model.airnow_dbt.my_second_dbt_model"
[0m15:48:25.892866 [debug] [Thread-3 (]: Began compiling node test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:48:25.892866 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321
[0m15:48:25.902380 [debug] [Thread-3 (]: Writing injected SQL for node "test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:48:25.907888 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m15:48:25.908914 [debug] [Thread-4 (]: Began executing node model.airnow_dbt.my_second_dbt_model
[0m15:48:25.910044 [debug] [Thread-4 (]: Finished running node model.airnow_dbt.my_second_dbt_model
[0m15:48:25.911045 [debug] [Thread-2 (]: Began running node test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m15:48:25.911045 [debug] [Thread-4 (]: Began running node test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m15:48:25.912043 [debug] [Thread-3 (]: Began executing node test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:48:25.912043 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321
[0m15:48:25.913049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airnow_dbt.my_first_dbt_model, now test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m15:48:25.913049 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airnow_dbt.my_second_dbt_model, now test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m15:48:25.914044 [debug] [Thread-3 (]: Finished running node test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:48:25.915043 [debug] [Thread-1 (]: Finished running node test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321
[0m15:48:25.915546 [debug] [Thread-2 (]: Began compiling node test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m15:48:25.915546 [debug] [Thread-4 (]: Began compiling node test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m15:48:25.920549 [debug] [Thread-2 (]: Writing injected SQL for node "test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m15:48:25.923633 [debug] [Thread-4 (]: Writing injected SQL for node "test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:48:25.934192 [debug] [Thread-2 (]: Began executing node test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m15:48:25.934192 [debug] [Thread-4 (]: Began executing node test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m15:48:25.935195 [debug] [Thread-2 (]: Finished running node test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m15:48:25.936443 [debug] [Thread-4 (]: Finished running node test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m15:48:25.938475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:25.938475 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw' was properly closed.
[0m15:48:25.938475 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_staging' was properly closed.
[0m15:48:25.938475 [debug] [MainThread]: Connection 'test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:48:25.939441 [debug] [MainThread]: Connection 'test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m15:48:25.939441 [debug] [MainThread]: Connection 'test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:48:25.940442 [debug] [MainThread]: Connection 'test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:48:25.941442 [debug] [MainThread]: Command end result
[0m15:48:26.012076 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m15:48:26.012076 [info ] [MainThread]: Building catalog
[0m15:48:26.016587 [debug] [ThreadPool]: Acquiring new bigquery connection 'key-polymer-434418-m6.information_schema'
[0m15:48:26.023586 [debug] [ThreadPool]: Acquiring new bigquery connection 'key-polymer-434418-m6.information_schema'
[0m15:48:26.032093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:26.034093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:26.036240 [debug] [ThreadPool]: On key-polymer-434418-m6.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "connection_name": "key-polymer-434418-m6.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `key-polymer-434418-m6`.`airnow_raw`.__TABLES__ tables
    left join `key-polymer-434418-m6`.`airnow_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `key-polymer-434418-m6`.`airnow_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('airnow_raw')
                            and upper(table_name) = upper('my_second_dbt_model')
                            ) or (
                                upper(table_schema) = upper('airnow_raw')
                            and upper(table_name) = upper('airnow_raw_realtime')
                            ) or (
                                upper(table_schema) = upper('airnow_raw')
                            and upper(table_name) = upper('my_first_dbt_model')
                            ) or (
                                upper(table_schema) = upper('airnow_raw')
                            and upper(table_name) = upper('airnow_hist_raw')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `key-polymer-434418-m6`.`airnow_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `key-polymer-434418-m6`.`airnow_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m15:48:26.038241 [debug] [ThreadPool]: On key-polymer-434418-m6.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "connection_name": "key-polymer-434418-m6.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `key-polymer-434418-m6`.`airnow_raw_staging`.__TABLES__ tables
    left join `key-polymer-434418-m6`.`airnow_raw_staging`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `key-polymer-434418-m6`.`airnow_raw_staging`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('airnow_raw_staging')
                            and upper(table_name) = upper('airnow_test_model')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `key-polymer-434418-m6`.`airnow_raw_staging`.INFORMATION_SCHEMA.COLUMNS columns
    join `key-polymer-434418-m6`.`airnow_raw_staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m15:48:26.962594 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:cf928230-4de9-47ae-ae11-3f77b4480333&page=queryresults
[0m15:48:27.033291 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:617529b2-31b9-49b4-8110-d0af3320e8f4&page=queryresults
[0m15:48:29.277555 [info ] [MainThread]: Catalog written to C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\airnow_dbt\target\catalog.json
[0m15:48:29.278556 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:48:29.278556 after 5.65 seconds
[0m15:48:29.279634 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:48:29.279634 [debug] [MainThread]: Connection 'key-polymer-434418-m6.information_schema' was properly closed.
[0m15:48:29.280636 [debug] [MainThread]: Connection 'key-polymer-434418-m6.information_schema' was properly closed.
[0m15:48:29.280636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2DAA9B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B589F2780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028B2B8E5F40>]}
[0m15:48:29.281595 [debug] [MainThread]: Flushing usage events
[0m15:48:56.771393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C38C3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C62BCF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C62BC770>]}


============================== 15:48:56.774389 | 8b7c4ce2-d995-4cb7-8793-b9d8c1788ca7 ==============================
[0m15:48:56.774389 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:48:56.774969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:57.602033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b7c4ce2-d995-4cb7-8793-b9d8c1788ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F0CA4C50>]}
[0m15:48:57.643116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b7c4ce2-d995-4cb7-8793-b9d8c1788ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C3E88D40>]}
[0m15:48:57.643116 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:48:57.650117 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m15:48:57.772100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:57.773102 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:57.776101 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m15:48:57.804479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b7c4ce2-d995-4cb7-8793-b9d8c1788ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2EE13B140>]}
[0m15:48:57.823016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b7c4ce2-d995-4cb7-8793-b9d8c1788ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F0FC1EB0>]}
[0m15:48:57.824018 [info ] [MainThread]: Found 3 models, 4 data tests, 2 sources, 473 macros
[0m15:48:57.825016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b7c4ce2-d995-4cb7-8793-b9d8c1788ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F0F92660>]}
[0m15:48:57.827096 [info ] [MainThread]: 
[0m15:48:57.827562 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:48:57.830929 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_staging'
[0m15:48:57.831933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:57.831933 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw'
[0m15:48:57.858923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:58.564332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b7c4ce2-d995-4cb7-8793-b9d8c1788ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F0CA4C80>]}
[0m15:48:58.565330 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:48:58.566336 [info ] [MainThread]: 
[0m15:48:58.573551 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_test_model
[0m15:48:58.574553 [debug] [Thread-2 (]: Began running node model.airnow_dbt.my_first_dbt_model
[0m15:48:58.575553 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_test_model'
[0m15:48:58.576548 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.airnow_dbt.my_first_dbt_model'
[0m15:48:58.577488 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_test_model
[0m15:48:58.578482 [debug] [Thread-2 (]: Began compiling node model.airnow_dbt.my_first_dbt_model
[0m15:48:58.587080 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_test_model"
[0m15:48:58.590000 [debug] [Thread-2 (]: Writing injected SQL for node "model.airnow_dbt.my_first_dbt_model"
[0m15:48:58.591034 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_test_model
[0m15:48:58.592001 [debug] [Thread-2 (]: Began executing node model.airnow_dbt.my_first_dbt_model
[0m15:48:58.593000 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_test_model
[0m15:48:58.593000 [debug] [Thread-2 (]: Finished running node model.airnow_dbt.my_first_dbt_model
[0m15:48:58.594999 [debug] [Thread-4 (]: Began running node model.airnow_dbt.my_second_dbt_model
[0m15:48:58.594999 [debug] [Thread-3 (]: Began running node test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:48:58.596026 [debug] [Thread-1 (]: Began running node test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321
[0m15:48:58.596026 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.airnow_dbt.my_second_dbt_model'
[0m15:48:58.597069 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:48:58.598006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.airnow_dbt.airnow_test_model, now test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m15:48:58.598006 [debug] [Thread-4 (]: Began compiling node model.airnow_dbt.my_second_dbt_model
[0m15:48:58.599004 [debug] [Thread-3 (]: Began compiling node test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:48:58.599004 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321
[0m15:48:58.602000 [debug] [Thread-4 (]: Writing injected SQL for node "model.airnow_dbt.my_second_dbt_model"
[0m15:48:58.610392 [debug] [Thread-3 (]: Writing injected SQL for node "test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:48:58.615392 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m15:48:58.616438 [debug] [Thread-4 (]: Began executing node model.airnow_dbt.my_second_dbt_model
[0m15:48:58.617453 [debug] [Thread-4 (]: Finished running node model.airnow_dbt.my_second_dbt_model
[0m15:48:58.618453 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321
[0m15:48:58.619453 [debug] [Thread-1 (]: Finished running node test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321
[0m15:48:58.619453 [debug] [Thread-2 (]: Began running node test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m15:48:58.620454 [debug] [Thread-4 (]: Began running node test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m15:48:58.620454 [debug] [Thread-3 (]: Began executing node test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:48:58.621453 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.airnow_dbt.my_first_dbt_model, now test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m15:48:58.622185 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.airnow_dbt.my_second_dbt_model, now test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m15:48:58.623236 [debug] [Thread-3 (]: Finished running node test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:48:58.623236 [debug] [Thread-2 (]: Began compiling node test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m15:48:58.624188 [debug] [Thread-4 (]: Began compiling node test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m15:48:58.627268 [debug] [Thread-2 (]: Writing injected SQL for node "test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m15:48:58.631268 [debug] [Thread-4 (]: Writing injected SQL for node "test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:48:58.631563 [debug] [Thread-2 (]: Began executing node test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m15:48:58.632578 [debug] [Thread-4 (]: Began executing node test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m15:48:58.633618 [debug] [Thread-2 (]: Finished running node test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m15:48:58.633618 [debug] [Thread-4 (]: Finished running node test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m15:48:58.635813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:58.635813 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_staging' was properly closed.
[0m15:48:58.636818 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw' was properly closed.
[0m15:48:58.636818 [debug] [MainThread]: Connection 'test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:48:58.636818 [debug] [MainThread]: Connection 'test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m15:48:58.638268 [debug] [MainThread]: Connection 'test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:48:58.638268 [debug] [MainThread]: Connection 'test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:48:58.639276 [debug] [MainThread]: Command end result
[0m15:48:58.704100 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m15:48:58.704100 [info ] [MainThread]: Building catalog
[0m15:48:58.708098 [debug] [ThreadPool]: Acquiring new bigquery connection 'key-polymer-434418-m6.information_schema'
[0m15:48:58.722098 [debug] [ThreadPool]: Acquiring new bigquery connection 'key-polymer-434418-m6.information_schema'
[0m15:48:58.723099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:58.726099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:58.727100 [debug] [ThreadPool]: On key-polymer-434418-m6.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "connection_name": "key-polymer-434418-m6.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `key-polymer-434418-m6`.`airnow_raw_staging`.__TABLES__ tables
    left join `key-polymer-434418-m6`.`airnow_raw_staging`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `key-polymer-434418-m6`.`airnow_raw_staging`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('airnow_raw_staging')
                            and upper(table_name) = upper('airnow_test_model')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `key-polymer-434418-m6`.`airnow_raw_staging`.INFORMATION_SCHEMA.COLUMNS columns
    join `key-polymer-434418-m6`.`airnow_raw_staging`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m15:48:58.729147 [debug] [ThreadPool]: On key-polymer-434418-m6.information_schema: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "connection_name": "key-polymer-434418-m6.information_schema"} */

    with
                table_shards_stage as (
    select
        tables.project_id as table_catalog,
        tables.dataset_id as table_schema,
        coalesce(REGEXP_EXTRACT(tables.table_id, '^(.+)[0-9]{8}$'), tables.table_id) as table_name,
        tables.table_id as shard_name,
        REGEXP_EXTRACT(tables.table_id, '^.+([0-9]{8})$') as shard_index,
        REGEXP_CONTAINS(tables.table_id, '^.+[0-9]{8}$') and tables.type = 1 as is_date_shard,
        case
            when materialized_views.table_name is not null then 'materialized view'
            when tables.type = 1 then 'table'
            when tables.type = 2 then 'view'
            else 'external'
        end as table_type,
        tables.type = 1 as is_table,
        JSON_VALUE(table_description.option_value) as table_comment,
        tables.size_bytes,
        tables.row_count
    from `key-polymer-434418-m6`.`airnow_raw`.__TABLES__ tables
    left join `key-polymer-434418-m6`.`airnow_raw`.INFORMATION_SCHEMA.MATERIALIZED_VIEWS materialized_views
        on materialized_views.table_catalog = tables.project_id
        and materialized_views.table_schema = tables.dataset_id
        and materialized_views.table_name = tables.table_id
    left join `key-polymer-434418-m6`.`airnow_raw`.INFORMATION_SCHEMA.TABLE_OPTIONS table_description
        on table_description.table_catalog = tables.project_id
        and table_description.table_schema = tables.dataset_id
        and table_description.table_name = tables.table_id
        and table_description.option_name = 'description'
),
                table_shards as (
                    select * from table_shards_stage
                    where ((
                                upper(table_schema) = upper('airnow_raw')
                            and upper(table_name) = upper('my_first_dbt_model')
                            ) or (
                                upper(table_schema) = upper('airnow_raw')
                            and upper(table_name) = upper('airnow_raw_realtime')
                            ) or (
                                upper(table_schema) = upper('airnow_raw')
                            and upper(table_name) = upper('my_second_dbt_model')
                            ) or (
                                upper(table_schema) = upper('airnow_raw')
                            and upper(table_name) = upper('airnow_hist_raw')
                            ))
                ),
                tables as (
    select distinct
        table_catalog,
        table_schema,
        table_name,
        is_date_shard,
        table_type,
        is_table,
        table_comment
    from table_shards
),
                table_stats as (
    select
        table_catalog,
        table_schema,
        table_name,
        max(shard_name) as latest_shard_name,
        min(shard_index) as shard_min,
        max(shard_index) as shard_max,
        count(shard_index) as shard_count,
        sum(size_bytes) as size_bytes,
        sum(row_count) as row_count
    from table_shards
    group by 1, 2, 3
),

                columns as (
    select
        columns.table_catalog,
        columns.table_schema,
        columns.table_name as shard_name,
        coalesce(paths.field_path, '<unknown>') as column_name,
        -- invent a row number to account for nested fields
        -- BQ does not treat these nested properties as independent fields
        row_number() over (
            partition by
                columns.table_catalog,
                columns.table_schema,
                columns.table_name
            order by
                columns.ordinal_position,
                paths.field_path
        ) as column_index,
        coalesce(paths.data_type, '<unknown>') as column_type,
        paths.description as column_comment,
        case when columns.is_partitioning_column = 'YES' then 1 else 0 end as is_partitioning_column,
        case when columns.is_partitioning_column = 'YES' then paths.field_path end as partition_column,
        case when columns.clustering_ordinal_position is not null then 1 else 0 end as is_clustering_column,
        case when columns.clustering_ordinal_position is not null then paths.field_path end as cluster_column,
        columns.clustering_ordinal_position
    from `key-polymer-434418-m6`.`airnow_raw`.INFORMATION_SCHEMA.COLUMNS columns
    join `key-polymer-434418-m6`.`airnow_raw`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS paths
        on paths.table_catalog = columns.table_catalog
        and paths.table_schema = columns.table_schema
        and paths.table_name = columns.table_name
        and paths.column_name = columns.column_name
    where columns.ordinal_position is not null
),
                column_stats as (
    select
        table_catalog,
        table_schema,
        shard_name,
        max(is_partitioning_column) = 1 as is_partitioned,
        max(partition_column) as partition_column,
        max(is_clustering_column) = 1 as is_clustered,
        array_to_string(
            array_agg(
                cluster_column ignore nulls
                order by clustering_ordinal_position
            ), ', '
        ) as clustering_columns
    from columns
    group by 1, 2, 3
)

            
    select
        tables.table_catalog as table_database,
        tables.table_schema,
        case
            when tables.is_date_shard then concat(tables.table_name, '*')
            else tables.table_name
        end as table_name,
        tables.table_type,
        tables.table_comment,
        -- coalesce column metadata fields to ensure they are non-null for catalog generation
        -- external table columns are not present in COLUMN_FIELD_PATHS
        coalesce(columns.column_name, '<unknown>') as column_name,
        coalesce(columns.column_index, 1) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        coalesce(columns.column_comment, '') as column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_stats.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        tables.is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_stats.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        tables.is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_stats.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        tables.is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        table_stats.row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        tables.is_table as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        table_stats.size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        tables.is_table as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        column_stats.partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        column_stats.is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        column_stats.clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        column_stats.is_clustered as `stats__clustering_fields__include`

    from tables
    join table_stats
        on table_stats.table_catalog = tables.table_catalog
        and table_stats.table_schema = tables.table_schema
        and table_stats.table_name = tables.table_name
    left join column_stats
        on column_stats.table_catalog = tables.table_catalog
        and column_stats.table_schema = tables.table_schema
        and column_stats.shard_name = table_stats.latest_shard_name
    left join columns
        on columns.table_catalog = tables.table_catalog
        and columns.table_schema = tables.table_schema
        and columns.shard_name = table_stats.latest_shard_name

  
[0m15:48:59.642991 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:f3316230-e581-48a7-8c2b-0852723193ae&page=queryresults
[0m15:48:59.659024 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:fa334b3f-0edb-49c0-a6af-4f30409c7fb3&page=queryresults
[0m15:49:01.507127 [info ] [MainThread]: Catalog written to C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\airnow_dbt\target\catalog.json
[0m15:49:01.509047 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:49:01.509047 after 4.88 seconds
[0m15:49:01.509047 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:49:01.510047 [debug] [MainThread]: Connection 'key-polymer-434418-m6.information_schema' was properly closed.
[0m15:49:01.510047 [debug] [MainThread]: Connection 'key-polymer-434418-m6.information_schema' was properly closed.
[0m15:49:01.510047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C29F8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2C3356AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2F0E0E900>]}
[0m15:49:01.511047 [debug] [MainThread]: Flushing usage events
[0m15:51:34.301322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255DFBD3F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E160E240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255DFADB410>]}


============================== 15:51:34.304412 | 7e960520-78d9-447b-9654-0a98558c4a5a ==============================
[0m15:51:34.304412 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:51:34.305563 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:51:35.151077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e960520-78d9-447b-9654-0a98558c4a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E2612B40>]}
[0m15:51:35.191903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e960520-78d9-447b-9654-0a98558c4a5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255FEF22630>]}
[0m15:53:06.053645 [error] [MainThread]: Encountered an error:

[0m15:53:06.071581 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\.venv\Lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\.venv\Lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\.venv\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\.venv\Lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\.venv\Lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\.venv\Lib\site-packages\dbt\cli\main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\javier.flores\Desktop\Portfolio\Air Quality Data Streaming and Anomaly Detection\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\javier.flores\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 240, in serve_forever
    self._handle_request_noblock()
  File "C:\Users\javier.flores\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 318, in _handle_request_noblock
    self.process_request(request, client_address)
  File "C:\Users\javier.flores\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 349, in process_request
    self.finish_request(request, client_address)
  File "C:\Users\javier.flores\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "C:\Users\javier.flores\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 672, in __init__
    super().__init__(*args, **kwargs)
  File "C:\Users\javier.flores\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 761, in __init__
    self.handle()
  File "C:\Users\javier.flores\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 436, in handle
    self.handle_one_request()
  File "C:\Users\javier.flores\AppData\Local\Programs\Python\Python312\Lib\http\server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\javier.flores\AppData\Local\Programs\Python\Python312\Lib\socket.py", line 707, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:53:06.078198 [debug] [MainThread]: Command `dbt docs serve` failed at 15:53:06.078198 after 91.93 seconds
[0m15:53:06.079198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E23DFE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255FFD65730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002558D033590>]}
[0m15:53:06.080195 [debug] [MainThread]: Flushing usage events
[0m17:24:09.026198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34B2B5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C349633B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34C002C00>]}


============================== 17:24:09.031713 | d1e0b039-ac80-4c2c-ba20-9ffb33a91df3 ==============================
[0m17:24:09.031713 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:24:09.032709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:24:09.988579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1e0b039-ac80-4c2c-ba20-9ffb33a91df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C349BBE330>]}
[0m17:24:10.030451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1e0b039-ac80-4c2c-ba20-9ffb33a91df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3769A1DF0>]}
[0m17:24:10.030451 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:24:10.036545 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:24:10.101822 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:24:10.101822 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:24:10.102822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1e0b039-ac80-4c2c-ba20-9ffb33a91df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34B8994C0>]}
[0m17:24:11.067784 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m17:24:11.074292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1e0b039-ac80-4c2c-ba20-9ffb33a91df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C376D38980>]}
[0m17:24:11.149860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1e0b039-ac80-4c2c-ba20-9ffb33a91df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C376B1F2C0>]}
[0m17:24:11.149932 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 473 macros
[0m17:24:11.150864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1e0b039-ac80-4c2c-ba20-9ffb33a91df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C376EC09B0>]}
[0m17:24:11.151865 [info ] [MainThread]: 
[0m17:24:11.152864 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:24:11.153862 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:24:11.153862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:12.087673 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw'
[0m17:24:12.088651 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_staging'
[0m17:24:12.090305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:12.091345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:12.807490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1e0b039-ac80-4c2c-ba20-9ffb33a91df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C376A74F20>]}
[0m17:24:12.808503 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:24:12.808503 [info ] [MainThread]: 
[0m17:24:12.812495 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m17:24:12.813994 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_raw_staging.airnow_hist_stage .............. [RUN]
[0m17:24:12.813994 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m17:24:12.815006 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m17:24:12.820693 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m17:24:12.822699 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m17:24:12.850488 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m17:24:12.852493 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:24:12.854493 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_raw_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      

WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS FLOAT) AS Latitude_update,
        CAST(Longitude AS FLOAT) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Caregory, '$.Name') AS AQICategory,
        JSON_EXTRACT_SCALAR(Category, '$.Number') AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT * FROM airnow_hist_final
;
    );
  
[0m17:24:13.608509 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:2686a85d-1552-4284-bc3e-5b2c40769c48&page=queryresults
[0m17:24:13.608509 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [48:1]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [48:1]')
[0m17:24:14.193982 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:57628294-72bb-4882-bc7b-6a11bda487f5&page=queryresults
[0m17:24:14.195979 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:57628294-72bb-4882-bc7b-6a11bda487f5&page=queryresults
[0m17:24:14.221588 [debug] [Thread-1 (]: Database Error in model airnow_hist_stage (models\airnow_staging\airnow_hist_stage.sql)
  Syntax error: Expected ")" but got ";" at [48:1]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\airnow_hist_stage.sql
[0m17:24:14.222591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1e0b039-ac80-4c2c-ba20-9ffb33a91df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34B89A7B0>]}
[0m17:24:14.223593 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model airnow_raw_staging.airnow_hist_stage ..... [[31mERROR[0m in 1.41s]
[0m17:24:14.223593 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m17:24:14.226158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:14.226158 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m17:24:14.227250 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw' was properly closed.
[0m17:24:14.227250 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_staging' was properly closed.
[0m17:24:14.227250 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m17:24:14.228243 [info ] [MainThread]: 
[0m17:24:14.228243 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m17:24:14.228243 [debug] [MainThread]: Command end result
[0m17:24:14.252046 [info ] [MainThread]: 
[0m17:24:14.252046 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:24:14.252963 [info ] [MainThread]: 
[0m17:24:14.252963 [error] [MainThread]:   Database Error in model airnow_hist_stage (models\airnow_staging\airnow_hist_stage.sql)
  Syntax error: Expected ")" but got ";" at [48:1]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\airnow_hist_stage.sql
[0m17:24:14.253981 [info ] [MainThread]: 
[0m17:24:14.253981 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:24:14.254939 [debug] [MainThread]: Command `cli run` failed at 17:24:14.254939 after 5.38 seconds
[0m17:24:14.254939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34B918680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34C1824E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34B1324B0>]}
[0m17:24:14.256021 [debug] [MainThread]: Flushing usage events
[0m17:26:18.538106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BA80E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BA1EA3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156B9D07FB0>]}


============================== 17:26:18.542099 | 7ac65025-9632-4cdd-93f1-f5311904c054 ==============================
[0m17:26:18.542099 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:26:18.543013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:26:19.425052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ac65025-9632-4cdd-93f1-f5311904c054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E28AE750>]}
[0m17:26:19.466702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ac65025-9632-4cdd-93f1-f5311904c054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E5357800>]}
[0m17:26:19.467713 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:26:19.473707 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:26:19.541622 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:26:19.541622 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:26:19.542622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7ac65025-9632-4cdd-93f1-f5311904c054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E4CDB3B0>]}
[0m17:26:20.489240 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m17:26:20.497968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ac65025-9632-4cdd-93f1-f5311904c054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E5356660>]}
[0m17:26:20.575320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ac65025-9632-4cdd-93f1-f5311904c054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E561E180>]}
[0m17:26:20.575320 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 473 macros
[0m17:26:20.575320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ac65025-9632-4cdd-93f1-f5311904c054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E5817710>]}
[0m17:26:20.578153 [info ] [MainThread]: 
[0m17:26:20.578153 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:26:20.579769 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:26:20.580772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:32.517008 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_staging'
[0m17:26:32.517008 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw'
[0m17:26:32.517008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:32.517008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:33.275890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ac65025-9632-4cdd-93f1-f5311904c054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E57A2D20>]}
[0m17:26:33.277339 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:26:33.278343 [info ] [MainThread]: 
[0m17:26:33.285399 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m17:26:33.287013 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_raw_staging.airnow_hist_stage .............. [RUN]
[0m17:26:33.287909 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m17:26:33.287909 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m17:26:33.295907 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m17:26:33.296907 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m17:26:33.321657 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m17:26:33.321657 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:26:33.327525 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_raw_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      

WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS FLOAT) AS Latitude_update,
        CAST(Longitude AS FLOAT) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Caregory, '$.Name') AS AQICategory,
        JSON_EXTRACT_SCALAR(Category, '$.Number') AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT * FROM airnow_hist_final
    );
  
[0m17:26:34.316042 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:3859b508-8f14-42a4-aa05-76078e33fffb&page=queryresults
[0m17:26:34.511270 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Type not found: FLOAT at [23:26]; reason: invalidQuery, location: query, message: Type not found: FLOAT at [23:26]')
[0m17:26:35.295893 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:cef46b94-08b6-4c9f-9430-46df832fa8f9&page=queryresults
[0m17:26:35.490896 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:cef46b94-08b6-4c9f-9430-46df832fa8f9&page=queryresults
[0m17:26:35.500404 [debug] [Thread-1 (]: Database Error in model airnow_hist_stage (models\airnow_staging\airnow_hist_stage.sql)
  Type not found: FLOAT at [23:26]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\airnow_hist_stage.sql
[0m17:26:35.503002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ac65025-9632-4cdd-93f1-f5311904c054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E5631400>]}
[0m17:26:35.504005 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model airnow_raw_staging.airnow_hist_stage ..... [[31mERROR[0m in 2.21s]
[0m17:26:35.505083 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m17:26:35.507597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:35.507597 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m17:26:35.508678 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_staging' was properly closed.
[0m17:26:35.509595 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw' was properly closed.
[0m17:26:35.509595 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m17:26:35.509595 [info ] [MainThread]: 
[0m17:26:35.510596 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.93 seconds (14.93s).
[0m17:26:35.511596 [debug] [MainThread]: Command end result
[0m17:26:35.534803 [info ] [MainThread]: 
[0m17:26:35.535805 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:26:35.535805 [info ] [MainThread]: 
[0m17:26:35.536812 [error] [MainThread]:   Database Error in model airnow_hist_stage (models\airnow_staging\airnow_hist_stage.sql)
  Type not found: FLOAT at [23:26]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\airnow_hist_stage.sql
[0m17:26:35.537319 [info ] [MainThread]: 
[0m17:26:35.537319 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:26:35.538323 [debug] [MainThread]: Command `cli run` failed at 17:26:35.538323 after 17.15 seconds
[0m17:26:35.539324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BA80E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156BA903F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000156E58565A0>]}
[0m17:26:35.539324 [debug] [MainThread]: Flushing usage events
[0m17:28:05.723252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA7265F140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA7265DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA7265DEB0>]}


============================== 17:28:05.727018 | 661f5d42-7873-4e0f-9933-d58cb1c52dce ==============================
[0m17:28:05.727018 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:28:05.727018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:28:06.607748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '661f5d42-7873-4e0f-9933-d58cb1c52dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA1B7122A0>]}
[0m17:28:06.647695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '661f5d42-7873-4e0f-9933-d58cb1c52dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA725BDE50>]}
[0m17:28:06.648690 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:28:06.656373 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:28:06.724745 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:28:06.724923 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:28:06.725756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '661f5d42-7873-4e0f-9933-d58cb1c52dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA1BB433B0>]}
[0m17:28:07.667767 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m17:28:07.676652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '661f5d42-7873-4e0f-9933-d58cb1c52dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA1DBA6420>]}
[0m17:28:07.749070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '661f5d42-7873-4e0f-9933-d58cb1c52dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA1D8C6810>]}
[0m17:28:07.749070 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 473 macros
[0m17:28:07.750032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '661f5d42-7873-4e0f-9933-d58cb1c52dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA1DBB7CE0>]}
[0m17:28:07.751032 [info ] [MainThread]: 
[0m17:28:07.752032 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:28:07.753032 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:28:07.753032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:19.673254 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw'
[0m17:28:19.674254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:19.675714 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_staging'
[0m17:28:19.676722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:20.426847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '661f5d42-7873-4e0f-9933-d58cb1c52dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA1D8985C0>]}
[0m17:28:20.428847 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:28:20.429846 [info ] [MainThread]: 
[0m17:28:20.437372 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m17:28:20.438372 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_raw_staging.airnow_hist_stage .............. [RUN]
[0m17:28:20.438372 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m17:28:20.439372 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m17:28:20.445222 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m17:28:20.445222 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m17:28:20.472639 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m17:28:20.472639 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:28:20.475197 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_raw_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      

WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Caregory, '$.Name') AS AQICategory,
        JSON_EXTRACT_SCALAR(Category, '$.Number') AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT * FROM airnow_hist_final
    );
  
[0m17:28:21.391864 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:3bdeb8e3-d83b-452e-8fab-0c0421770125&page=queryresults
[0m17:28:21.578128 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: Caregory; Did you mean Category? at [26:29]; reason: invalidQuery, location: query, message: Unrecognized name: Caregory; Did you mean Category? at [26:29]')
[0m17:28:22.309607 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:e71d18e1-1b1a-4a5e-ac36-0dc28f5934ce&page=queryresults
[0m17:28:22.484455 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:e71d18e1-1b1a-4a5e-ac36-0dc28f5934ce&page=queryresults
[0m17:28:22.493334 [debug] [Thread-1 (]: Database Error in model airnow_hist_stage (models\airnow_staging\airnow_hist_stage.sql)
  Unrecognized name: Caregory; Did you mean Category? at [26:29]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\airnow_hist_stage.sql
[0m17:28:22.495384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '661f5d42-7873-4e0f-9933-d58cb1c52dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA7265E480>]}
[0m17:28:22.496392 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model airnow_raw_staging.airnow_hist_stage ..... [[31mERROR[0m in 2.06s]
[0m17:28:22.496392 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m17:28:22.498428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:22.499392 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m17:28:22.499392 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw' was properly closed.
[0m17:28:22.499392 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_staging' was properly closed.
[0m17:28:22.500391 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m17:28:22.500391 [info ] [MainThread]: 
[0m17:28:22.500391 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 14.75 seconds (14.75s).
[0m17:28:22.501391 [debug] [MainThread]: Command end result
[0m17:28:22.524230 [info ] [MainThread]: 
[0m17:28:22.524230 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:28:22.525233 [info ] [MainThread]: 
[0m17:28:22.526235 [error] [MainThread]:   Database Error in model airnow_hist_stage (models\airnow_staging\airnow_hist_stage.sql)
  Unrecognized name: Caregory; Did you mean Category? at [26:29]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\airnow_hist_stage.sql
[0m17:28:22.526235 [info ] [MainThread]: 
[0m17:28:22.527233 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:28:22.528234 [debug] [MainThread]: Command `cli run` failed at 17:28:22.527233 after 16.95 seconds
[0m17:28:22.528234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA72E25280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA7241DD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BA72BDA8D0>]}
[0m17:28:22.528234 [debug] [MainThread]: Flushing usage events
[0m17:28:43.661887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C21C0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C4240230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C2791940>]}


============================== 17:28:43.666394 | f61e5da2-3737-4437-a9e2-624e2ea93cfb ==============================
[0m17:28:43.666394 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:28:43.666394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:28:44.602153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f61e5da2-3737-4437-a9e2-624e2ea93cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221EDBC1280>]}
[0m17:28:44.644486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f61e5da2-3737-4437-a9e2-624e2ea93cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221ED7F2CC0>]}
[0m17:28:44.645463 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:28:44.651462 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:28:44.719677 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:28:44.720677 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:28:44.720677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f61e5da2-3737-4437-a9e2-624e2ea93cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221EF7B0D40>]}
[0m17:28:45.704877 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m17:28:45.711952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f61e5da2-3737-4437-a9e2-624e2ea93cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221EF9EB1D0>]}
[0m17:28:45.785459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f61e5da2-3737-4437-a9e2-624e2ea93cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221EF9EA5D0>]}
[0m17:28:45.786460 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 473 macros
[0m17:28:45.786460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61e5da2-3737-4437-a9e2-624e2ea93cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C4B33AA0>]}
[0m17:28:45.788495 [info ] [MainThread]: 
[0m17:28:45.788495 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:28:45.790499 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:28:45.790499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:46.499670 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw'
[0m17:28:46.500671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:46.501664 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_staging'
[0m17:28:46.527193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:47.206497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61e5da2-3737-4437-a9e2-624e2ea93cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221EF5DC950>]}
[0m17:28:47.207576 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:28:47.208578 [info ] [MainThread]: 
[0m17:28:47.216638 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m17:28:47.216638 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_raw_staging.airnow_hist_stage .............. [RUN]
[0m17:28:47.217638 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m17:28:47.217638 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m17:28:47.224320 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m17:28:47.225327 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m17:28:47.256226 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m17:28:47.257154 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:28:47.259228 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_raw_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      

WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        JSON_EXTRACT_SCALAR(Category, '$.Number') AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT * FROM airnow_hist_final
    );
  
[0m17:28:48.118472 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:d2a5dfec-f126-438c-98c3-f7c2a12d1ab1&page=queryresults
[0m17:28:53.153515 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61e5da2-3737-4437-a9e2-624e2ea93cfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221EFB4B680>]}
[0m17:28:53.154980 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_raw_staging.airnow_hist_stage ......... [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 5.94s]
[0m17:28:53.155980 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m17:28:53.156921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:53.158201 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m17:28:53.158201 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw' was properly closed.
[0m17:28:53.159201 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_staging' was properly closed.
[0m17:28:53.159268 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m17:28:53.159268 [info ] [MainThread]: 
[0m17:28:53.160327 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.37 seconds (7.37s).
[0m17:28:53.160327 [debug] [MainThread]: Command end result
[0m17:28:53.183435 [info ] [MainThread]: 
[0m17:28:53.184522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:28:53.184522 [info ] [MainThread]: 
[0m17:28:53.185522 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:28:53.186522 [debug] [MainThread]: Command `cli run` succeeded at 17:28:53.186522 after 9.66 seconds
[0m17:28:53.186522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C21C0050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C4B57FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221C4B57080>]}
[0m17:28:53.186522 [debug] [MainThread]: Flushing usage events
[0m17:29:32.165933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5E6EA930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5CEDE420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5E57C860>]}


============================== 17:29:32.171022 | 91438638-6af4-4260-8e16-8741b3038b55 ==============================
[0m17:29:32.171022 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:29:32.171022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:29:33.046877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91438638-6af4-4260-8e16-8741b3038b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B7FE94170>]}
[0m17:29:33.085912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91438638-6af4-4260-8e16-8741b3038b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5F538AD0>]}
[0m17:29:33.086912 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:29:33.093672 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:29:33.213894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:29:33.214897 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:29:33.218897 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m17:29:33.248625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91438638-6af4-4260-8e16-8741b3038b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B09EA38F0>]}
[0m17:29:33.323680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91438638-6af4-4260-8e16-8741b3038b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B0A0F0110>]}
[0m17:29:33.342619 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 473 macros
[0m17:29:33.342619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91438638-6af4-4260-8e16-8741b3038b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B09EE0170>]}
[0m17:29:33.344512 [info ] [MainThread]: 
[0m17:29:33.345510 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:29:33.346510 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:29:33.346510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:34.412848 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_key-polymer-434418-m6, now create_key-polymer-434418-m6_airnow_raw_staging)
[0m17:29:34.414364 [debug] [ThreadPool]: Creating schema "database: "key-polymer-434418-m6"
schema: "airnow_raw_staging"
"
[0m17:29:34.425872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:29:34.426872 [debug] [ThreadPool]: On create_key-polymer-434418-m6_airnow_raw_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "connection_name": "create_key-polymer-434418-m6_airnow_raw_staging"} */
create schema if not exists `key-polymer-434418-m6`.`airnow_raw_staging`
  
[0m17:29:35.297714 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:2e3f1eea-e401-4ca7-bf35-6a472bec2df7&page=queryresults
[0m17:29:36.353874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw'
[0m17:29:36.355874 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_staging'
[0m17:29:36.355874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:36.356874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:29:37.112972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91438638-6af4-4260-8e16-8741b3038b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B09EB2420>]}
[0m17:29:37.112972 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:29:37.112972 [info ] [MainThread]: 
[0m17:29:37.124858 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m17:29:37.125864 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_raw_staging.airnow_hist_stage .............. [RUN]
[0m17:29:37.126864 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m17:29:37.126864 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m17:29:37.134367 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m17:29:37.134367 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m17:29:37.161676 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m17:29:37.177132 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:29:37.179136 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_raw_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      

WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        JSON_EXTRACT_SCALAR(Category, '$.Number') AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT * FROM airnow_hist_final
    );
  
[0m17:29:38.209964 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:50bec328-f56f-4c0e-9287-f2e7734e4961&page=queryresults
[0m17:29:42.345781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91438638-6af4-4260-8e16-8741b3038b55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B0A19D010>]}
[0m17:29:42.346781 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_raw_staging.airnow_hist_stage ......... [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 5.22s]
[0m17:29:42.346781 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m17:29:42.348781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:29:42.349866 [debug] [MainThread]: Connection 'create_key-polymer-434418-m6_airnow_raw_staging' was properly closed.
[0m17:29:42.349866 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw' was properly closed.
[0m17:29:42.349866 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_staging' was properly closed.
[0m17:29:42.350822 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m17:29:42.350822 [info ] [MainThread]: 
[0m17:29:42.350822 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.01 seconds (9.01s).
[0m17:29:42.351782 [debug] [MainThread]: Command end result
[0m17:29:42.373547 [info ] [MainThread]: 
[0m17:29:42.373547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:29:42.374549 [info ] [MainThread]: 
[0m17:29:42.374549 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:29:42.376547 [debug] [MainThread]: Command `cli run` succeeded at 17:29:42.376547 after 10.35 seconds
[0m17:29:42.376547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5F3D5E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5F3D51F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020B5F408770>]}
[0m17:29:42.377548 [debug] [MainThread]: Flushing usage events
[0m17:31:22.392486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E1486C140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E14D9D3A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E14D9D1F0>]}


============================== 17:31:22.396484 | c8e3bd9b-51c2-409e-8c2b-c62a47c0b654 ==============================
[0m17:31:22.396484 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:31:22.396484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:31:23.270785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8e3bd9b-51c2-409e-8c2b-c62a47c0b654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E41B6E060>]}
[0m17:31:23.310912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8e3bd9b-51c2-409e-8c2b-c62a47c0b654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E14E116A0>]}
[0m17:31:23.311881 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:31:23.318658 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:31:23.384047 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:31:23.384047 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:31:23.384965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c8e3bd9b-51c2-409e-8c2b-c62a47c0b654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E4160B3B0>]}
[0m17:31:24.326703 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m17:31:24.335681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8e3bd9b-51c2-409e-8c2b-c62a47c0b654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E420CB0E0>]}
[0m17:31:24.408215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8e3bd9b-51c2-409e-8c2b-c62a47c0b654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E420F10A0>]}
[0m17:31:24.409212 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 473 macros
[0m17:31:24.409212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8e3bd9b-51c2-409e-8c2b-c62a47c0b654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E41F90050>]}
[0m17:31:24.410949 [info ] [MainThread]: 
[0m17:31:24.410949 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:31:24.412809 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:31:24.413809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:25.252889 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw'
[0m17:31:25.254440 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_staging'
[0m17:31:25.254440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:25.255541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:26.029382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8e3bd9b-51c2-409e-8c2b-c62a47c0b654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E4211B2C0>]}
[0m17:31:26.031144 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:31:26.032096 [info ] [MainThread]: 
[0m17:31:26.041006 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m17:31:26.041510 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_raw.airnow_hist_stage ...................... [RUN]
[0m17:31:26.042523 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m17:31:26.042523 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m17:31:26.048527 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m17:31:26.049513 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m17:31:26.077791 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m17:31:26.078770 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:31:26.079746 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      

WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        JSON_EXTRACT_SCALAR(Category, '$.Number') AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT * FROM airnow_hist_final
    );
  
[0m17:31:38.494320 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:c29a4dc1-2120-4adc-b0d2-aca6883bff9e&page=queryresults
[0m17:31:43.054439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8e3bd9b-51c2-409e-8c2b-c62a47c0b654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E40281CA0>]}
[0m17:31:43.055480 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_raw.airnow_hist_stage ................. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 17.01s]
[0m17:31:43.056440 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m17:31:43.058438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:43.058438 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m17:31:43.059524 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw' was properly closed.
[0m17:31:43.059524 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_staging' was properly closed.
[0m17:31:43.060485 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m17:31:43.060485 [info ] [MainThread]: 
[0m17:31:43.061028 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 18.65 seconds (18.65s).
[0m17:31:43.062030 [debug] [MainThread]: Command end result
[0m17:31:43.098060 [info ] [MainThread]: 
[0m17:31:43.099061 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:31:43.099061 [info ] [MainThread]: 
[0m17:31:43.099061 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:31:43.100570 [debug] [MainThread]: Command `cli run` succeeded at 17:31:43.100570 after 20.84 seconds
[0m17:31:43.101575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E167A5E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E171B3680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E16FF8A10>]}
[0m17:31:43.101575 [debug] [MainThread]: Flushing usage events
[0m17:32:45.268317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F1B3D8B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F1E1217C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F1E121640>]}


============================== 17:32:45.271947 | 7d2f2f69-643e-4a82-937f-73836cdc19a0 ==============================
[0m17:32:45.271947 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:32:45.272978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:32:46.181673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d2f2f69-643e-4a82-937f-73836cdc19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F48B57BF0>]}
[0m17:32:46.222032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d2f2f69-643e-4a82-937f-73836cdc19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F4745A240>]}
[0m17:32:46.222985 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:32:46.229752 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:32:46.296275 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:32:46.296275 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:32:46.296275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7d2f2f69-643e-4a82-937f-73836cdc19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F1DEB4A10>]}
[0m17:32:47.246147 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m17:32:47.253920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d2f2f69-643e-4a82-937f-73836cdc19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F471F5CA0>]}
[0m17:32:47.326072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d2f2f69-643e-4a82-937f-73836cdc19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F49041250>]}
[0m17:32:47.327089 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 473 macros
[0m17:32:47.327089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d2f2f69-643e-4a82-937f-73836cdc19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F48E60770>]}
[0m17:32:47.328073 [info ] [MainThread]: 
[0m17:32:47.329578 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:32:47.330629 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:32:47.331670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:59.157948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_key-polymer-434418-m6, now create_key-polymer-434418-m6_airnow_raw_airnow_staging)
[0m17:32:59.159618 [debug] [ThreadPool]: Creating schema "database: "key-polymer-434418-m6"
schema: "airnow_raw_airnow_staging"
"
[0m17:32:59.169502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:32:59.170389 [debug] [ThreadPool]: On create_key-polymer-434418-m6_airnow_raw_airnow_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "connection_name": "create_key-polymer-434418-m6_airnow_raw_airnow_staging"} */
create schema if not exists `key-polymer-434418-m6`.`airnow_raw_airnow_staging`
  
[0m17:33:00.037324 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:9cceeef7-1566-41f5-9375-c414ed170503&page=queryresults
[0m17:33:00.799242 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_staging'
[0m17:33:00.801322 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw'
[0m17:33:00.801322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:00.803480 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_airnow_staging'
[0m17:33:00.803480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:00.804614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:01.544238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d2f2f69-643e-4a82-937f-73836cdc19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F48DC8AA0>]}
[0m17:33:01.545272 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:33:01.546264 [info ] [MainThread]: 
[0m17:33:01.553907 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m17:33:01.554909 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_raw_airnow_staging.airnow_hist_stage ....... [RUN]
[0m17:33:01.554909 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m17:33:01.555869 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m17:33:01.561641 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m17:33:01.562650 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m17:33:01.586015 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m17:33:01.587016 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:33:01.588031 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_raw_airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      

WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        JSON_EXTRACT_SCALAR(Category, '$.Number') AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT * FROM airnow_hist_final
    );
  
[0m17:33:02.534991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:5451dc40-8af4-4dee-9aca-ff2f74267caf&page=queryresults
[0m17:33:07.139485 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d2f2f69-643e-4a82-937f-73836cdc19a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F1D98A810>]}
[0m17:33:07.140081 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_raw_airnow_staging.airnow_hist_stage .. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 5.58s]
[0m17:33:07.141089 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m17:33:07.143094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:07.143094 [debug] [MainThread]: Connection 'create_key-polymer-434418-m6_airnow_raw_airnow_staging' was properly closed.
[0m17:33:07.143094 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_staging' was properly closed.
[0m17:33:07.144110 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw' was properly closed.
[0m17:33:07.144110 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_airnow_staging' was properly closed.
[0m17:33:07.145090 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m17:33:07.145090 [info ] [MainThread]: 
[0m17:33:07.145090 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 19.82 seconds (19.82s).
[0m17:33:07.146090 [debug] [MainThread]: Command end result
[0m17:33:07.165701 [info ] [MainThread]: 
[0m17:33:07.165701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:07.166785 [info ] [MainThread]: 
[0m17:33:07.166785 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:33:07.167785 [debug] [MainThread]: Command `cli run` succeeded at 17:33:07.167785 after 22.04 seconds
[0m17:33:07.167785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F1DF6DB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F4902BCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F4902BAA0>]}
[0m17:33:07.167785 [debug] [MainThread]: Flushing usage events
[0m17:35:43.241113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A924F43FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A925592FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A922588E00>]}


============================== 17:35:43.244121 | b9375ac7-0b83-425e-9016-b456dc974dc9 ==============================
[0m17:35:43.244121 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:35:43.245115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:35:44.123149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9375ac7-0b83-425e-9016-b456dc974dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A92399E240>]}
[0m17:35:44.164478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9375ac7-0b83-425e-9016-b456dc974dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94E8C3F20>]}
[0m17:35:44.165533 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:35:44.171222 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:35:44.237066 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:35:44.237668 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:35:44.237668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9375ac7-0b83-425e-9016-b456dc974dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A924FECA10>]}
[0m17:35:45.190222 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m17:35:45.198216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9375ac7-0b83-425e-9016-b456dc974dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A950C77DA0>]}
[0m17:35:45.273807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9375ac7-0b83-425e-9016-b456dc974dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A950B78A10>]}
[0m17:35:45.274877 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 473 macros
[0m17:35:45.275873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9375ac7-0b83-425e-9016-b456dc974dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A950947830>]}
[0m17:35:45.276880 [info ] [MainThread]: 
[0m17:35:45.277690 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:35:45.278717 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:35:45.279730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:57.672048 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw'
[0m17:35:57.673564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:57.674602 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_airnow_staging'
[0m17:35:57.675571 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_staging'
[0m17:35:57.701622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:57.702297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:58.428309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9375ac7-0b83-425e-9016-b456dc974dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A95099B1D0>]}
[0m17:35:58.429220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:35:58.430301 [info ] [MainThread]: 
[0m17:35:58.434855 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m17:35:58.435941 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_raw_airnow_staging.airnow_hist_stage ....... [RUN]
[0m17:35:58.436896 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m17:35:58.436896 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m17:35:58.442934 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m17:35:58.443863 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m17:35:58.454216 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:35:59.208644 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m17:35:59.209643 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_raw_airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      

WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        JSON_EXTRACT_SCALAR(Category, '$.Number') AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT * FROM airnow_hist_final
    );
  
[0m17:35:59.720966 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:f04ae8dd-3484-46ca-844d-ac1a26d516cc&page=queryresults
[0m17:36:05.261673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9375ac7-0b83-425e-9016-b456dc974dc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A94EE31B80>]}
[0m17:36:05.262603 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_raw_airnow_staging.airnow_hist_stage .. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 6.82s]
[0m17:36:05.262603 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m17:36:05.264739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:05.265263 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m17:36:05.265374 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw' was properly closed.
[0m17:36:05.265962 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_airnow_staging' was properly closed.
[0m17:36:05.265962 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_staging' was properly closed.
[0m17:36:05.266982 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m17:36:05.267509 [info ] [MainThread]: 
[0m17:36:05.268027 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 19.99 seconds (19.99s).
[0m17:36:05.268545 [debug] [MainThread]: Command end result
[0m17:36:05.295583 [info ] [MainThread]: 
[0m17:36:05.295583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:36:05.296583 [info ] [MainThread]: 
[0m17:36:05.296583 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:36:05.297584 [debug] [MainThread]: Command `cli run` succeeded at 17:36:05.297584 after 22.19 seconds
[0m17:36:05.298584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A950AE31A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A925E07EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A925E07680>]}
[0m17:36:05.298584 [debug] [MainThread]: Flushing usage events
[0m17:40:58.121093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002663A5E0B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002663D38E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002663C5072C0>]}


============================== 17:40:58.126094 | 12f2acbc-9235-475c-afb3-0f45fb3291b4 ==============================
[0m17:40:58.126094 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:40:58.126094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:40:59.048028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12f2acbc-9235-475c-afb3-0f45fb3291b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026667FCC560>]}
[0m17:40:59.088412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12f2acbc-9235-475c-afb3-0f45fb3291b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002663C718F20>]}
[0m17:40:59.089494 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:40:59.096546 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:40:59.162664 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:40:59.162664 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:40:59.163618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '12f2acbc-9235-475c-afb3-0f45fb3291b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026667FCFC20>]}
[0m17:41:00.123513 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m17:41:00.123513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12f2acbc-9235-475c-afb3-0f45fb3291b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266683B7B60>]}
[0m17:41:00.204561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12f2acbc-9235-475c-afb3-0f45fb3291b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026668410530>]}
[0m17:41:00.204561 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 473 macros
[0m17:41:00.205562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12f2acbc-9235-475c-afb3-0f45fb3291b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026667F85790>]}
[0m17:41:00.206562 [info ] [MainThread]: 
[0m17:41:00.207562 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:41:00.208561 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:41:00.209563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:12.635078 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw'
[0m17:41:12.635078 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_staging'
[0m17:41:12.635078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:12.635078 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_raw_airnow_staging'
[0m17:41:12.635078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:12.669945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:13.664075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12f2acbc-9235-475c-afb3-0f45fb3291b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266682CB1D0>]}
[0m17:41:13.665001 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:41:13.666002 [info ] [MainThread]: 
[0m17:41:13.672113 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m17:41:13.673192 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_raw_airnow_staging.airnow_hist_stage ....... [RUN]
[0m17:41:13.675194 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m17:41:13.675194 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m17:41:13.682193 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m17:41:13.683192 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m17:41:13.693193 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:41:14.434548 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m17:41:14.434548 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_raw_airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      

WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        JSON_EXTRACT_SCALAR(Category, '$.Number') AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT * FROM airnow_hist_final
    );
  
[0m17:41:14.940043 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:7ac9f7d7-dd7e-4e16-a323-94856c78ae1b&page=queryresults
[0m17:41:19.217962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f2acbc-9235-475c-afb3-0f45fb3291b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002663CDAA8D0>]}
[0m17:41:19.218962 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_raw_airnow_staging.airnow_hist_stage .. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 5.54s]
[0m17:41:19.219961 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m17:41:19.221961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:19.221961 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m17:41:19.222962 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw' was properly closed.
[0m17:41:19.222962 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_staging' was properly closed.
[0m17:41:19.222962 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_raw_airnow_staging' was properly closed.
[0m17:41:19.223962 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m17:41:19.223962 [info ] [MainThread]: 
[0m17:41:19.224962 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 19.02 seconds (19.02s).
[0m17:41:19.225962 [debug] [MainThread]: Command end result
[0m17:41:19.255078 [info ] [MainThread]: 
[0m17:41:19.256079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:19.256079 [info ] [MainThread]: 
[0m17:41:19.257079 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:41:19.258104 [debug] [MainThread]: Command `cli run` succeeded at 17:41:19.258104 after 21.28 seconds
[0m17:41:19.259079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002663A5E0B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002663D263620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026667FCCDD0>]}
[0m17:41:19.259079 [debug] [MainThread]: Flushing usage events
[0m17:50:09.335821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B04155E780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B03E17CD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B041D19940>]}


============================== 17:50:09.339823 | 3aed959a-ea24-4af2-956b-8afcfecaef3f ==============================
[0m17:50:09.339823 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:50:09.340828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:50:10.199711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3aed959a-ea24-4af2-956b-8afcfecaef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B03F82E150>]}
[0m17:50:10.240796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3aed959a-ea24-4af2-956b-8afcfecaef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B06AD752E0>]}
[0m17:50:10.241803 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:50:10.247489 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:50:10.314496 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:50:10.315480 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:50:10.315480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3aed959a-ea24-4af2-956b-8afcfecaef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B06AD54A10>]}
[0m17:50:11.259675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m17:50:11.267690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3aed959a-ea24-4af2-956b-8afcfecaef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B06AD554C0>]}
[0m17:50:11.339110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3aed959a-ea24-4af2-956b-8afcfecaef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B06C9C6030>]}
[0m17:50:11.340110 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 473 macros
[0m17:50:11.340110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aed959a-ea24-4af2-956b-8afcfecaef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B06C6D74D0>]}
[0m17:50:11.341110 [info ] [MainThread]: 
[0m17:50:11.342110 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:50:11.343110 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:50:11.344162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:12.267208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_key-polymer-434418-m6, now create_key-polymer-434418-m6_airnow_staging)
[0m17:50:12.268216 [debug] [ThreadPool]: Creating schema "database: "key-polymer-434418-m6"
schema: "airnow_staging"
"
[0m17:50:12.280122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:50:12.281166 [debug] [ThreadPool]: On create_key-polymer-434418-m6_airnow_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "connection_name": "create_key-polymer-434418-m6_airnow_staging"} */
create schema if not exists `key-polymer-434418-m6`.`airnow_staging`
  
[0m17:50:13.453631 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:3c3dcff8-2d7f-478f-a96e-ceab7e866994&page=queryresults
[0m17:50:14.219319 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m17:50:14.220373 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m17:50:14.221751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:14.222535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:15.013194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aed959a-ea24-4af2-956b-8afcfecaef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B06AD567B0>]}
[0m17:50:15.015243 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:50:15.016198 [info ] [MainThread]: 
[0m17:50:15.022195 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m17:50:15.023193 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_hist_stage .................. [RUN]
[0m17:50:15.024193 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m17:50:15.024193 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m17:50:15.032192 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m17:50:15.033192 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m17:50:15.071883 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m17:50:15.072803 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:15.074881 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      

WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        JSON_EXTRACT_SCALAR(Category, '$.Number') AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT * FROM airnow_hist_final
    );
  
[0m17:50:16.062929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:72d44998-0a20-4359-86cc-bb5729cf4ba4&page=queryresults
[0m17:50:20.909654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aed959a-ea24-4af2-956b-8afcfecaef3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B04150A900>]}
[0m17:50:20.911654 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_hist_stage ............. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 5.88s]
[0m17:50:20.912654 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m17:50:20.913654 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:20.914654 [debug] [MainThread]: Connection 'create_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m17:50:20.914654 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m17:50:20.915654 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m17:50:20.915654 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m17:50:20.916664 [info ] [MainThread]: 
[0m17:50:20.916664 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.57 seconds (9.57s).
[0m17:50:20.917654 [debug] [MainThread]: Command end result
[0m17:50:20.952584 [info ] [MainThread]: 
[0m17:50:20.953583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:20.954583 [info ] [MainThread]: 
[0m17:50:20.954583 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:50:20.955583 [debug] [MainThread]: Command `cli run` succeeded at 17:50:20.955583 after 11.77 seconds
[0m17:50:20.956583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B040DEF890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B041CD5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B041C0D220>]}
[0m17:50:20.956583 [debug] [MainThread]: Flushing usage events
[0m17:51:06.602034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D3E29BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D408762D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D40874E90>]}


============================== 17:51:06.606979 | 27fba9fe-1d2e-4cb6-bcbc-c438456db5c2 ==============================
[0m17:51:06.606979 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:51:06.607957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:51:07.462320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27fba9fe-1d2e-4cb6-bcbc-c438456db5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D693F71A0>]}
[0m17:51:07.502381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27fba9fe-1d2e-4cb6-bcbc-c438456db5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D69A88A10>]}
[0m17:51:07.503477 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:51:07.509471 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:51:07.576175 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:51:07.577079 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:51:07.577079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '27fba9fe-1d2e-4cb6-bcbc-c438456db5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D69847770>]}
[0m17:51:08.518138 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m17:51:08.525854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27fba9fe-1d2e-4cb6-bcbc-c438456db5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D6BB4D400>]}
[0m17:51:08.597858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27fba9fe-1d2e-4cb6-bcbc-c438456db5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D6BF012E0>]}
[0m17:51:08.597858 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 473 macros
[0m17:51:08.598812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27fba9fe-1d2e-4cb6-bcbc-c438456db5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D6BF73B00>]}
[0m17:51:08.599774 [info ] [MainThread]: 
[0m17:51:08.600861 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:51:08.602880 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:51:08.602880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:20.440347 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m17:51:20.442312 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m17:51:20.442312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:20.443347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:21.234906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27fba9fe-1d2e-4cb6-bcbc-c438456db5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D6BDA5160>]}
[0m17:51:21.235910 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:51:21.236911 [info ] [MainThread]: 
[0m17:51:21.241909 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m17:51:21.242909 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_hist_stage .................. [RUN]
[0m17:51:21.242909 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m17:51:21.243909 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m17:51:21.249908 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m17:51:21.251908 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m17:51:21.262908 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:51:22.037515 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m17:51:22.038517 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      

WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT * FROM airnow_hist_final
    );
  
[0m17:51:22.671458 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:3f855e40-35c2-4667-bdfe-9e3d1d1d921b&page=queryresults
[0m17:51:26.771546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27fba9fe-1d2e-4cb6-bcbc-c438456db5c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D6BF91C70>]}
[0m17:51:26.779622 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_hist_stage ............. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 5.52s]
[0m17:51:26.785628 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m17:51:26.797625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:26.802624 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m17:51:26.807628 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m17:51:26.810624 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m17:51:26.813625 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m17:51:26.817635 [info ] [MainThread]: 
[0m17:51:26.823635 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 18.22 seconds (18.22s).
[0m17:51:26.830741 [debug] [MainThread]: Command end result
[0m17:51:27.054360 [info ] [MainThread]: 
[0m17:51:27.058364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:51:27.062374 [info ] [MainThread]: 
[0m17:51:27.065358 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:51:27.072374 [debug] [MainThread]: Command `cli run` succeeded at 17:51:27.072374 after 20.62 seconds
[0m17:51:27.076361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D3E29BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D3D7E91C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D40D72AE0>]}
[0m17:51:27.079362 [debug] [MainThread]: Flushing usage events
[0m11:51:55.979470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED4EA6E1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED506E69C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED506E6AB0>]}


============================== 11:51:55.979470 | a2e55839-adf3-4402-820c-ec5c96f07015 ==============================
[0m11:51:55.979470 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:51:55.979470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:51:57.040959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2e55839-adf3-4402-820c-ec5c96f07015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7A1EEF90>]}
[0m11:51:57.073810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2e55839-adf3-4402-820c-ec5c96f07015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7B287E30>]}
[0m11:51:57.073810 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:51:57.089546 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m11:51:57.153011 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:51:57.153011 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m11:51:57.153011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a2e55839-adf3-4402-820c-ec5c96f07015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7BB34560>]}
[0m11:51:58.173320 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m11:51:58.179618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2e55839-adf3-4402-820c-ec5c96f07015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7BC0A9C0>]}
[0m11:51:58.278056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2e55839-adf3-4402-820c-ec5c96f07015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7BD6A5D0>]}
[0m11:51:58.278056 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 473 macros
[0m11:51:58.278056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2e55839-adf3-4402-820c-ec5c96f07015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7BC0D9D0>]}
[0m11:51:58.278056 [info ] [MainThread]: 
[0m11:51:58.278056 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:51:58.278056 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m11:51:58.278056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:58.984570 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m11:51:58.984570 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m11:51:58.984570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:58.984570 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_airnow_staging'
[0m11:51:58.984570 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:59.015899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:59.681918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2e55839-adf3-4402-820c-ec5c96f07015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7BC0CB30>]}
[0m11:51:59.681918 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:51:59.681918 [info ] [MainThread]: 
[0m11:51:59.740042 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m11:51:59.740042 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_hist_stage .................. [RUN]
[0m11:51:59.740042 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m11:51:59.740042 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m11:51:59.740042 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m11:51:59.754643 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m11:51:59.762675 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:52:00.284664 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m11:52:00.284664 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Historical Observations Staging Model ***/
/**
The below model converts all columns, except for 'DateObserved,' to the correct data type. 'DateObserved' is already
a TIMESTAMP data type.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
    ORDER BY DateObserved DESC, HourObserved_update DESC
)

SELECT * FROM airnow_hist_final
    );
  
[0m11:52:00.875603 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:468686eb-082a-4e20-a00f-87fb08ceec19&page=queryresults
[0m11:52:05.087884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2e55839-adf3-4402-820c-ec5c96f07015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED7BEF1FA0>]}
[0m11:52:05.087884 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_hist_stage ............. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 5.35s]
[0m11:52:05.087884 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m11:52:05.094301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:05.094301 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m11:52:05.094301 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m11:52:05.094301 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m11:52:05.094301 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_airnow_staging' was properly closed.
[0m11:52:05.094301 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m11:52:05.094301 [info ] [MainThread]: 
[0m11:52:05.094301 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.82 seconds (6.82s).
[0m11:52:05.094301 [debug] [MainThread]: Command end result
[0m11:52:05.120109 [info ] [MainThread]: 
[0m11:52:05.120109 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:52:05.120109 [info ] [MainThread]: 
[0m11:52:05.123115 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:52:05.124907 [debug] [MainThread]: Command `cli run` succeeded at 11:52:05.124907 after 9.31 seconds
[0m11:52:05.124907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED4FFE33E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED51032000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED510320F0>]}
[0m11:52:05.124907 [debug] [MainThread]: Flushing usage events
[0m11:53:36.115143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731BDE7EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731E7E68D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731DC2D9A0>]}


============================== 11:53:36.115143 | e5aea560-5dde-4296-bb6e-698cc5d2d38f ==============================
[0m11:53:36.115143 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:53:36.115143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:53:37.034400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5aea560-5dde-4296-bb6e-698cc5d2d38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173478650A0>]}
[0m11:53:37.081391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5aea560-5dde-4296-bb6e-698cc5d2d38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731DDDE3C0>]}
[0m11:53:37.081391 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:53:37.081391 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m11:53:37.151167 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:53:37.151167 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m11:53:37.151167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e5aea560-5dde-4296-bb6e-698cc5d2d38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731E902720>]}
[0m11:53:38.097317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m11:53:38.114285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5aea560-5dde-4296-bb6e-698cc5d2d38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173494D3C80>]}
[0m11:53:38.185128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5aea560-5dde-4296-bb6e-698cc5d2d38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173490ECCE0>]}
[0m11:53:38.185128 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 473 macros
[0m11:53:38.185128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5aea560-5dde-4296-bb6e-698cc5d2d38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173495FA270>]}
[0m11:53:38.194636 [info ] [MainThread]: 
[0m11:53:38.198064 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:53:38.199665 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m11:53:38.199665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:38.775465 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m11:53:38.779998 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_airnow_staging'
[0m11:53:38.779998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:38.781528 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m11:53:38.782215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:38.797134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:39.330611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5aea560-5dde-4296-bb6e-698cc5d2d38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173496E3170>]}
[0m11:53:39.330611 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:53:39.330611 [info ] [MainThread]: 
[0m11:53:39.340560 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m11:53:39.340560 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_hist_stage .................. [RUN]
[0m11:53:39.346421 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m11:53:39.347153 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m11:53:39.348049 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m11:53:39.348049 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m11:53:39.364702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:53:40.023170 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m11:53:40.023170 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Historical Observations Staging Model ***/
/**
The below model converts all columns, except for 'DateObserved,' to the correct data type. 'DateObserved' is already
a TIMESTAMP data type.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
    ORDER BY DateObserved DESC, HourObserved_update DESC
)

SELECT * FROM airnow_hist_final
    );
  
[0m11:53:40.605186 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:039815ba-f9e5-46a6-a4dc-931ad358c6c7&page=queryresults
[0m11:53:44.842787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5aea560-5dde-4296-bb6e-698cc5d2d38f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731E01A720>]}
[0m11:53:44.842787 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_hist_stage ............. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 5.48s]
[0m11:53:44.845125 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m11:53:44.845125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:44.845125 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m11:53:44.845125 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m11:53:44.845125 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_airnow_staging' was properly closed.
[0m11:53:44.845125 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m11:53:44.845125 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m11:53:44.845125 [info ] [MainThread]: 
[0m11:53:44.845125 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.65 seconds (6.65s).
[0m11:53:44.845125 [debug] [MainThread]: Command end result
[0m11:53:44.874848 [info ] [MainThread]: 
[0m11:53:44.877944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:44.877944 [info ] [MainThread]: 
[0m11:53:44.877944 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:53:44.877944 [debug] [MainThread]: Command `cli run` succeeded at 11:53:44.877944 after 8.89 seconds
[0m11:53:44.877944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731E054FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001731E055280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173495430E0>]}
[0m11:53:44.877944 [debug] [MainThread]: Flushing usage events
[0m11:55:43.313801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F795F6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F80F8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F5FE2FC0>]}


============================== 11:55:43.321810 | a5a59148-134f-49c2-9f56-151f45e5fa7a ==============================
[0m11:55:43.321810 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:55:43.321810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:55:44.196261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5a59148-134f-49c2-9f56-151f45e5fa7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254A33029C0>]}
[0m11:55:44.229511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5a59148-134f-49c2-9f56-151f45e5fa7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254A3270950>]}
[0m11:55:44.229511 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:55:44.241517 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m11:55:44.312474 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:55:44.313334 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m11:55:44.313334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a5a59148-134f-49c2-9f56-151f45e5fa7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254A34D1280>]}
[0m11:55:45.279353 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m11:55:45.279353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5a59148-134f-49c2-9f56-151f45e5fa7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F87E3080>]}
[0m11:55:45.362993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5a59148-134f-49c2-9f56-151f45e5fa7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254A3705880>]}
[0m11:55:45.362993 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 473 macros
[0m11:55:45.362993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5a59148-134f-49c2-9f56-151f45e5fa7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254A33DCFB0>]}
[0m11:55:45.362993 [info ] [MainThread]: 
[0m11:55:45.362993 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:55:45.362993 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m11:55:45.375499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:45.962856 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m11:55:45.962856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:45.962856 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m11:55:45.962856 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_airnow_staging'
[0m11:55:45.996315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:45.996315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:46.596248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5a59148-134f-49c2-9f56-151f45e5fa7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254A37445C0>]}
[0m11:55:46.596248 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:55:46.596248 [info ] [MainThread]: 
[0m11:55:46.608414 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m11:55:46.608414 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_hist_stage .................. [RUN]
[0m11:55:46.608414 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m11:55:46.608414 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m11:55:46.617336 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m11:55:46.617336 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m11:55:46.629993 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:55:47.213578 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m11:55:47.215695 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Historical Observations Staging Model ***/
/**
The below model converts all columns, except for 'DateObserved,' to the correct data type. 'DateObserved' is already
a TIMESTAMP data type.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT 
    * 
FROM airnow_hist_final
ORDER BY
    DateObserverd DESC,
    HourObserved DESC,
    ParameterName
    );
  
[0m11:55:47.695981 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:168808a4-7ceb-4550-91d6-e53f3cd039c6&page=queryresults
[0m11:55:47.906947 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: DateObserverd; Did you mean DateObserved? at [57:5]; reason: invalidQuery, location: query, message: Unrecognized name: DateObserverd; Did you mean DateObserved? at [57:5]')
[0m11:55:49.258216 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:ad964d97-b859-4d52-a4ba-b939dba1b542&page=queryresults
[0m11:55:49.545211 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:ad964d97-b859-4d52-a4ba-b939dba1b542&page=queryresults
[0m11:55:49.612635 [debug] [Thread-1 (]: Database Error in model airnow_hist_stage (models\airnow_staging\airnow_hist_stage.sql)
  Unrecognized name: DateObserverd; Did you mean DateObserved? at [57:5]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\airnow_hist_stage.sql
[0m11:55:49.612635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5a59148-134f-49c2-9f56-151f45e5fa7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F807E540>]}
[0m11:55:49.612635 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model airnow_staging.airnow_hist_stage ......... [[31mERROR[0m in 3.00s]
[0m11:55:49.612635 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m11:55:49.627523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:49.631141 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m11:55:49.631141 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m11:55:49.631141 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m11:55:49.631141 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_airnow_staging' was properly closed.
[0m11:55:49.631141 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m11:55:49.631141 [info ] [MainThread]: 
[0m11:55:49.634779 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.27 seconds (4.27s).
[0m11:55:49.635648 [debug] [MainThread]: Command end result
[0m11:55:49.660089 [info ] [MainThread]: 
[0m11:55:49.660089 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:55:49.660089 [info ] [MainThread]: 
[0m11:55:49.660089 [error] [MainThread]:   Database Error in model airnow_hist_stage (models\airnow_staging\airnow_hist_stage.sql)
  Unrecognized name: DateObserverd; Did you mean DateObserved? at [57:5]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\airnow_hist_stage.sql
[0m11:55:49.660089 [info ] [MainThread]: 
[0m11:55:49.660089 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:55:49.668411 [debug] [MainThread]: Command `cli run` failed at 11:55:49.668411 after 6.50 seconds
[0m11:55:49.668411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F80F8380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F8962E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254F8962A50>]}
[0m11:55:49.668411 [debug] [MainThread]: Flushing usage events
[0m11:56:20.159591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAE9ECA6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAE9C8E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAE781B3B0>]}


============================== 11:56:20.162859 | 247a44e8-933c-4790-b713-da975e2d2d1b ==============================
[0m11:56:20.162859 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:56:20.162859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:56:21.064559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '247a44e8-933c-4790-b713-da975e2d2d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAE81EE120>]}
[0m11:56:21.106311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '247a44e8-933c-4790-b713-da975e2d2d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAFF1CD2B0>]}
[0m11:56:21.106311 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:56:21.106311 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m11:56:21.189974 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:56:21.189974 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m11:56:21.189974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '247a44e8-933c-4790-b713-da975e2d2d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA950CA720>]}
[0m11:56:22.139154 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m11:56:22.155783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '247a44e8-933c-4790-b713-da975e2d2d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA9517D400>]}
[0m11:56:22.223465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '247a44e8-933c-4790-b713-da975e2d2d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA95355670>]}
[0m11:56:22.223465 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 473 macros
[0m11:56:22.223465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '247a44e8-933c-4790-b713-da975e2d2d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA950F5EE0>]}
[0m11:56:22.236472 [info ] [MainThread]: 
[0m11:56:22.236472 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:56:22.238665 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m11:56:22.238665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:22.820328 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m11:56:22.822573 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m11:56:22.822573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:22.822573 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_airnow_staging'
[0m11:56:22.822573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:22.838870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:23.373786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '247a44e8-933c-4790-b713-da975e2d2d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA953EE4B0>]}
[0m11:56:23.373786 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:56:23.373786 [info ] [MainThread]: 
[0m11:56:23.373786 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m11:56:23.373786 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_hist_stage .................. [RUN]
[0m11:56:23.387479 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m11:56:23.387690 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m11:56:23.393368 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m11:56:23.393368 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m11:56:23.406631 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:56:23.872075 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m11:56:23.872075 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Historical Observations Staging Model ***/
/**
The below model converts all columns, except for 'DateObserved,' to the correct data type. 'DateObserved' is already
a TIMESTAMP data type.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT 
    * 
FROM airnow_hist_final
ORDER BY
    DateObserved DESC,
    HourObserved DESC,
    ParameterName
    );
  
[0m11:56:24.355512 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:976bd49e-188b-429b-9f52-e6124df017b9&page=queryresults
[0m11:56:27.753757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '247a44e8-933c-4790-b713-da975e2d2d1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAFF6828D0>]}
[0m11:56:27.753757 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_hist_stage ............. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 4.37s]
[0m11:56:27.765264 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m11:56:27.767706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:27.767706 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m11:56:27.770294 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m11:56:27.770294 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m11:56:27.770294 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_airnow_staging' was properly closed.
[0m11:56:27.770294 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m11:56:27.770294 [info ] [MainThread]: 
[0m11:56:27.770294 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m11:56:27.770294 [debug] [MainThread]: Command end result
[0m11:56:27.811264 [info ] [MainThread]: 
[0m11:56:27.811264 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:27.811264 [info ] [MainThread]: 
[0m11:56:27.811264 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:56:27.811264 [debug] [MainThread]: Command `cli run` succeeded at 11:56:27.811264 after 7.79 seconds
[0m11:56:27.811264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAE9A30500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAE9A652E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BAEA5C8B30>]}
[0m11:56:27.811264 [debug] [MainThread]: Flushing usage events
[0m11:58:19.352462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C6211400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C56CE2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C6166780>]}


============================== 11:58:19.352462 | 2e768174-4cb3-433d-9b3f-4eb969cd34c7 ==============================
[0m11:58:19.352462 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:58:19.352462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:58:20.237168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e768174-4cb3-433d-9b3f-4eb969cd34c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C407E2D0>]}
[0m11:58:20.285598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e768174-4cb3-433d-9b3f-4eb969cd34c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261EE4A6000>]}
[0m11:58:20.285598 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:58:20.297192 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m11:58:20.369101 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:58:20.369101 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m11:58:20.369101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e768174-4cb3-433d-9b3f-4eb969cd34c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261F0F70EC0>]}
[0m11:58:21.318247 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m11:58:21.318247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e768174-4cb3-433d-9b3f-4eb969cd34c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261F12F5160>]}
[0m11:58:21.402173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e768174-4cb3-433d-9b3f-4eb969cd34c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261F137CEF0>]}
[0m11:58:21.402173 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 473 macros
[0m11:58:21.402173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e768174-4cb3-433d-9b3f-4eb969cd34c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261F0FDF9E0>]}
[0m11:58:21.402173 [info ] [MainThread]: 
[0m11:58:21.402173 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:58:21.402173 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m11:58:21.402173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:21.918122 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m11:58:21.918122 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m11:58:21.918122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:21.918122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:58:22.468474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e768174-4cb3-433d-9b3f-4eb969cd34c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261F10D48F0>]}
[0m11:58:22.468474 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:58:22.468474 [info ] [MainThread]: 
[0m11:58:22.468474 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_realtime_stage
[0m11:58:22.468474 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_realtime_stage .............. [RUN]
[0m11:58:22.468474 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_realtime_stage'
[0m11:58:22.480750 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_realtime_stage
[0m11:58:22.480750 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_realtime_stage"
[0m11:58:22.488549 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_realtime_stage
[0m11:58:22.518312 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_realtime_stage"
[0m11:58:22.518312 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:58:22.518312 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_realtime_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_realtime_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Real-time Observations Staging Model ***/
/**
The below model converts all columns, except for 'DataPulledAt' and 'DateObserved,' to the correct data type.
'DataPulledAt' and 'DateObserverd' are already TIMESTAMP data types.
**/



WITH airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_raw_realtime`
),

airnow_realtime_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_realtime_source
),

airnow_realtime_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude_update,
        Longitude_update AS Longitude_update,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_realtime_update
),

SELECT
    *
FROM airnow_realtime_update
ORDER BY
    DateObserved DESC,
    HourObserved DESC,
    ParameterName
    );
  
[0m11:58:22.951254 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:0469aa63-50b5-434e-aab7-9ff4eaea8400&page=queryresults
[0m11:58:22.951254 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [53:1]; reason: invalidQuery, location: query, message: Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [53:1]')
[0m11:58:23.267852 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:5fc2af66-f5eb-44f8-81d5-a510f99ce8a8&page=queryresults
[0m11:58:23.278861 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:5fc2af66-f5eb-44f8-81d5-a510f99ce8a8&page=queryresults
[0m11:58:23.284060 [debug] [Thread-1 (]: Database Error in model airnow_realtime_stage (models\airnow_staging\airnow_realtime_stage.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [53:1]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\airnow_realtime_stage.sql
[0m11:58:23.284060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e768174-4cb3-433d-9b3f-4eb969cd34c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261F13FC560>]}
[0m11:58:23.284060 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model airnow_staging.airnow_realtime_stage ..... [[31mERROR[0m in 0.82s]
[0m11:58:23.284060 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_realtime_stage
[0m11:58:23.293271 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:58:23.294400 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m11:58:23.294400 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m11:58:23.294400 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m11:58:23.294400 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_realtime_stage' was properly closed.
[0m11:58:23.294400 [info ] [MainThread]: 
[0m11:58:23.297232 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m11:58:23.297918 [debug] [MainThread]: Command end result
[0m11:58:23.318937 [info ] [MainThread]: 
[0m11:58:23.318937 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:58:23.318937 [info ] [MainThread]: 
[0m11:58:23.318937 [error] [MainThread]:   Database Error in model airnow_realtime_stage (models\airnow_staging\airnow_realtime_stage.sql)
  Syntax error: Trailing comma after the WITH clause before the main query is not allowed at [53:1]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\airnow_realtime_stage.sql
[0m11:58:23.318937 [info ] [MainThread]: 
[0m11:58:23.318937 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:58:23.318937 [debug] [MainThread]: Command `cli run` failed at 11:58:23.318937 after 4.12 seconds
[0m11:58:23.318937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C64E7DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261C64E55E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261F1029A60>]}
[0m11:58:23.318937 [debug] [MainThread]: Flushing usage events
[0m11:59:08.694838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51BFFCA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51BAF5D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51B686270>]}


============================== 11:59:08.710246 | 23f9341b-5da8-4248-8fe9-1f5ec7fe24b7 ==============================
[0m11:59:08.710246 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:59:08.710965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:59:09.577014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23f9341b-5da8-4248-8fe9-1f5ec7fe24b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51A31E3F0>]}
[0m11:59:09.628659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23f9341b-5da8-4248-8fe9-1f5ec7fe24b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5457EEDE0>]}
[0m11:59:09.628659 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:59:09.628659 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m11:59:09.707562 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:59:09.709743 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m11:59:09.710790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '23f9341b-5da8-4248-8fe9-1f5ec7fe24b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51C8E2720>]}
[0m11:59:10.659814 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m11:59:10.676333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23f9341b-5da8-4248-8fe9-1f5ec7fe24b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5474C74A0>]}
[0m11:59:10.759138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23f9341b-5da8-4248-8fe9-1f5ec7fe24b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5474DF500>]}
[0m11:59:10.762776 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 473 macros
[0m11:59:10.762776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23f9341b-5da8-4248-8fe9-1f5ec7fe24b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A54750C7A0>]}
[0m11:59:10.762776 [info ] [MainThread]: 
[0m11:59:10.762776 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:59:10.762776 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m11:59:10.762776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:11.193011 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m11:59:11.193011 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m11:59:11.193011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:11.193011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:11.764898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23f9341b-5da8-4248-8fe9-1f5ec7fe24b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5474C4560>]}
[0m11:59:11.767007 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:59:11.787665 [info ] [MainThread]: 
[0m11:59:11.795688 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_realtime_stage
[0m11:59:11.799954 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_realtime_stage .............. [RUN]
[0m11:59:11.799954 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_realtime_stage'
[0m11:59:11.802205 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_realtime_stage
[0m11:59:11.803799 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_realtime_stage"
[0m11:59:11.803799 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_realtime_stage
[0m11:59:11.835740 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_realtime_stage"
[0m11:59:11.835740 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:59:11.835740 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_realtime_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_realtime_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Real-time Observations Staging Model ***/
/**
The below model converts all columns, except for 'DataPulledAt' and 'DateObserved,' to the correct data type.
'DataPulledAt' and 'DateObserverd' are already TIMESTAMP data types.
**/



WITH airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_raw_realtime`
),

airnow_realtime_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_realtime_source
),

airnow_realtime_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude_update,
        Longitude_update AS Longitude_update,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_realtime_update
)

SELECT
    *
FROM airnow_realtime_update
ORDER BY
    DateObserved DESC,
    HourObserved DESC,
    ParameterName
    );
  
[0m11:59:12.611210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:e91508db-2103-4de8-999c-864b7aa49408&page=queryresults
[0m11:59:14.775054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23f9341b-5da8-4248-8fe9-1f5ec7fe24b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5457DC470>]}
[0m11:59:14.775054 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_realtime_stage ......... [[32mCREATE TABLE (573.0 rows, 60.0 KiB processed)[0m in 2.98s]
[0m11:59:14.775054 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_realtime_stage
[0m11:59:14.788561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:59:14.788561 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m11:59:14.788561 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m11:59:14.788561 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m11:59:14.788561 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_realtime_stage' was properly closed.
[0m11:59:14.790855 [info ] [MainThread]: 
[0m11:59:14.791887 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.03 seconds (4.03s).
[0m11:59:14.791887 [debug] [MainThread]: Command end result
[0m11:59:14.815836 [info ] [MainThread]: 
[0m11:59:14.815836 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:59:14.815836 [info ] [MainThread]: 
[0m11:59:14.815836 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:59:14.815836 [debug] [MainThread]: Command `cli run` succeeded at 11:59:14.815836 after 6.26 seconds
[0m11:59:14.815836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51C4045F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51C763B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51C760A10>]}
[0m11:59:14.824056 [debug] [MainThread]: Flushing usage events
[0m11:59:56.193246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C53F17AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C5614A000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C56148B00>]}


============================== 11:59:56.202828 | ab617cc2-717f-4253-a367-bd527a87c047 ==============================
[0m11:59:56.202828 [info ] [MainThread]: Running with dbt=1.8.6
[0m11:59:56.202828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:59:57.089028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab617cc2-717f-4253-a367-bd527a87c047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C56959970>]}
[0m11:59:57.126131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab617cc2-717f-4253-a367-bd527a87c047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C7FC8ABD0>]}
[0m11:59:57.126131 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m11:59:57.137985 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m11:59:57.193380 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:59:57.206967 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m11:59:57.206967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ab617cc2-717f-4253-a367-bd527a87c047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C7FED2720>]}
[0m11:59:58.158535 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m11:59:58.175563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab617cc2-717f-4253-a367-bd527a87c047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C0172B5C0>]}
[0m11:59:58.243232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab617cc2-717f-4253-a367-bd527a87c047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C018BE4B0>]}
[0m11:59:58.243232 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 473 macros
[0m11:59:58.243232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab617cc2-717f-4253-a367-bd527a87c047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C018A4380>]}
[0m11:59:58.243232 [info ] [MainThread]: 
[0m11:59:58.243232 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:59:58.243232 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m11:59:58.255344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:58.775286 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m11:59:58.775286 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m11:59:58.775286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:58.775286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:59:59.492640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab617cc2-717f-4253-a367-bd527a87c047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C018708C0>]}
[0m11:59:59.502650 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:59:59.502650 [info ] [MainThread]: 
[0m11:59:59.509880 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_realtime_stage
[0m11:59:59.509880 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_realtime_stage .............. [RUN]
[0m11:59:59.509880 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_realtime_stage'
[0m11:59:59.514994 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_realtime_stage
[0m11:59:59.515736 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_realtime_stage"
[0m11:59:59.515736 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_realtime_stage
[0m11:59:59.528225 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:00:00.042326 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_realtime_stage"
[0m12:00:00.042326 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_realtime_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_realtime_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Real-time Observations Staging Model ***/
/**
The below model converts all columns, except for 'DataPulledAt' and 'DateObserved,' to the correct data type.
'DataPulledAt' and 'DateObserverd' are already TIMESTAMP data types.
**/



WITH airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_raw_realtime`
),

airnow_realtime_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_realtime_source
),

airnow_realtime_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude_update,
        Longitude_update AS Longitude_update,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_realtime_update
)

SELECT
    *
FROM airnow_realtime_final
ORDER BY
    DateObserved DESC,
    HourObserved DESC,
    ParameterName
    );
  
[0m12:00:00.492036 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:58f217ad-c988-4d7d-9ddc-db33676610e6&page=queryresults
[0m12:00:02.806740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab617cc2-717f-4253-a367-bd527a87c047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C7F911C10>]}
[0m12:00:02.806740 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_realtime_stage ......... [[32mCREATE TABLE (573.0 rows, 55.5 KiB processed)[0m in 3.30s]
[0m12:00:02.806740 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_realtime_stage
[0m12:00:02.806740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:02.806740 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m12:00:02.806740 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m12:00:02.806740 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m12:00:02.806740 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_realtime_stage' was properly closed.
[0m12:00:02.806740 [info ] [MainThread]: 
[0m12:00:02.806740 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.56 seconds (4.56s).
[0m12:00:02.806740 [debug] [MainThread]: Command end result
[0m12:00:02.827159 [info ] [MainThread]: 
[0m12:00:02.827159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:00:02.827159 [info ] [MainThread]: 
[0m12:00:02.827159 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:00:02.827159 [debug] [MainThread]: Command `cli run` succeeded at 12:00:02.827159 after 6.78 seconds
[0m12:00:02.827159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C56A31C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C56959190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C567EC4A0>]}
[0m12:00:02.827159 [debug] [MainThread]: Flushing usage events
[0m12:04:36.007325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51FA07EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A521A9A120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A521A9A570>]}


============================== 12:04:36.007325 | 11ac82d6-0885-47f6-aa66-38a0e75ec5d1 ==============================
[0m12:04:36.007325 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:04:36.007325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:04:36.889907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11ac82d6-0885-47f6-aa66-38a0e75ec5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51FF5E150>]}
[0m12:04:36.936439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11ac82d6-0885-47f6-aa66-38a0e75ec5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A51F6A95B0>]}
[0m12:04:36.952196 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:04:36.956695 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m12:04:37.023749 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:04:37.023749 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m12:04:37.023749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '11ac82d6-0885-47f6-aa66-38a0e75ec5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A54D021430>]}
[0m12:04:37.972230 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m12:04:37.972852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11ac82d6-0885-47f6-aa66-38a0e75ec5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A54D0E5400>]}
[0m12:04:38.055633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11ac82d6-0885-47f6-aa66-38a0e75ec5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A54CEAB920>]}
[0m12:04:38.060625 [info ] [MainThread]: Found 5 models, 4 data tests, 2 sources, 473 macros
[0m12:04:38.061337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11ac82d6-0885-47f6-aa66-38a0e75ec5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A522045EE0>]}
[0m12:04:38.061927 [info ] [MainThread]: 
[0m12:04:38.061927 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:04:38.061927 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m12:04:38.061927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:38.672922 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m12:04:38.672922 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m12:04:38.672922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:38.672922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:39.289002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11ac82d6-0885-47f6-aa66-38a0e75ec5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A54D2591F0>]}
[0m12:04:39.289002 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:04:39.289002 [info ] [MainThread]: 
[0m12:04:39.289002 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_realtime_stage
[0m12:04:39.298545 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_realtime_stage .............. [RUN]
[0m12:04:39.300264 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_realtime_stage'
[0m12:04:39.300503 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_realtime_stage
[0m12:04:39.307010 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_realtime_stage"
[0m12:04:39.307010 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_realtime_stage
[0m12:04:39.315444 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:04:39.921714 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_realtime_stage"
[0m12:04:39.921714 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_realtime_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_realtime_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Real-time Observations Staging Model ***/
/**
The below model converts all columns, except for 'DataPulledAt' and 'DateObserved,' to the correct data type.
'DataPulledAt' and 'DateObserverd' are already TIMESTAMP data types.
**/



WITH airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_raw_realtime`
),

airnow_realtime_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_realtime_source
),

airnow_realtime_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        AVG(Latitude_update) AS Latitude_update,
        AVG(Longitude_update) AS Longitude_update,
        ParameterName,
        AVG(AQI_update) AS AQI,
        AQICategory,
        AVG(AQICategoryNumber) AS AQICategoryNumber
    FROM airnow_realtime_update
    GROUP BY
        DateObserved,
        HourObserved_update,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName,
        AQICategory
        
)

SELECT
    *
FROM airnow_realtime_final
ORDER BY
    DateObserved DESC,
    HourObserved DESC,
    ParameterName
    );
  
[0m12:04:40.722110 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:0ace748c-1a0e-4be6-aff6-cebd5da52989&page=queryresults
[0m12:04:42.788136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11ac82d6-0885-47f6-aa66-38a0e75ec5d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A54B4100E0>]}
[0m12:04:42.788136 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_realtime_stage ......... [[32mCREATE TABLE (309.0 rows, 55.5 KiB processed)[0m in 3.49s]
[0m12:04:42.788136 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_realtime_stage
[0m12:04:42.788136 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:42.788136 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m12:04:42.788136 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m12:04:42.788136 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m12:04:42.788136 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_realtime_stage' was properly closed.
[0m12:04:42.788136 [info ] [MainThread]: 
[0m12:04:42.788136 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.73 seconds (4.73s).
[0m12:04:42.788136 [debug] [MainThread]: Command end result
[0m12:04:42.824430 [info ] [MainThread]: 
[0m12:04:42.824430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:04:42.825656 [info ] [MainThread]: 
[0m12:04:42.825656 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:04:42.825656 [debug] [MainThread]: Command `cli run` succeeded at 12:04:42.825656 after 6.96 seconds
[0m12:04:42.825656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5222DC110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5222DC530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A522275DC0>]}
[0m12:04:42.825656 [debug] [MainThread]: Flushing usage events
[0m12:12:49.594267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4993ADFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B498E07620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4989AEDB0>]}


============================== 12:12:49.597878 | 2d12ea4b-9923-4489-9e3c-13a909980376 ==============================
[0m12:12:49.597878 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:12:49.597878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:12:50.469231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d12ea4b-9923-4489-9e3c-13a909980376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4C39667E0>]}
[0m12:12:50.514455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d12ea4b-9923-4489-9e3c-13a909980376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4C38A5400>]}
[0m12:12:50.514455 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:12:50.514455 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m12:12:50.594883 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:12:50.596944 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m12:12:50.596944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d12ea4b-9923-4489-9e3c-13a909980376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4C3F7B260>]}
[0m12:12:51.415471 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:12:51.415471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2d12ea4b-9923-4489-9e3c-13a909980376', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4C4236C00>]}
[0m12:12:51.564208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m12:12:51.564208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d12ea4b-9923-4489-9e3c-13a909980376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4C143E270>]}
[0m12:12:51.647103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d12ea4b-9923-4489-9e3c-13a909980376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4C445A7B0>]}
[0m12:12:51.647103 [info ] [MainThread]: Found 5 models, 5 data tests, 2 sources, 473 macros
[0m12:12:51.647103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d12ea4b-9923-4489-9e3c-13a909980376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4C3FA71A0>]}
[0m12:12:51.647103 [info ] [MainThread]: 
[0m12:12:51.647103 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:12:51.647103 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m12:12:51.647103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:52.264390 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m12:12:52.264390 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m12:12:52.264390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:52.264390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:52.823434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d12ea4b-9923-4489-9e3c-13a909980376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4C429F560>]}
[0m12:12:52.823434 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:12:52.823434 [info ] [MainThread]: 
[0m12:12:52.830755 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m12:12:52.830755 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_hist_stage .................. [RUN]
[0m12:12:52.830755 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m12:12:52.839303 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m12:12:52.839490 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m12:12:52.839490 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m12:12:52.849442 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:12:53.312846 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m12:12:53.312846 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Historical Observations Staging Model ***/
/**
The below model converts all columns, except for 'DateObserved,' to the correct data type. 'DateObserved' is already
a TIMESTAMP data type.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT 
    * 
FROM airnow_hist_final
ORDER BY
    DateObserved DESC,
    HourObserved DESC,
    ParameterName
    );
  
[0m12:12:53.764195 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:357b5caa-8859-4d3c-952e-932829761d21&page=queryresults
[0m12:12:57.700552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d12ea4b-9923-4489-9e3c-13a909980376', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B4C2581F10>]}
[0m12:12:57.700552 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_hist_stage ............. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 4.87s]
[0m12:12:57.700552 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m12:12:57.707260 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:57.707260 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m12:12:57.708767 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m12:12:57.708767 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m12:12:57.711315 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m12:12:57.712287 [info ] [MainThread]: 
[0m12:12:57.721814 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m12:12:57.723591 [debug] [MainThread]: Command end result
[0m12:12:57.762379 [info ] [MainThread]: 
[0m12:12:57.762379 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:12:57.762379 [info ] [MainThread]: 
[0m12:12:57.769809 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:12:57.770799 [debug] [MainThread]: Command `cli run` succeeded at 12:12:57.770799 after 8.31 seconds
[0m12:12:57.770799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B495CD8E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B498D64F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B498D66E40>]}
[0m12:12:57.770799 [debug] [MainThread]: Flushing usage events
[0m13:13:18.057365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9AA15880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E97158FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9AA142F0>]}


============================== 13:13:18.057365 | 8998b646-d4ae-4d38-99a0-53eda32c268d ==============================
[0m13:13:18.057365 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:13:18.057365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:13:18.957234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8998b646-d4ae-4d38-99a0-53eda32c268d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9856E390>]}
[0m13:13:19.001130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8998b646-d4ae-4d38-99a0-53eda32c268d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC34ACEF0>]}
[0m13:13:19.001130 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:13:19.006725 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m13:13:19.073806 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:13:19.073806 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m13:13:19.073806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8998b646-d4ae-4d38-99a0-53eda32c268d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC5284E90>]}
[0m13:13:19.906897 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:13:19.916903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8998b646-d4ae-4d38-99a0-53eda32c268d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC574B0E0>]}
[0m13:13:20.068132 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m13:13:20.077135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8998b646-d4ae-4d38-99a0-53eda32c268d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9AA5ADB0>]}
[0m13:13:20.139720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8998b646-d4ae-4d38-99a0-53eda32c268d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC58A3890>]}
[0m13:13:20.139720 [info ] [MainThread]: Found 5 models, 6 data tests, 2 sources, 473 macros
[0m13:13:20.139720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8998b646-d4ae-4d38-99a0-53eda32c268d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC5888980>]}
[0m13:13:20.139720 [info ] [MainThread]: 
[0m13:13:20.154226 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:13:20.154226 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m13:13:20.156025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:20.587888 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m13:13:20.589378 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m13:13:20.589991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:20.589991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:21.140243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8998b646-d4ae-4d38-99a0-53eda32c268d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC592BC80>]}
[0m13:13:21.152842 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:13:21.152842 [info ] [MainThread]: 
[0m13:13:21.155925 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m13:13:21.155925 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_hist_stage .................. [RUN]
[0m13:13:21.155925 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m13:13:21.161110 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m13:13:21.161110 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m13:13:21.161110 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m13:13:21.175860 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:13:21.626383 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m13:13:21.627564 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Historical Observations Staging Model ***/
/**
The below model converts all columns, except for 'DateObserved,' to the correct data type. 'DateObserved' is already
a TIMESTAMP data type.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT 
    * 
FROM airnow_hist_final
ORDER BY
    DateObserved DESC,
    ParameterName
    );
  
[0m13:13:22.074312 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:b28e611b-9025-4d9e-b2d1-61df0792ab8b&page=queryresults
[0m13:13:25.670976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8998b646-d4ae-4d38-99a0-53eda32c268d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016EC3A02B40>]}
[0m13:13:25.670976 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_hist_stage ............. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 4.52s]
[0m13:13:25.670976 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m13:13:25.678152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:25.678152 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m13:13:25.678152 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m13:13:25.678152 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m13:13:25.678152 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m13:13:25.678152 [info ] [MainThread]: 
[0m13:13:25.678152 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.54 seconds (5.54s).
[0m13:13:25.678152 [debug] [MainThread]: Command end result
[0m13:13:25.699594 [info ] [MainThread]: 
[0m13:13:25.699594 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:13:25.703510 [info ] [MainThread]: 
[0m13:13:25.703510 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:13:25.703510 [debug] [MainThread]: Command `cli run` succeeded at 13:13:25.703510 after 7.77 seconds
[0m13:13:25.703510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E97158FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9A9B3AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E9A948FB0>]}
[0m13:13:25.703510 [debug] [MainThread]: Flushing usage events
[0m13:15:40.172206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB226ABC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB217E8CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB24F1BEC0>]}


============================== 13:15:40.172206 | d6e5e12f-ded5-44ff-b48a-44c9d2377fde ==============================
[0m13:15:40.172206 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:15:40.172206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m13:15:41.054853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6e5e12f-ded5-44ff-b48a-44c9d2377fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4CFBF440>]}
[0m13:15:41.089646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6e5e12f-ded5-44ff-b48a-44c9d2377fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB25242E70>]}
[0m13:15:41.089646 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:15:41.105027 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m13:15:41.221525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:15:41.221525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:15:41.233614 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m13:15:41.255998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6e5e12f-ded5-44ff-b48a-44c9d2377fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4F8B6330>]}
[0m13:15:41.337939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6e5e12f-ded5-44ff-b48a-44c9d2377fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4FDC8650>]}
[0m13:15:41.337939 [info ] [MainThread]: Found 5 models, 6 data tests, 2 sources, 473 macros
[0m13:15:41.337939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6e5e12f-ded5-44ff-b48a-44c9d2377fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4F8B6FF0>]}
[0m13:15:41.337939 [info ] [MainThread]: 
[0m13:15:41.337939 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:15:41.337939 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m13:15:41.337939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:41.855232 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m13:15:41.855232 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m13:15:41.855232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:41.855232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:42.383958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6e5e12f-ded5-44ff-b48a-44c9d2377fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4FB5B020>]}
[0m13:15:42.383958 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:15:42.387562 [info ] [MainThread]: 
[0m13:15:42.393625 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m13:15:42.393625 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_hist_stage .................. [RUN]
[0m13:15:42.393625 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m13:15:42.395810 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m13:15:42.395810 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m13:15:42.395810 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m13:15:42.407224 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:15:42.899436 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m13:15:42.899436 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Historical Observations Staging Model ***/
/**
The below model converts all columns, except for 'DateObserved,' to the correct data type. 'DateObserved' is already
a TIMESTAMP data type.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT 
    * 
FROM airnow_hist_final
ORDER BY
    DateObserved DESC,
    ParameterName
    );
  
[0m13:15:43.488254 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:0afa691b-c8a6-43ed-b237-f25769fb0ffa&page=queryresults
[0m13:15:47.934980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6e5e12f-ded5-44ff-b48a-44c9d2377fde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB4E0C0650>]}
[0m13:15:47.934980 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_hist_stage ............. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 5.54s]
[0m13:15:47.934980 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m13:15:47.945487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:47.945487 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m13:15:47.945487 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m13:15:47.945487 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m13:15:47.945487 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m13:15:47.945487 [info ] [MainThread]: 
[0m13:15:47.945487 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m13:15:47.945487 [debug] [MainThread]: Command end result
[0m13:15:47.972010 [info ] [MainThread]: 
[0m13:15:47.980016 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:47.980016 [info ] [MainThread]: 
[0m13:15:47.980016 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:15:47.980016 [debug] [MainThread]: Command `cli run` succeeded at 13:15:47.980016 after 7.97 seconds
[0m13:15:47.980016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB241BEC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB24F7DEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB24FD8B00>]}
[0m13:15:47.980016 [debug] [MainThread]: Flushing usage events
[0m13:16:24.303597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C32130A540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3210A3B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C323923350>]}


============================== 13:16:24.303597 | 8e4a1859-6070-41bc-8337-8a618344ccd6 ==============================
[0m13:16:24.303597 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:16:24.310607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:16:25.184707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e4a1859-6070-41bc-8337-8a618344ccd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34CAA5FD0>]}
[0m13:16:25.228858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e4a1859-6070-41bc-8337-8a618344ccd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C323C3A2D0>]}
[0m13:16:25.228858 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:16:25.234600 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m13:16:25.303463 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:16:25.303463 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m13:16:25.303463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8e4a1859-6070-41bc-8337-8a618344ccd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34E758E30>]}
[0m13:16:26.117959 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:16:26.117959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8e4a1859-6070-41bc-8337-8a618344ccd6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34E7D7440>]}
[0m13:16:26.267619 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m13:16:26.267619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e4a1859-6070-41bc-8337-8a618344ccd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34E5E0440>]}
[0m13:16:26.350927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e4a1859-6070-41bc-8337-8a618344ccd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34EA03740>]}
[0m13:16:26.350927 [info ] [MainThread]: Found 5 models, 6 data tests, 2 sources, 473 macros
[0m13:16:26.350927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e4a1859-6070-41bc-8337-8a618344ccd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34E9681A0>]}
[0m13:16:26.350927 [info ] [MainThread]: 
[0m13:16:26.350927 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:16:26.350927 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m13:16:26.350927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:26.903479 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m13:16:26.917995 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m13:16:26.917995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:26.917995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:27.468242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e4a1859-6070-41bc-8337-8a618344ccd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34E9A51C0>]}
[0m13:16:27.468242 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:16:27.468242 [info ] [MainThread]: 
[0m13:16:27.468242 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m13:16:27.483949 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_hist_stage .................. [RUN]
[0m13:16:27.483949 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m13:16:27.486194 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m13:16:27.491454 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m13:16:27.491454 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m13:16:27.504813 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:16:28.050251 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m13:16:28.050251 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Historical Observations Staging Model ***/
/**
The below model converts all columns, except for 'DateObserved,' to the correct data type. 'DateObserved' is already
a TIMESTAMP data type.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT 
    * 
FROM airnow_hist_final
ORDER BY
    DateObserved DESC
    );
  
[0m13:16:28.650767 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:440e25ef-30df-4f75-9cc4-70d70567ea1c&page=queryresults
[0m13:16:32.964615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e4a1859-6070-41bc-8337-8a618344ccd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34EAFBC50>]}
[0m13:16:32.964615 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_hist_stage ............. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 5.48s]
[0m13:16:32.964615 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m13:16:32.970143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:32.970143 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m13:16:32.970143 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m13:16:32.970143 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m13:16:32.970143 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m13:16:32.970143 [info ] [MainThread]: 
[0m13:16:32.970143 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.62 seconds (6.62s).
[0m13:16:32.970143 [debug] [MainThread]: Command end result
[0m13:16:32.990847 [info ] [MainThread]: 
[0m13:16:32.994004 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:32.994588 [info ] [MainThread]: 
[0m13:16:32.995286 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:16:32.995703 [debug] [MainThread]: Command `cli run` succeeded at 13:16:32.995703 after 8.82 seconds
[0m13:16:32.995703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3232A7A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3232A5A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C323A955E0>]}
[0m13:16:32.995703 [debug] [MainThread]: Flushing usage events
[0m13:26:56.632995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B2D03FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1AF4EFC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B2D00A10>]}


============================== 13:26:56.648599 | 0aad9ca2-b58c-4c9d-811d-326bf95a494f ==============================
[0m13:26:56.648599 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:26:56.648599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:26:57.554240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0aad9ca2-b58c-4c9d-811d-326bf95a494f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1DD726F00>]}
[0m13:26:57.585793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0aad9ca2-b58c-4c9d-811d-326bf95a494f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1DB0B71D0>]}
[0m13:26:57.585793 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:26:57.601440 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m13:26:57.672058 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:26:57.672058 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m13:26:57.672058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0aad9ca2-b58c-4c9d-811d-326bf95a494f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1DD989280>]}
[0m13:26:58.596671 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:26:58.596671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0aad9ca2-b58c-4c9d-811d-326bf95a494f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1DDA43E00>]}
[0m13:26:58.756483 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m13:26:58.757596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0aad9ca2-b58c-4c9d-811d-326bf95a494f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1DDBBD3A0>]}
[0m13:26:58.840762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0aad9ca2-b58c-4c9d-811d-326bf95a494f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1DDBFCAA0>]}
[0m13:26:58.841770 [info ] [MainThread]: Found 6 models, 6 data tests, 2 sources, 473 macros
[0m13:26:58.841770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aad9ca2-b58c-4c9d-811d-326bf95a494f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1DDBBCE00>]}
[0m13:26:58.842788 [info ] [MainThread]: 
[0m13:26:58.844123 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:26:58.845131 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m13:26:58.845131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:59.484240 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_key-polymer-434418-m6, now create_key-polymer-434418-m6_airnow_airnow_staging)
[0m13:26:59.485277 [debug] [ThreadPool]: Creating schema "database: "key-polymer-434418-m6"
schema: "airnow_airnow_staging"
"
[0m13:26:59.497947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:59.499218 [debug] [ThreadPool]: On create_key-polymer-434418-m6_airnow_airnow_staging: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "connection_name": "create_key-polymer-434418-m6_airnow_airnow_staging"} */
create schema if not exists `key-polymer-434418-m6`.`airnow_airnow_staging`
  
[0m13:27:00.069770 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:7daa5164-632b-4c8d-93b5-95ae07e6a9eb&page=queryresults
[0m13:27:02.872654 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_airnow_staging'
[0m13:27:02.872654 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m13:27:02.872654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:02.872654 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m13:27:02.872654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:02.872654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:03.523599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0aad9ca2-b58c-4c9d-811d-326bf95a494f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1DDA6D160>]}
[0m13:27:03.523599 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:27:03.523599 [info ] [MainThread]: 
[0m13:27:03.546464 [debug] [Thread-1 (]: Began running node model.airnow_dbt.date_spine
[0m13:27:03.546464 [info ] [Thread-1 (]: 1 of 1 START sql view model airnow_airnow_staging.date_spine ................... [RUN]
[0m13:27:03.549196 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.date_spine'
[0m13:27:03.549196 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.date_spine
[0m13:27:03.555377 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.date_spine"
[0m13:27:03.558382 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.date_spine
[0m13:27:03.574933 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.date_spine"
[0m13:27:03.574933 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:27:03.574933 [debug] [Thread-1 (]: On model.airnow_dbt.date_spine: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.date_spine"} */


  create or replace view `key-polymer-434418-m6`.`airnow_airnow_staging`.`date_spine`
  OPTIONS()
  as /*** Date Spine Table ***/
/** This table will be used to create a list of dates between 2019-01-01 and
2024-09-01.'
**/

WITH RECURSIVE date_spine AS (
    SELECT
        DATE('2019-01-01') AS date_day
    UNION ALL
    SELECT
        DATE_ADD(date_day, INTERVAL 1 DAY)
    FROM
        date_spine
    WHERE
        date_day < '2024-09-01'
)

SELECT
    date_day
FROM
    date_spine;;


[0m13:27:04.062352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:7aef3ffd-3203-4050-aa50-1c703a498eef&page=queryresults
[0m13:27:04.071744 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ";" at [26:16]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ";" at [26:16]')
[0m13:27:05.197331 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:991ee858-3e69-4e91-b323-7f15c50a5485&page=queryresults
[0m13:27:05.197331 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:991ee858-3e69-4e91-b323-7f15c50a5485&page=queryresults
[0m13:27:05.205753 [debug] [Thread-1 (]: Database Error in model date_spine (models\airnow_staging\date_spine.sql)
  Syntax error: Unexpected ";" at [26:16]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\date_spine.sql
[0m13:27:05.205753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0aad9ca2-b58c-4c9d-811d-326bf95a494f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1DDD19790>]}
[0m13:27:05.205753 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model airnow_airnow_staging.date_spine .......... [[31mERROR[0m in 1.66s]
[0m13:27:05.205753 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.date_spine
[0m13:27:05.205753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:05.213824 [debug] [MainThread]: Connection 'create_key-polymer-434418-m6_airnow_airnow_staging' was properly closed.
[0m13:27:05.213824 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_airnow_staging' was properly closed.
[0m13:27:05.213824 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m13:27:05.213824 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m13:27:05.213824 [debug] [MainThread]: Connection 'model.airnow_dbt.date_spine' was properly closed.
[0m13:27:05.213824 [info ] [MainThread]: 
[0m13:27:05.213824 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.37 seconds (6.37s).
[0m13:27:05.213824 [debug] [MainThread]: Command end result
[0m13:27:05.241303 [info ] [MainThread]: 
[0m13:27:05.241303 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:27:05.241303 [info ] [MainThread]: 
[0m13:27:05.241303 [error] [MainThread]:   Database Error in model date_spine (models\airnow_staging\date_spine.sql)
  Syntax error: Unexpected ";" at [26:16]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\date_spine.sql
[0m13:27:05.241303 [info ] [MainThread]: 
[0m13:27:05.241303 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:27:05.241303 [debug] [MainThread]: Command `cli run` failed at 13:27:05.241303 after 8.75 seconds
[0m13:27:05.241303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1AF4EFC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B2C08830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1B0503230>]}
[0m13:27:05.241303 [debug] [MainThread]: Flushing usage events
[0m13:27:24.238056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA9F87E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DAC155BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DAC156300>]}


============================== 13:27:24.245207 | 2d1e119e-f847-4707-93ba-6d19e991b3e9 ==============================
[0m13:27:24.245207 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:27:24.245207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:27:25.127926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d1e119e-f847-4707-93ba-6d19e991b3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DD73E0A70>]}
[0m13:27:25.169484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d1e119e-f847-4707-93ba-6d19e991b3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DAC1BDE50>]}
[0m13:27:25.169484 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:27:25.169484 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m13:27:25.242104 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:27:25.242104 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m13:27:25.243794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d1e119e-f847-4707-93ba-6d19e991b3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DD542C710>]}
[0m13:27:26.063086 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:27:26.063086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2d1e119e-f847-4707-93ba-6d19e991b3e9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DD74B5010>]}
[0m13:27:26.227376 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m13:27:26.227376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d1e119e-f847-4707-93ba-6d19e991b3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DD77EDA60>]}
[0m13:27:26.310937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d1e119e-f847-4707-93ba-6d19e991b3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DD7654620>]}
[0m13:27:26.310937 [info ] [MainThread]: Found 6 models, 6 data tests, 2 sources, 473 macros
[0m13:27:26.310937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d1e119e-f847-4707-93ba-6d19e991b3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DD7491A60>]}
[0m13:27:26.310937 [info ] [MainThread]: 
[0m13:27:26.310937 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:27:26.310937 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m13:27:26.310937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:26.806776 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_airnow_staging'
[0m13:27:26.806776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:26.806776 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m13:27:26.827134 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m13:27:26.838640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:26.838640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:27.352831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d1e119e-f847-4707-93ba-6d19e991b3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DAB992540>]}
[0m13:27:27.353921 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:27:27.353921 [info ] [MainThread]: 
[0m13:27:27.361411 [debug] [Thread-1 (]: Began running node model.airnow_dbt.date_spine
[0m13:27:27.362518 [info ] [Thread-1 (]: 1 of 1 START sql view model airnow_airnow_staging.date_spine ................... [RUN]
[0m13:27:27.363705 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.date_spine'
[0m13:27:27.363705 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.date_spine
[0m13:27:27.370261 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.date_spine"
[0m13:27:27.371363 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.date_spine
[0m13:27:27.394928 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.date_spine"
[0m13:27:27.394928 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:27:27.394928 [debug] [Thread-1 (]: On model.airnow_dbt.date_spine: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.date_spine"} */


  create or replace view `key-polymer-434418-m6`.`airnow_airnow_staging`.`date_spine`
  OPTIONS()
  as /*** Date Spine Table ***/
/** This table will be used to create a list of dates between 2019-01-01 and
2024-09-01.'
**/

WITH RECURSIVE date_spine AS (
    SELECT
        DATE('2019-01-01') AS date_day
    UNION ALL
    SELECT
        DATE_ADD(date_day, INTERVAL 1 DAY)
    FROM
        date_spine
    WHERE
        date_day < '2024-09-01'
)

SELECT
    date_day
FROM
    date_spine;


[0m13:27:28.027763 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:5def89e7-7adc-4ed0-9f19-bfd3718e10a4&page=queryresults
[0m13:27:28.459746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d1e119e-f847-4707-93ba-6d19e991b3e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DD5981C40>]}
[0m13:27:28.459746 [info ] [Thread-1 (]: 1 of 1 OK created sql view model airnow_airnow_staging.date_spine .............. [[32mCREATE VIEW (0 processed)[0m in 1.10s]
[0m13:27:28.459746 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.date_spine
[0m13:27:28.468539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:28.468539 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m13:27:28.468539 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_airnow_staging' was properly closed.
[0m13:27:28.468539 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m13:27:28.468539 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m13:27:28.468539 [debug] [MainThread]: Connection 'model.airnow_dbt.date_spine' was properly closed.
[0m13:27:28.468539 [info ] [MainThread]: 
[0m13:27:28.468539 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m13:27:28.471917 [debug] [MainThread]: Command end result
[0m13:27:28.493947 [info ] [MainThread]: 
[0m13:27:28.493947 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:28.493947 [info ] [MainThread]: 
[0m13:27:28.493947 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:27:28.493947 [debug] [MainThread]: Command `cli run` succeeded at 13:27:28.493947 after 4.40 seconds
[0m13:27:28.493947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DA9F23080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DACAA2C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022DACAA1550>]}
[0m13:27:28.493947 [debug] [MainThread]: Flushing usage events
[0m13:37:26.355769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580BA8CCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258090E75F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580971A060>]}


============================== 13:37:26.358783 | 5107e9fb-6598-4825-855e-0e9c449e4238 ==============================
[0m13:37:26.358783 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:37:26.358783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:37:27.229012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5107e9fb-6598-4825-855e-0e9c449e4238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580AC45FD0>]}
[0m13:37:27.276405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5107e9fb-6598-4825-855e-0e9c449e4238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025836473350>]}
[0m13:37:27.276405 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:37:27.285223 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m13:37:27.408326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:37:27.408326 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:37:27.408326 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m13:37:27.448040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5107e9fb-6598-4825-855e-0e9c449e4238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258365B1B20>]}
[0m13:37:27.596668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5107e9fb-6598-4825-855e-0e9c449e4238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258369BAA20>]}
[0m13:37:27.596668 [info ] [MainThread]: Found 6 models, 7 data tests, 2 sources, 474 macros
[0m13:37:27.596668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5107e9fb-6598-4825-855e-0e9c449e4238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580BC55D90>]}
[0m13:37:27.596668 [info ] [MainThread]: 
[0m13:37:27.596668 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:37:27.596668 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m13:37:27.596668 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m13:37:27.596668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:27.596668 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_airnow_staging'
[0m13:37:27.596668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:27.616950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:28.224436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5107e9fb-6598-4825-855e-0e9c449e4238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025834B6DEE0>]}
[0m13:37:28.224436 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:37:28.224436 [info ] [MainThread]: 
[0m13:37:28.224436 [debug] [Thread-1 (]: Began running node test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462
[0m13:37:28.224436 [debug] [Thread-2 (]: Began running node test.airnow_dbt.not_null_airnow_realtime_stage_.34f7160b25
[0m13:37:28.224436 [debug] [Thread-3 (]: Began running node test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:37:28.224436 [debug] [Thread-4 (]: Began running node test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:37:28.240035 [info ] [Thread-1 (]: 1 of 7 START test not_null_airnow_hist_stage_ .................................. [RUN]
[0m13:37:28.243776 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462'
[0m13:37:28.241083 [info ] [Thread-2 (]: 2 of 7 START test not_null_airnow_realtime_stage_ .............................. [RUN]
[0m13:37:28.243776 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462
[0m13:37:28.241271 [info ] [Thread-3 (]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m13:37:28.243776 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.airnow_dbt.not_null_airnow_realtime_stage_.34f7160b25'
[0m13:37:28.242126 [info ] [Thread-4 (]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m13:37:28.248544 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462"
[0m13:37:28.248544 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:37:28.248544 [debug] [Thread-2 (]: Began compiling node test.airnow_dbt.not_null_airnow_realtime_stage_.34f7160b25
[0m13:37:28.248544 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m13:37:28.265634 [debug] [Thread-4 (]: Began compiling node test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:37:28.265634 [debug] [Thread-2 (]: Writing injected SQL for node "test.airnow_dbt.not_null_airnow_realtime_stage_.34f7160b25"
[0m13:37:28.265634 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462
[0m13:37:28.248544 [debug] [Thread-3 (]: Began compiling node test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:37:28.265634 [debug] [Thread-4 (]: Writing injected SQL for node "test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m13:37:28.272381 [debug] [Thread-1 (]: Writing runtime sql for node "test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462"
[0m13:37:28.285754 [debug] [Thread-3 (]: Writing injected SQL for node "test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:37:28.285754 [debug] [Thread-2 (]: Began executing node test.airnow_dbt.not_null_airnow_realtime_stage_.34f7160b25
[0m13:37:28.288261 [debug] [Thread-2 (]: Writing runtime sql for node "test.airnow_dbt.not_null_airnow_realtime_stage_.34f7160b25"
[0m13:37:28.288261 [debug] [Thread-3 (]: Began executing node test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:37:28.288261 [debug] [Thread-3 (]: Writing runtime sql for node "test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:37:28.288261 [debug] [Thread-4 (]: Began executing node test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:37:28.288261 [debug] [Thread-4 (]: Writing runtime sql for node "test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m13:37:28.288261 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:37:28.288261 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:37:28.288261 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:37:28.288261 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:37:28.297587 [debug] [Thread-3 (]: On test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `key-polymer-434418-m6`.`airnow`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m13:37:28.297587 [debug] [Thread-1 (]: On test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select 
from `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
where  is null



      
    ) dbt_internal_test
[0m13:37:28.297587 [debug] [Thread-4 (]: On test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `key-polymer-434418-m6`.`airnow`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m13:37:28.297587 [debug] [Thread-2 (]: On test.airnow_dbt.not_null_airnow_realtime_stage_.34f7160b25: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.not_null_airnow_realtime_stage_.34f7160b25"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select 
from `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
where  is null



      
    ) dbt_internal_test
[0m13:37:28.827027 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:35e37ac2-7067-452c-8477-1d3056fd3328&page=queryresults
[0m13:37:28.827027 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: SELECT list must not be empty at [14:1]; reason: invalidQuery, location: query, message: Syntax error: SELECT list must not be empty at [14:1]')
[0m13:37:28.827027 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:24af5be7-55a6-4080-9944-1d931086ad9f&page=queryresults
[0m13:37:28.827027 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: SELECT list must not be empty at [14:1]; reason: invalidQuery, location: query, message: Syntax error: SELECT list must not be empty at [14:1]')
[0m13:37:28.841034 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:c913340a-808f-467e-b6dd-ef842dfa9ee7&page=queryresults
[0m13:37:28.841034 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `key-polymer-434418-m6`.`airnow`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m13:37:28.841034 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset key-polymer-434418-m6:airnow was not found in location US; reason: notFound, message: Not found: Dataset key-polymer-434418-m6:airnow was not found in location US

Location: US
Job ID: c913340a-808f-467e-b6dd-ef842dfa9ee7

[0m13:37:28.857242 [debug] [Thread-3 (]: Runtime Error in test not_null_my_first_dbt_model_id (models\example\schema.yml)
  404 Not found: Dataset key-polymer-434418-m6:airnow was not found in location US; reason: notFound, message: Not found: Dataset key-polymer-434418-m6:airnow was not found in location US
  
  Location: US
  Job ID: c913340a-808f-467e-b6dd-ef842dfa9ee7
  
[0m13:37:28.857242 [error] [Thread-3 (]: 3 of 7 ERROR not_null_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.61s]
[0m13:37:28.857242 [debug] [Thread-3 (]: Finished running node test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:37:28.857242 [debug] [Thread-3 (]: Began running node test.airnow_dbt.test_missing_dates_airnow_hist_stage_.8dc63f15eb
[0m13:37:28.857242 [info ] [Thread-3 (]: 5 of 7 START test test_missing_dates_airnow_hist_stage_ ........................ [RUN]
[0m13:37:28.873216 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airnow_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.airnow_dbt.test_missing_dates_airnow_hist_stage_.8dc63f15eb)
[0m13:37:28.873216 [debug] [Thread-3 (]: Began compiling node test.airnow_dbt.test_missing_dates_airnow_hist_stage_.8dc63f15eb
[0m13:37:28.891152 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:2f9a21c2-8125-414e-8ca4-0761797c149e&page=queryresults
[0m13:37:28.893752 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `key-polymer-434418-m6`.`airnow`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m13:37:28.893752 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Dataset key-polymer-434418-m6:airnow was not found in location US; reason: notFound, message: Not found: Dataset key-polymer-434418-m6:airnow was not found in location US

Location: US
Job ID: 2f9a21c2-8125-414e-8ca4-0761797c149e

[0m13:37:28.893752 [debug] [Thread-4 (]: Runtime Error in test not_null_my_second_dbt_model_id (models\example\schema.yml)
  404 Not found: Dataset key-polymer-434418-m6:airnow was not found in location US; reason: notFound, message: Not found: Dataset key-polymer-434418-m6:airnow was not found in location US
  
  Location: US
  Job ID: 2f9a21c2-8125-414e-8ca4-0761797c149e
  
[0m13:37:28.893752 [error] [Thread-4 (]: 4 of 7 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.65s]
[0m13:37:28.897845 [debug] [Thread-4 (]: Finished running node test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m13:37:28.897845 [debug] [Thread-4 (]: Began running node test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:37:28.898900 [info ] [Thread-4 (]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m13:37:28.898900 [debug] [Thread-3 (]: Compilation Error in test test_missing_dates_airnow_hist_stage_ (models\airnow_staging\schema.yml)
  'test_test_missing_dates' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:37:28.898900 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.airnow_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m13:37:28.898900 [error] [Thread-3 (]: 5 of 7 ERROR test_missing_dates_airnow_hist_stage_ ............................. [[31mERROR[0m in 0.03s]
[0m13:37:28.898900 [debug] [Thread-4 (]: Began compiling node test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:37:28.898900 [debug] [Thread-3 (]: Finished running node test.airnow_dbt.test_missing_dates_airnow_hist_stage_.8dc63f15eb
[0m13:37:28.907020 [debug] [Thread-4 (]: Writing injected SQL for node "test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m13:37:28.907251 [debug] [Thread-3 (]: Began running node test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:37:28.908045 [info ] [Thread-3 (]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m13:37:28.908045 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.airnow_dbt.test_missing_dates_airnow_hist_stage_.8dc63f15eb, now test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:37:28.909210 [debug] [Thread-3 (]: Began compiling node test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:37:28.910163 [debug] [Thread-4 (]: Began executing node test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:37:28.910163 [debug] [Thread-3 (]: Writing injected SQL for node "test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:37:28.914349 [debug] [Thread-4 (]: Writing runtime sql for node "test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m13:37:28.914349 [debug] [Thread-3 (]: Began executing node test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:37:28.914349 [debug] [Thread-3 (]: Writing runtime sql for node "test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:37:28.914349 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:37:28.914349 [debug] [Thread-4 (]: On test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `key-polymer-434418-m6`.`airnow`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:37:28.938875 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:37:28.938875 [debug] [Thread-3 (]: On test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `key-polymer-434418-m6`.`airnow`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:37:29.493291 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:2dac9dbd-fcbe-46b8-b7f7-53415c48e8ef&page=queryresults
[0m13:37:29.496764 [debug] [Thread-4 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `key-polymer-434418-m6`.`airnow`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:37:29.495525 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:15e3e735-533c-4cb6-b80b-8918cf5f30b6&page=queryresults
[0m13:37:29.497409 [debug] [Thread-4 (]: BigQuery adapter: 404 Not found: Dataset key-polymer-434418-m6:airnow was not found in location US; reason: notFound, message: Not found: Dataset key-polymer-434418-m6:airnow was not found in location US

Location: US
Job ID: 2dac9dbd-fcbe-46b8-b7f7-53415c48e8ef

[0m13:37:29.498498 [debug] [Thread-3 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `key-polymer-434418-m6`.`airnow`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m13:37:29.501124 [debug] [Thread-3 (]: BigQuery adapter: 404 Not found: Dataset key-polymer-434418-m6:airnow was not found in location US; reason: notFound, message: Not found: Dataset key-polymer-434418-m6:airnow was not found in location US

Location: US
Job ID: 15e3e735-533c-4cb6-b80b-8918cf5f30b6

[0m13:37:29.504717 [debug] [Thread-4 (]: Runtime Error in test unique_my_first_dbt_model_id (models\example\schema.yml)
  404 Not found: Dataset key-polymer-434418-m6:airnow was not found in location US; reason: notFound, message: Not found: Dataset key-polymer-434418-m6:airnow was not found in location US
  
  Location: US
  Job ID: 2dac9dbd-fcbe-46b8-b7f7-53415c48e8ef
  
[0m13:37:29.505801 [error] [Thread-4 (]: 6 of 7 ERROR unique_my_first_dbt_model_id ...................................... [[31mERROR[0m in 0.61s]
[0m13:37:29.505801 [debug] [Thread-4 (]: Finished running node test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321
[0m13:37:29.505801 [debug] [Thread-3 (]: Runtime Error in test unique_my_second_dbt_model_id (models\example\schema.yml)
  404 Not found: Dataset key-polymer-434418-m6:airnow was not found in location US; reason: notFound, message: Not found: Dataset key-polymer-434418-m6:airnow was not found in location US
  
  Location: US
  Job ID: 15e3e735-533c-4cb6-b80b-8918cf5f30b6
  
[0m13:37:29.505801 [error] [Thread-3 (]: 7 of 7 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.60s]
[0m13:37:29.511313 [debug] [Thread-3 (]: Finished running node test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m13:37:29.538098 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:4af5b5d8-a368-4c90-9225-b263cca8018d&page=queryresults
[0m13:37:29.538098 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:4af5b5d8-a368-4c90-9225-b263cca8018d&page=queryresults
[0m13:37:29.552203 [debug] [Thread-1 (]: Database Error in test not_null_airnow_hist_stage_ (models\airnow_staging\schema.yml)
  Syntax error: SELECT list must not be empty at [14:1]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\schema.yml\not_null_airnow_hist_stage_.sql
[0m13:37:29.552203 [error] [Thread-1 (]: 1 of 7 ERROR not_null_airnow_hist_stage_ ....................................... [[31mERROR[0m in 1.31s]
[0m13:37:29.552203 [debug] [Thread-1 (]: Finished running node test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462
[0m13:37:30.060544 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:12e9eaca-a542-4311-a824-625f53e09f28&page=queryresults
[0m13:37:30.060544 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:12e9eaca-a542-4311-a824-625f53e09f28&page=queryresults
[0m13:37:30.077307 [debug] [Thread-2 (]: Database Error in test not_null_airnow_realtime_stage_ (models\airnow_staging\schema.yml)
  Syntax error: SELECT list must not be empty at [14:1]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\schema.yml\not_null_airnow_realtime_stage_.sql
[0m13:37:30.077307 [error] [Thread-2 (]: 2 of 7 ERROR not_null_airnow_realtime_stage_ ................................... [[31mERROR[0m in 1.83s]
[0m13:37:30.079221 [debug] [Thread-2 (]: Finished running node test.airnow_dbt.not_null_airnow_realtime_stage_.34f7160b25
[0m13:37:30.082243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:30.082243 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m13:37:30.082243 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m13:37:30.082243 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_airnow_staging' was properly closed.
[0m13:37:30.082243 [debug] [MainThread]: Connection 'test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462' was properly closed.
[0m13:37:30.082243 [debug] [MainThread]: Connection 'test.airnow_dbt.not_null_airnow_realtime_stage_.34f7160b25' was properly closed.
[0m13:37:30.082243 [debug] [MainThread]: Connection 'test.airnow_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:37:30.082243 [debug] [MainThread]: Connection 'test.airnow_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m13:37:30.082243 [info ] [MainThread]: 
[0m13:37:30.082243 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m13:37:30.086846 [debug] [MainThread]: Command end result
[0m13:37:30.169148 [info ] [MainThread]: 
[0m13:37:30.169148 [info ] [MainThread]: [31mCompleted with 7 errors and 0 warnings:[0m
[0m13:37:30.169148 [info ] [MainThread]: 
[0m13:37:30.169148 [error] [MainThread]:   Runtime Error in test not_null_my_first_dbt_model_id (models\example\schema.yml)
  404 Not found: Dataset key-polymer-434418-m6:airnow was not found in location US; reason: notFound, message: Not found: Dataset key-polymer-434418-m6:airnow was not found in location US
  
  Location: US
  Job ID: c913340a-808f-467e-b6dd-ef842dfa9ee7
  
[0m13:37:30.169148 [info ] [MainThread]: 
[0m13:37:30.169148 [error] [MainThread]:   Runtime Error in test not_null_my_second_dbt_model_id (models\example\schema.yml)
  404 Not found: Dataset key-polymer-434418-m6:airnow was not found in location US; reason: notFound, message: Not found: Dataset key-polymer-434418-m6:airnow was not found in location US
  
  Location: US
  Job ID: 2f9a21c2-8125-414e-8ca4-0761797c149e
  
[0m13:37:30.175250 [info ] [MainThread]: 
[0m13:37:30.175250 [error] [MainThread]:   Compilation Error in test test_missing_dates_airnow_hist_stage_ (models\airnow_staging\schema.yml)
  'test_test_missing_dates' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:37:30.175250 [info ] [MainThread]: 
[0m13:37:30.178985 [error] [MainThread]:   Runtime Error in test unique_my_first_dbt_model_id (models\example\schema.yml)
  404 Not found: Dataset key-polymer-434418-m6:airnow was not found in location US; reason: notFound, message: Not found: Dataset key-polymer-434418-m6:airnow was not found in location US
  
  Location: US
  Job ID: 2dac9dbd-fcbe-46b8-b7f7-53415c48e8ef
  
[0m13:37:30.180641 [info ] [MainThread]: 
[0m13:37:30.181183 [error] [MainThread]:   Runtime Error in test unique_my_second_dbt_model_id (models\example\schema.yml)
  404 Not found: Dataset key-polymer-434418-m6:airnow was not found in location US; reason: notFound, message: Not found: Dataset key-polymer-434418-m6:airnow was not found in location US
  
  Location: US
  Job ID: 15e3e735-533c-4cb6-b80b-8918cf5f30b6
  
[0m13:37:30.181183 [info ] [MainThread]: 
[0m13:37:30.181183 [error] [MainThread]:   Database Error in test not_null_airnow_hist_stage_ (models\airnow_staging\schema.yml)
  Syntax error: SELECT list must not be empty at [14:1]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\schema.yml\not_null_airnow_hist_stage_.sql
[0m13:37:30.183928 [info ] [MainThread]: 
[0m13:37:30.183928 [error] [MainThread]:   Database Error in test not_null_airnow_realtime_stage_ (models\airnow_staging\schema.yml)
  Syntax error: SELECT list must not be empty at [14:1]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\schema.yml\not_null_airnow_realtime_stage_.sql
[0m13:37:30.185640 [info ] [MainThread]: 
[0m13:37:30.187383 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=7 SKIP=0 TOTAL=7
[0m13:37:30.187383 [debug] [MainThread]: Command `dbt test` failed at 13:37:30.187383 after 3.96 seconds
[0m13:37:30.187383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580B9BC0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002580B7B7CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002583663BCE0>]}
[0m13:37:30.187383 [debug] [MainThread]: Flushing usage events
[0m13:38:29.366178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D079018B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D079818A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D079546CC0>]}


============================== 13:38:29.381842 | 07c9d51b-4cbd-4abe-a37d-9984547225a6 ==============================
[0m13:38:29.381842 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:38:29.381842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:38:30.320561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07c9d51b-4cbd-4abe-a37d-9984547225a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0241CB020>]}
[0m13:38:30.356705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07c9d51b-4cbd-4abe-a37d-9984547225a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D07A0AAE70>]}
[0m13:38:30.370215 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:38:30.370215 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m13:38:30.452222 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:38:30.454259 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m13:38:30.454432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07c9d51b-4cbd-4abe-a37d-9984547225a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0790193A0>]}
[0m13:38:31.310233 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:38:31.311268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '07c9d51b-4cbd-4abe-a37d-9984547225a6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D02452E870>]}
[0m13:38:31.569302 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m13:38:31.583821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07c9d51b-4cbd-4abe-a37d-9984547225a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0242FFF50>]}
[0m13:38:31.718137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07c9d51b-4cbd-4abe-a37d-9984547225a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D02461AC00>]}
[0m13:38:31.718137 [info ] [MainThread]: Found 6 models, 7 data tests, 2 sources, 474 macros
[0m13:38:31.718137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07c9d51b-4cbd-4abe-a37d-9984547225a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D024293350>]}
[0m13:38:31.718137 [info ] [MainThread]: 
[0m13:38:31.718137 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:38:31.718137 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m13:38:31.718137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:32.333750 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m13:38:32.334858 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_airnow_staging'
[0m13:38:32.335949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:32.337015 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m13:38:32.338142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:32.362666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:32.903849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07c9d51b-4cbd-4abe-a37d-9984547225a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0246CFCE0>]}
[0m13:38:32.903849 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:32.903849 [info ] [MainThread]: 
[0m13:38:32.903849 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m13:38:32.903849 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_hist_stage .................. [RUN]
[0m13:38:32.916937 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m13:38:32.917922 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m13:38:32.925463 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m13:38:32.925624 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m13:38:32.937965 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:38:33.469643 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m13:38:33.469643 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Historical Observations Staging Model ***/
/**
The below model converts all columns, except for 'DateObserved,' to the correct data type. 'DateObserved' is already
a TIMESTAMP data type.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT 
    * 
FROM airnow_hist_final
    );
  
[0m13:38:33.955074 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:45b33c1a-c467-49ac-a205-68547e549775&page=queryresults
[0m13:38:37.247893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07c9d51b-4cbd-4abe-a37d-9984547225a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D024797470>]}
[0m13:38:37.247893 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_hist_stage ............. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 4.33s]
[0m13:38:37.247893 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m13:38:37.263442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:37.264697 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m13:38:37.264697 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m13:38:37.266160 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_airnow_staging' was properly closed.
[0m13:38:37.266160 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m13:38:37.266160 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m13:38:37.266160 [info ] [MainThread]: 
[0m13:38:37.268344 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m13:38:37.268344 [debug] [MainThread]: Command end result
[0m13:38:37.287106 [info ] [MainThread]: 
[0m13:38:37.294517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:37.294517 [info ] [MainThread]: 
[0m13:38:37.294517 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:38:37.299051 [debug] [MainThread]: Command `cli run` succeeded at 13:38:37.294517 after 8.06 seconds
[0m13:38:37.299051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D079632720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0244E2900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0790B8B00>]}
[0m13:38:37.299051 [debug] [MainThread]: Flushing usage events
[0m13:38:47.033087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EDA0090A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EDAEC7E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EDD884080>]}


============================== 13:38:47.033087 | a19fadc9-f355-4db5-9144-60f085379062 ==============================
[0m13:38:47.033087 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:38:47.043677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:38:47.926351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a19fadc9-f355-4db5-9144-60f085379062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EDAEC7E60>]}
[0m13:38:47.965740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a19fadc9-f355-4db5-9144-60f085379062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EDB41E630>]}
[0m13:38:47.965740 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:38:47.974328 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m13:38:48.098975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:38:48.098975 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:38:48.098975 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m13:38:48.132623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a19fadc9-f355-4db5-9144-60f085379062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EDB494D10>]}
[0m13:38:48.215694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a19fadc9-f355-4db5-9144-60f085379062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E887B77A0>]}
[0m13:38:48.215694 [info ] [MainThread]: Found 6 models, 7 data tests, 2 sources, 474 macros
[0m13:38:48.215694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a19fadc9-f355-4db5-9144-60f085379062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E87C7ECF0>]}
[0m13:38:48.215694 [info ] [MainThread]: 
[0m13:38:48.215694 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:38:48.215694 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m13:38:48.228292 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_airnow_staging'
[0m13:38:48.229016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:48.229016 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m13:38:48.229016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:48.250268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:48.732238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a19fadc9-f355-4db5-9144-60f085379062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EDCA191F0>]}
[0m13:38:48.732238 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:48.737871 [info ] [MainThread]: 
[0m13:38:48.738964 [debug] [Thread-1 (]: Began running node test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462
[0m13:38:48.738964 [debug] [Thread-2 (]: Began running node test.airnow_dbt.test_missing_dates_airnow_hist_stage_.8dc63f15eb
[0m13:38:48.738964 [info ] [Thread-1 (]: 1 of 2 START test not_null_airnow_hist_stage_ .................................. [RUN]
[0m13:38:48.748788 [info ] [Thread-2 (]: 2 of 2 START test test_missing_dates_airnow_hist_stage_ ........................ [RUN]
[0m13:38:48.750980 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462'
[0m13:38:48.750980 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.airnow_dbt.test_missing_dates_airnow_hist_stage_.8dc63f15eb'
[0m13:38:48.750980 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462
[0m13:38:48.750980 [debug] [Thread-2 (]: Began compiling node test.airnow_dbt.test_missing_dates_airnow_hist_stage_.8dc63f15eb
[0m13:38:48.765610 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462"
[0m13:38:48.769226 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462
[0m13:38:48.783794 [debug] [Thread-1 (]: Writing runtime sql for node "test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462"
[0m13:38:48.783794 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:38:48.783794 [debug] [Thread-1 (]: On test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select 
from `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
where  is null



      
    ) dbt_internal_test
[0m13:38:48.813752 [debug] [Thread-2 (]: Compilation Error in test test_missing_dates_airnow_hist_stage_ (models\airnow_staging\schema.yml)
  'test_test_missing_dates' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:38:48.813752 [error] [Thread-2 (]: 2 of 2 ERROR test_missing_dates_airnow_hist_stage_ ............................. [[31mERROR[0m in 0.06s]
[0m13:38:48.815643 [debug] [Thread-2 (]: Finished running node test.airnow_dbt.test_missing_dates_airnow_hist_stage_.8dc63f15eb
[0m13:38:49.215607 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:836ac26d-81b7-4e9a-a524-00454c332027&page=queryresults
[0m13:38:49.215607 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: SELECT list must not be empty at [14:1]; reason: invalidQuery, location: query, message: Syntax error: SELECT list must not be empty at [14:1]')
[0m13:38:50.247989 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:0ae5091f-3ddd-4868-bd63-f3b96b9e0619&page=queryresults
[0m13:38:50.248829 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:0ae5091f-3ddd-4868-bd63-f3b96b9e0619&page=queryresults
[0m13:38:50.248829 [debug] [Thread-1 (]: Database Error in test not_null_airnow_hist_stage_ (models\airnow_staging\schema.yml)
  Syntax error: SELECT list must not be empty at [14:1]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\schema.yml\not_null_airnow_hist_stage_.sql
[0m13:38:50.248829 [error] [Thread-1 (]: 1 of 2 ERROR not_null_airnow_hist_stage_ ....................................... [[31mERROR[0m in 1.50s]
[0m13:38:50.248829 [debug] [Thread-1 (]: Finished running node test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462
[0m13:38:50.260337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:50.260337 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m13:38:50.260337 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_airnow_staging' was properly closed.
[0m13:38:50.260337 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m13:38:50.260337 [debug] [MainThread]: Connection 'test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462' was properly closed.
[0m13:38:50.262704 [debug] [MainThread]: Connection 'test.airnow_dbt.test_missing_dates_airnow_hist_stage_.8dc63f15eb' was properly closed.
[0m13:38:50.262704 [info ] [MainThread]: 
[0m13:38:50.262704 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m13:38:50.264032 [debug] [MainThread]: Command end result
[0m13:38:50.282933 [info ] [MainThread]: 
[0m13:38:50.282933 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:38:50.282933 [info ] [MainThread]: 
[0m13:38:50.282933 [error] [MainThread]:   Compilation Error in test test_missing_dates_airnow_hist_stage_ (models\airnow_staging\schema.yml)
  'test_test_missing_dates' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:38:50.282933 [info ] [MainThread]: 
[0m13:38:50.282933 [error] [MainThread]:   Database Error in test not_null_airnow_hist_stage_ (models\airnow_staging\schema.yml)
  Syntax error: SELECT list must not be empty at [14:1]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\schema.yml\not_null_airnow_hist_stage_.sql
[0m13:38:50.291940 [info ] [MainThread]: 
[0m13:38:50.291940 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m13:38:50.291940 [debug] [MainThread]: Command `cli test` failed at 13:38:50.291940 after 3.40 seconds
[0m13:38:50.291940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EDA0090A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019EDD9E6F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E882A7260>]}
[0m13:38:50.291940 [debug] [MainThread]: Flushing usage events
[0m13:39:46.301374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C031D394F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C0314BE2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C02FA1D130>]}


============================== 13:39:46.318213 | 138159a3-4ad1-4c34-911d-7ff510968840 ==============================
[0m13:39:46.318213 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:39:46.318213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:39:47.200930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '138159a3-4ad1-4c34-911d-7ff510968840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C031E85610>]}
[0m13:39:47.243432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '138159a3-4ad1-4c34-911d-7ff510968840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05A6741A0>]}
[0m13:39:47.243432 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:39:47.250664 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m13:39:47.320228 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:39:47.320228 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m13:39:47.320228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '138159a3-4ad1-4c34-911d-7ff510968840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05CAF9520>]}
[0m13:39:48.144475 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:39:48.144475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '138159a3-4ad1-4c34-911d-7ff510968840', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05C98CE90>]}
[0m13:39:48.300375 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m13:39:48.310893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '138159a3-4ad1-4c34-911d-7ff510968840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05CD706E0>]}
[0m13:39:48.400314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '138159a3-4ad1-4c34-911d-7ff510968840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05CDD5910>]}
[0m13:39:48.400314 [info ] [MainThread]: Found 6 models, 7 data tests, 2 sources, 474 macros
[0m13:39:48.400314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '138159a3-4ad1-4c34-911d-7ff510968840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05C9F2D20>]}
[0m13:39:48.400314 [info ] [MainThread]: 
[0m13:39:48.400314 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:39:48.400314 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_airnow_staging'
[0m13:39:48.400314 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m13:39:48.400314 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m13:39:48.400314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:48.400314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:48.400314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:48.984138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '138159a3-4ad1-4c34-911d-7ff510968840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C05C7A9D00>]}
[0m13:39:48.984138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:39:48.984138 [info ] [MainThread]: 
[0m13:39:48.996721 [debug] [Thread-2 (]: Began running node test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462
[0m13:39:48.984138 [debug] [Thread-1 (]: Began running node test.airnow_dbt.missing_dates_airnow_hist_stage_.0810af33b7
[0m13:39:48.997786 [info ] [Thread-2 (]: 2 of 2 START test not_null_airnow_hist_stage_ .................................. [RUN]
[0m13:39:48.999291 [info ] [Thread-1 (]: 1 of 2 START test missing_dates_airnow_hist_stage_ ............................. [RUN]
[0m13:39:48.999291 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462'
[0m13:39:48.999291 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_dates_airnow_hist_stage_.0810af33b7'
[0m13:39:48.999291 [debug] [Thread-2 (]: Began compiling node test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462
[0m13:39:48.999291 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.missing_dates_airnow_hist_stage_.0810af33b7
[0m13:39:49.012648 [debug] [Thread-2 (]: Writing injected SQL for node "test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462"
[0m13:39:49.013570 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.missing_dates_airnow_hist_stage_.0810af33b7"
[0m13:39:49.013570 [debug] [Thread-2 (]: Began executing node test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462
[0m13:39:49.031026 [debug] [Thread-2 (]: Writing runtime sql for node "test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462"
[0m13:39:49.031128 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:39:49.033109 [debug] [Thread-2 (]: On test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select 
from `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
where  is null



      
    ) dbt_internal_test
[0m13:39:49.066852 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.missing_dates_airnow_hist_stage_.0810af33b7
[0m13:39:49.066852 [debug] [Thread-1 (]: Writing runtime sql for node "test.airnow_dbt.missing_dates_airnow_hist_stage_.0810af33b7"
[0m13:39:49.066852 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:39:49.066852 [debug] [Thread-1 (]: On test.airnow_dbt.missing_dates_airnow_hist_stage_.0810af33b7: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_dates_airnow_hist_stage_.0810af33b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH date_spine AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_airnow_staging`.`date_spine`
),

hist_observation_dates AS (
    SELECT
        DISTINCT DATE(DateObserved) AS date_day
    FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
)

SELECT
    date_spine.date_day
FROM
    date_spine
LEFT JOIN
    hist_observation_dates ON date_spine.date_day = hist_observation_dates.date_day
WHERE
    hist_observation_dates.date_day IS NULL


      
    ) dbt_internal_test
[0m13:39:49.539522 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:0f7a8f89-0863-436f-85eb-9fdc65fe35e4&page=queryresults
[0m13:39:49.540643 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: SELECT list must not be empty at [14:1]; reason: invalidQuery, location: query, message: Syntax error: SELECT list must not be empty at [14:1]')
[0m13:39:50.150340 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:4b0a4e3b-bdf1-4bb0-b95a-5e0c909e2075&page=queryresults
[0m13:39:50.150340 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:4b0a4e3b-bdf1-4bb0-b95a-5e0c909e2075&page=queryresults
[0m13:39:50.166922 [debug] [Thread-2 (]: Database Error in test not_null_airnow_hist_stage_ (models\airnow_staging\schema.yml)
  Syntax error: SELECT list must not be empty at [14:1]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\schema.yml\not_null_airnow_hist_stage_.sql
[0m13:39:50.166922 [error] [Thread-2 (]: 2 of 2 ERROR not_null_airnow_hist_stage_ ....................................... [[31mERROR[0m in 1.17s]
[0m13:39:50.166922 [debug] [Thread-2 (]: Finished running node test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462
[0m13:39:50.859543 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:cb69a2d3-71fe-4e65-8842-9a0dd00598ed&page=queryresults
[0m13:40:52.273956 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('GET https://bigquery.googleapis.com/bigquery/v2/projects/key-polymer-434418-m6/queries/cb69a2d3-71fe-4e65-8842-9a0dd00598ed?maxResults=0&location=US&prettyPrint=false: A recursive CTE has reached the maximum number of iterations: 500.')
[0m13:40:54.225336 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:73c2d680-1c89-4591-b725-d952d8dbba62&page=queryresults
[0m13:41:38.487174 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:73c2d680-1c89-4591-b725-d952d8dbba62&page=queryresults
[0m13:41:38.670055 [debug] [Thread-1 (]: Database Error in test missing_dates_airnow_hist_stage_ (models\airnow_staging\schema.yml)
  A recursive CTE has reached the maximum number of iterations: 500.
  compiled Code at target\run\airnow_dbt\models\airnow_staging\schema.yml\missing_dates_airnow_hist_stage_.sql
[0m13:41:38.670055 [error] [Thread-1 (]: 1 of 2 ERROR missing_dates_airnow_hist_stage_ .................................. [[31mERROR[0m in 109.67s]
[0m13:41:38.674064 [debug] [Thread-1 (]: Finished running node test.airnow_dbt.missing_dates_airnow_hist_stage_.0810af33b7
[0m13:41:38.674064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:38.674064 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_airnow_staging' was properly closed.
[0m13:41:38.674064 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m13:41:38.674064 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m13:41:38.674064 [debug] [MainThread]: Connection 'test.airnow_dbt.not_null_airnow_hist_stage_.b9d2302462' was properly closed.
[0m13:41:38.682128 [debug] [MainThread]: Connection 'test.airnow_dbt.missing_dates_airnow_hist_stage_.0810af33b7' was properly closed.
[0m13:41:38.682128 [info ] [MainThread]: 
[0m13:41:38.682128 [info ] [MainThread]: Finished running 2 data tests in 0 hours 1 minutes and 50.28 seconds (110.28s).
[0m13:41:38.682128 [debug] [MainThread]: Command end result
[0m13:41:38.736715 [info ] [MainThread]: 
[0m13:41:38.736715 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:41:38.736715 [info ] [MainThread]: 
[0m13:41:38.736715 [error] [MainThread]:   Database Error in test not_null_airnow_hist_stage_ (models\airnow_staging\schema.yml)
  Syntax error: SELECT list must not be empty at [14:1]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\schema.yml\not_null_airnow_hist_stage_.sql
[0m13:41:38.746299 [info ] [MainThread]: 
[0m13:41:38.746299 [error] [MainThread]:   Database Error in test missing_dates_airnow_hist_stage_ (models\airnow_staging\schema.yml)
  A recursive CTE has reached the maximum number of iterations: 500.
  compiled Code at target\run\airnow_dbt\models\airnow_staging\schema.yml\missing_dates_airnow_hist_stage_.sql
[0m13:41:38.749440 [info ] [MainThread]: 
[0m13:41:38.750656 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m13:41:38.752291 [debug] [MainThread]: Command `cli test` failed at 13:41:38.752291 after 112.58 seconds
[0m13:41:38.752291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C031FE2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C031E855E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C031E85550>]}
[0m13:41:38.754803 [debug] [MainThread]: Flushing usage events
[0m13:46:03.645510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CE8B27DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CEAD58AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CEAD59790>]}


============================== 13:46:03.645510 | 18efdc3b-b555-40d0-8301-48aa4177bbf3 ==============================
[0m13:46:03.645510 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:46:03.645510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:46:04.528123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18efdc3b-b555-40d0-8301-48aa4177bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CFF7FA600>]}
[0m13:46:04.588533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18efdc3b-b555-40d0-8301-48aa4177bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CFF3862A0>]}
[0m13:46:04.628662 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:46:04.645228 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m13:46:04.712045 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:46:04.712045 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m13:46:04.712045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '18efdc3b-b555-40d0-8301-48aa4177bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CEB68DF10>]}
[0m13:46:05.511095 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:46:05.511095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '18efdc3b-b555-40d0-8301-48aa4177bbf3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C96229370>]}
[0m13:46:05.678687 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m13:46:05.678687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18efdc3b-b555-40d0-8301-48aa4177bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C962EA270>]}
[0m13:46:05.760563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18efdc3b-b555-40d0-8301-48aa4177bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CEA531E20>]}
[0m13:46:05.762372 [info ] [MainThread]: Found 6 models, 6 data tests, 2 sources, 474 macros
[0m13:46:05.762372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18efdc3b-b555-40d0-8301-48aa4177bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C964CF440>]}
[0m13:46:05.762372 [info ] [MainThread]: 
[0m13:46:05.762372 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:46:05.762372 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m13:46:05.762372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:06.257915 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_airnow_staging'
[0m13:46:06.257915 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m13:46:06.262680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:06.262680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:06.262680 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m13:46:06.310722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:06.795418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18efdc3b-b555-40d0-8301-48aa4177bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C962D7230>]}
[0m13:46:06.795418 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:46:06.795418 [info ] [MainThread]: 
[0m13:46:06.807967 [debug] [Thread-1 (]: Began running node model.airnow_dbt.date_spine
[0m13:46:06.807967 [info ] [Thread-1 (]: 1 of 1 START sql view model airnow_airnow_staging.date_spine ................... [RUN]
[0m13:46:06.808981 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.date_spine'
[0m13:46:06.809955 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.date_spine
[0m13:46:06.814387 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.date_spine"
[0m13:46:06.814387 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.date_spine
[0m13:46:06.839721 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.date_spine"
[0m13:46:06.839721 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:46:06.839721 [debug] [Thread-1 (]: On model.airnow_dbt.date_spine: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.date_spine"} */


  create or replace view `key-polymer-434418-m6`.`airnow_airnow_staging`.`date_spine`
  OPTIONS()
  as /*** Date Spine Table ***/
/** This table will be used to create a list of dates between 2019-01-01 and
2024-09-01.'
**/

WITH RECURSIVE date_spine AS (
    SELECT
        DATE('2019-01-01') AS date_day
    UNION ALL
    SELECT
        DATE_ADD(date_day, INTERVAL 1 DAY)
    FROM
        date_spine
    WHERE
        date_day < '2024-09-01' --adjust if more date is loaded into raw historical table
)

SELECT
    date_day
FROM
    date_spine;


[0m13:46:07.477346 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:8bd64f7a-abaa-448b-a246-19ec06271952&page=queryresults
[0m13:46:07.943197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18efdc3b-b555-40d0-8301-48aa4177bbf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C945EC440>]}
[0m13:46:07.943197 [info ] [Thread-1 (]: 1 of 1 OK created sql view model airnow_airnow_staging.date_spine .............. [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m13:46:07.943197 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.date_spine
[0m13:46:07.943197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:07.943197 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m13:46:07.943197 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_airnow_staging' was properly closed.
[0m13:46:07.943197 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m13:46:07.943197 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m13:46:07.943197 [debug] [MainThread]: Connection 'model.airnow_dbt.date_spine' was properly closed.
[0m13:46:07.943197 [info ] [MainThread]: 
[0m13:46:07.943197 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m13:46:07.943197 [debug] [MainThread]: Command end result
[0m13:46:07.966226 [info ] [MainThread]: 
[0m13:46:07.966226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:46:07.966226 [info ] [MainThread]: 
[0m13:46:07.966226 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:46:07.966226 [debug] [MainThread]: Command `cli run` succeeded at 13:46:07.966226 after 4.46 seconds
[0m13:46:07.966226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CEB33E060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CEB526030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013CEB524BC0>]}
[0m13:46:07.966226 [debug] [MainThread]: Flushing usage events
[0m13:47:12.147087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EF593B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283F154AFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283F1E9A2D0>]}


============================== 13:47:12.148672 | 335e35f9-3a2d-4191-aebb-257c2716e276 ==============================
[0m13:47:12.148672 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:47:12.148672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:47:13.069834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '335e35f9-3a2d-4191-aebb-257c2716e276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002839C9C87D0>]}
[0m13:47:13.103002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '335e35f9-3a2d-4191-aebb-257c2716e276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002839C3784D0>]}
[0m13:47:13.103002 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:47:13.119872 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m13:47:13.194917 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:47:13.196177 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m13:47:13.237155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '335e35f9-3a2d-4191-aebb-257c2716e276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283F17FD280>]}
[0m13:47:14.052602 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:47:14.052602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '335e35f9-3a2d-4191-aebb-257c2716e276', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002839CB2CA10>]}
[0m13:47:14.210183 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m13:47:14.213785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '335e35f9-3a2d-4191-aebb-257c2716e276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002839CCE1CA0>]}
[0m13:47:14.294893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '335e35f9-3a2d-4191-aebb-257c2716e276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002839CECBD70>]}
[0m13:47:14.294893 [info ] [MainThread]: Found 6 models, 6 data tests, 2 sources, 474 macros
[0m13:47:14.294893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335e35f9-3a2d-4191-aebb-257c2716e276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002839CD11430>]}
[0m13:47:14.294893 [info ] [MainThread]: 
[0m13:47:14.294893 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:47:14.294893 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m13:47:14.294893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:14.786360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_key-polymer-434418-m6, now create_key-polymer-434418-m6_airnow_test)
[0m13:47:14.786360 [debug] [ThreadPool]: Creating schema "database: "key-polymer-434418-m6"
schema: "airnow_test"
"
[0m13:47:14.802413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:47:14.802413 [debug] [ThreadPool]: On create_key-polymer-434418-m6_airnow_test: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "connection_name": "create_key-polymer-434418-m6_airnow_test"} */
create schema if not exists `key-polymer-434418-m6`.`airnow_test`
  
[0m13:47:15.318304 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:f4814bc3-2f22-4473-8c3d-2c60573f867c&page=queryresults
[0m13:47:16.168824 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m13:47:16.168824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:16.168824 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m13:47:16.168824 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m13:47:16.202480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:16.197945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:16.719192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '335e35f9-3a2d-4191-aebb-257c2716e276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002839AB46240>]}
[0m13:47:16.719192 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:16.719192 [info ] [MainThread]: 
[0m13:47:16.735148 [debug] [Thread-1 (]: Began running node model.airnow_dbt.date_spine
[0m13:47:16.735148 [info ] [Thread-1 (]: 1 of 1 START sql view model airnow_test.date_spine ............................. [RUN]
[0m13:47:16.735148 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.date_spine'
[0m13:47:16.735148 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.date_spine
[0m13:47:16.742761 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.date_spine"
[0m13:47:16.742761 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.date_spine
[0m13:47:16.769492 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.date_spine"
[0m13:47:16.770158 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:47:16.771871 [debug] [Thread-1 (]: On model.airnow_dbt.date_spine: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.date_spine"} */


  create or replace view `key-polymer-434418-m6`.`airnow_test`.`date_spine`
  OPTIONS()
  as /*** Date Spine Table ***/
/** This table will be used to create a list of dates between 2019-01-01 and
2024-09-01.'
**/



SELECT
    date_day
FROM
    UNNEST(GENERATE_DATE_ARRAY('2019-01-01', '2024-09-01', INTERVAL 1 DAY)) AS date_day;;


[0m13:47:17.250940 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:63ca6820-992d-42fb-851b-f5714dfa4965&page=queryresults
[0m13:47:17.251971 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ";" at [16:89]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ";" at [16:89]')
[0m13:47:18.360025 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:a8d62a48-9006-4b1b-bba1-d30d833ce5b0&page=queryresults
[0m13:47:18.361368 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:a8d62a48-9006-4b1b-bba1-d30d833ce5b0&page=queryresults
[0m13:47:18.367863 [debug] [Thread-1 (]: Database Error in model date_spine (models\airnow_staging\date_spine.sql)
  Syntax error: Unexpected ";" at [16:89]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\date_spine.sql
[0m13:47:18.367863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '335e35f9-3a2d-4191-aebb-257c2716e276', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002839CCF7E00>]}
[0m13:47:18.367863 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model airnow_test.date_spine .................... [[31mERROR[0m in 1.63s]
[0m13:47:18.367863 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.date_spine
[0m13:47:18.374825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:18.374825 [debug] [MainThread]: Connection 'create_key-polymer-434418-m6_airnow_test' was properly closed.
[0m13:47:18.374825 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m13:47:18.374825 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m13:47:18.374825 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m13:47:18.374825 [debug] [MainThread]: Connection 'model.airnow_dbt.date_spine' was properly closed.
[0m13:47:18.374825 [info ] [MainThread]: 
[0m13:47:18.374825 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m13:47:18.379974 [debug] [MainThread]: Command end result
[0m13:47:18.400037 [info ] [MainThread]: 
[0m13:47:18.400037 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:47:18.401604 [info ] [MainThread]: 
[0m13:47:18.401773 [error] [MainThread]:   Database Error in model date_spine (models\airnow_staging\date_spine.sql)
  Syntax error: Unexpected ";" at [16:89]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\date_spine.sql
[0m13:47:18.402544 [info ] [MainThread]: 
[0m13:47:18.402800 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:47:18.403522 [debug] [MainThread]: Command `cli run` failed at 13:47:18.403522 after 6.39 seconds
[0m13:47:18.403522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283EF593B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283F1F608F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283F1C06F30>]}
[0m13:47:18.403522 [debug] [MainThread]: Flushing usage events
[0m13:47:46.642755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272D6711760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272D6713230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272D6711880>]}


============================== 13:47:46.646840 | 2d675bc2-8ee9-4251-9503-d9bf7f144c1d ==============================
[0m13:47:46.646840 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:47:46.646840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:47:47.504434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d675bc2-8ee9-4251-9503-d9bf7f144c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272D66794C0>]}
[0m13:47:47.554522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d675bc2-8ee9-4251-9503-d9bf7f144c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272D6457860>]}
[0m13:47:47.554522 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:47:47.554522 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m13:47:47.630921 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:47:47.630921 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m13:47:47.630921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d675bc2-8ee9-4251-9503-d9bf7f144c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272D68A8740>]}
[0m13:47:48.437452 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:47:48.437452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2d675bc2-8ee9-4251-9503-d9bf7f144c1d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272D5752480>]}
[0m13:47:48.604354 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m13:47:48.604354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d675bc2-8ee9-4251-9503-d9bf7f144c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272815474D0>]}
[0m13:47:48.688344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d675bc2-8ee9-4251-9503-d9bf7f144c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002728164DDF0>]}
[0m13:47:48.688344 [info ] [MainThread]: Found 6 models, 6 data tests, 2 sources, 474 macros
[0m13:47:48.688344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d675bc2-8ee9-4251-9503-d9bf7f144c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272D68A9E80>]}
[0m13:47:48.688344 [info ] [MainThread]: 
[0m13:47:48.688344 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:47:48.688344 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m13:47:48.688344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:49.205991 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m13:47:49.205991 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m13:47:49.205991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:49.205991 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m13:47:49.205991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:49.217611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:47:49.771261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d675bc2-8ee9-4251-9503-d9bf7f144c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002728164C800>]}
[0m13:47:49.771261 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:47:49.771261 [info ] [MainThread]: 
[0m13:47:49.771261 [debug] [Thread-1 (]: Began running node model.airnow_dbt.date_spine
[0m13:47:49.771261 [info ] [Thread-1 (]: 1 of 1 START sql view model airnow_test.date_spine ............................. [RUN]
[0m13:47:49.784310 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.date_spine'
[0m13:47:49.785396 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.date_spine
[0m13:47:49.791060 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.date_spine"
[0m13:47:49.791060 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.date_spine
[0m13:47:49.805038 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.date_spine"
[0m13:47:49.816125 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:47:49.816125 [debug] [Thread-1 (]: On model.airnow_dbt.date_spine: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.date_spine"} */


  create or replace view `key-polymer-434418-m6`.`airnow_test`.`date_spine`
  OPTIONS()
  as /*** Date Spine Table ***/
/** This table will be used to create a list of dates between 2019-01-01 and
2024-09-01.'
**/



SELECT
    date_day
FROM
    UNNEST(GENERATE_DATE_ARRAY('2019-01-01', '2024-09-01', INTERVAL 1 DAY)) AS date_day;


[0m13:47:50.432090 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:0bc694ef-2e86-43f8-a7bd-3685e544ed13&page=queryresults
[0m13:47:50.929498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d675bc2-8ee9-4251-9503-d9bf7f144c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272FF742660>]}
[0m13:47:50.936748 [info ] [Thread-1 (]: 1 of 1 OK created sql view model airnow_test.date_spine ........................ [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m13:47:50.936748 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.date_spine
[0m13:47:50.950755 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:50.950755 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m13:47:50.953252 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m13:47:50.953252 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m13:47:50.953252 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m13:47:50.953252 [debug] [MainThread]: Connection 'model.airnow_dbt.date_spine' was properly closed.
[0m13:47:50.953252 [info ] [MainThread]: 
[0m13:47:50.953252 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.26 seconds (2.26s).
[0m13:47:50.956832 [debug] [MainThread]: Command end result
[0m13:47:50.972374 [info ] [MainThread]: 
[0m13:47:50.978494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:50.978494 [info ] [MainThread]: 
[0m13:47:50.978494 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:47:50.980880 [debug] [MainThread]: Command `cli run` succeeded at 13:47:50.980880 after 4.47 seconds
[0m13:47:50.981090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272D67463F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272D6861310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272D6862FF0>]}
[0m13:47:50.981090 [debug] [MainThread]: Flushing usage events
[0m13:55:32.920827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002504ACDBBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002504CEA62A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002504CEA7980>]}


============================== 13:55:32.920827 | cce1f3de-e303-4990-821b-6a55e0336599 ==============================
[0m13:55:32.920827 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:55:32.920827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:55:33.829834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cce1f3de-e303-4990-821b-6a55e0336599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002504C82E480>]}
[0m13:55:33.862855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cce1f3de-e303-4990-821b-6a55e0336599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002507671D4F0>]}
[0m13:55:33.862855 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:55:33.878845 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m13:55:33.945839 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:55:33.945839 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m13:55:33.945839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cce1f3de-e303-4990-821b-6a55e0336599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002504D7F3260>]}
[0m13:55:34.764543 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:55:34.764543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cce1f3de-e303-4990-821b-6a55e0336599', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002504B33E180>]}
[0m13:55:34.977946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m13:55:34.981588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cce1f3de-e303-4990-821b-6a55e0336599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025078469340>]}
[0m13:55:35.078651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cce1f3de-e303-4990-821b-6a55e0336599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025078481070>]}
[0m13:55:35.078651 [info ] [MainThread]: Found 6 models, 6 data tests, 2 sources, 474 macros
[0m13:55:35.078651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cce1f3de-e303-4990-821b-6a55e0336599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025078244CE0>]}
[0m13:55:35.083668 [info ] [MainThread]: 
[0m13:55:35.083668 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:55:35.083668 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m13:55:35.083668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:35.083668 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m13:55:35.083668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:35.112666 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m13:55:35.130478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:35.764485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cce1f3de-e303-4990-821b-6a55e0336599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250781C2B10>]}
[0m13:55:35.765492 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:35.765613 [info ] [MainThread]: 
[0m13:55:35.769625 [debug] [Thread-1 (]: Began running node test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99
[0m13:55:35.769625 [info ] [Thread-1 (]: 1 of 1 START test missing_dates_airnow_hist_stage_DateObserved ................. [RUN]
[0m13:55:35.769625 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99'
[0m13:55:35.769625 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99
[0m13:55:35.777907 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99"
[0m13:55:35.777907 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99
[0m13:55:35.794342 [debug] [Thread-1 (]: Writing runtime sql for node "test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99"
[0m13:55:35.802343 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:55:35.802343 [debug] [Thread-1 (]: On test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH date_spine AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_test`.`date_spine`
),

missing_dates AS (
    SELECT
        ds.date_day
    FROM
        date_spine ds
    LEFT JOIN (
        SELECT
            DISTINCT DATE(DateObserved) AS date_day
        FROM
            `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
    ) AS model_dates
    ON ds.date_day = model_dates.date_day
    WHERE model_dates.date_day IS NULL
)

SELECT *
FROM missing_dates


      
    ) dbt_internal_test
[0m13:55:36.877400 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:1c701db1-ac51-4f7b-846f-418239dcef11&page=queryresults
[0m13:55:37.804977 [error] [Thread-1 (]: 1 of 1 FAIL 1 missing_dates_airnow_hist_stage_DateObserved ..................... [[31mFAIL 1[0m in 2.04s]
[0m13:55:37.810288 [debug] [Thread-1 (]: Finished running node test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99
[0m13:55:37.811233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:37.811233 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m13:55:37.811233 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m13:55:37.811233 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m13:55:37.811233 [debug] [MainThread]: Connection 'test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99' was properly closed.
[0m13:55:37.811233 [info ] [MainThread]: 
[0m13:55:37.811233 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.73 seconds (2.73s).
[0m13:55:37.817653 [debug] [MainThread]: Command end result
[0m13:55:37.841360 [info ] [MainThread]: 
[0m13:55:37.841876 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:55:37.842273 [info ] [MainThread]: 
[0m13:55:37.843106 [error] [MainThread]: [31mFailure in test missing_dates_airnow_hist_stage_DateObserved (models\airnow_staging\schema.yml)[0m
[0m13:55:37.843527 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:55:37.844339 [info ] [MainThread]: 
[0m13:55:37.844339 [info ] [MainThread]:   compiled code at target\compiled\airnow_dbt\models\airnow_staging\schema.yml\missing_dates_airnow_hist_stage_DateObserved.sql
[0m13:55:37.845457 [info ] [MainThread]: 
[0m13:55:37.846104 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:55:37.846518 [debug] [MainThread]: Command `cli test` failed at 13:55:37.846518 after 5.06 seconds
[0m13:55:37.846518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002504D436CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002504C6E14F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002504CF44740>]}
[0m13:55:37.847582 [debug] [MainThread]: Flushing usage events
[0m13:58:24.229633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EF101730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EEB3E3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EF2753D0>]}


============================== 13:58:24.242139 | 5806076b-46e9-4062-856b-32df4c95b577 ==============================
[0m13:58:24.242139 [info ] [MainThread]: Running with dbt=1.8.6
[0m13:58:24.242139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:58:25.154528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5806076b-46e9-4062-856b-32df4c95b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017099C708C0>]}
[0m13:58:25.194652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5806076b-46e9-4062-856b-32df4c95b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017097244590>]}
[0m13:58:25.194652 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m13:58:25.194652 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m13:58:25.261814 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m13:58:25.261814 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m13:58:25.261814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5806076b-46e9-4062-856b-32df4c95b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EC43CA10>]}
[0m13:58:26.077667 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:58:26.077667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5806076b-46e9-4062-856b-32df4c95b577', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170E9560B60>]}
[0m13:58:26.243910 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m13:58:26.243910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5806076b-46e9-4062-856b-32df4c95b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001709A150410>]}
[0m13:58:26.627340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5806076b-46e9-4062-856b-32df4c95b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001709A11C050>]}
[0m13:58:26.627340 [info ] [MainThread]: Found 6 models, 6 data tests, 2 sources, 474 macros
[0m13:58:26.627340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5806076b-46e9-4062-856b-32df4c95b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017099FAB110>]}
[0m13:58:26.627340 [info ] [MainThread]: 
[0m13:58:26.627340 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:58:26.627340 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m13:58:26.637346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:27.280454 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m13:58:27.280454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:27.280454 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m13:58:27.280454 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m13:58:27.310586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:27.310586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:27.928622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5806076b-46e9-4062-856b-32df4c95b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170995C32C0>]}
[0m13:58:27.928622 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:58:27.928622 [info ] [MainThread]: 
[0m13:58:27.944859 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m13:58:27.944859 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_hist_stage .................. [RUN]
[0m13:58:27.944859 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m13:58:27.944859 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m13:58:27.948542 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m13:58:27.956601 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m13:58:27.963904 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:58:28.526404 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m13:58:28.526404 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Historical Observations Staging Model ***/
/**
The below model converts all columns, except for 'DateObserved,' to the correct data type. 'DateObserved' is already
a TIMESTAMP data type.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT 
    * 
FROM airnow_hist_final
    );
  
[0m13:58:28.985497 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:d8aa84df-9bd6-4835-a8de-a4bcc3d3c48b&page=queryresults
[0m13:58:33.224097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5806076b-46e9-4062-856b-32df4c95b577', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170982BC8C0>]}
[0m13:58:33.224544 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_hist_stage ............. [[32mCREATE TABLE (5.8k rows, 563.7 KiB processed)[0m in 5.28s]
[0m13:58:33.224544 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m13:58:33.224544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:33.224544 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m13:58:33.224544 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m13:58:33.224544 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m13:58:33.224544 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m13:58:33.224544 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m13:58:33.224544 [info ] [MainThread]: 
[0m13:58:33.224544 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.60 seconds (6.60s).
[0m13:58:33.224544 [debug] [MainThread]: Command end result
[0m13:58:33.244484 [info ] [MainThread]: 
[0m13:58:33.244484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:58:33.244484 [info ] [MainThread]: 
[0m13:58:33.244484 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:58:33.254528 [debug] [MainThread]: Command `cli run` succeeded at 13:58:33.254528 after 9.15 seconds
[0m13:58:33.254528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EF101730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EEFA2BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EEFA3770>]}
[0m13:58:33.254528 [debug] [MainThread]: Flushing usage events
[0m14:32:44.755231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3B7D1E480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BA126B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3B6240530>]}


============================== 14:32:44.755635 | 8ad05147-21ac-4286-87fc-27ba35298b5f ==============================
[0m14:32:44.755635 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:32:44.755635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:32:45.905164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ad05147-21ac-4286-87fc-27ba35298b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E4EC8950>]}
[0m14:32:45.938891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ad05147-21ac-4286-87fc-27ba35298b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E4E221E0>]}
[0m14:32:45.938891 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:32:45.949972 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m14:32:46.022192 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:32:46.022192 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m14:32:46.022192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8ad05147-21ac-4286-87fc-27ba35298b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E29D7770>]}
[0m14:32:46.821989 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:32:46.821989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8ad05147-21ac-4286-87fc-27ba35298b5f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E34C2480>]}
[0m14:32:46.988166 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m14:32:46.988166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ad05147-21ac-4286-87fc-27ba35298b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E5368E30>]}
[0m14:32:47.084516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ad05147-21ac-4286-87fc-27ba35298b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E5353650>]}
[0m14:32:47.084516 [info ] [MainThread]: Found 6 models, 6 data tests, 2 sources, 475 macros
[0m14:32:47.084516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ad05147-21ac-4286-87fc-27ba35298b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E51D6F30>]}
[0m14:32:47.084516 [info ] [MainThread]: 
[0m14:32:47.088039 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:32:47.088039 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m14:32:47.088039 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m14:32:47.088039 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m14:32:47.088039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:47.088039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:47.088039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:47.655020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ad05147-21ac-4286-87fc-27ba35298b5f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3E5368410>]}
[0m14:32:47.655020 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:32:47.655020 [info ] [MainThread]: 
[0m14:32:47.655020 [debug] [Thread-1 (]: Began running node test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c
[0m14:32:47.655020 [info ] [Thread-1 (]: 1 of 1 START test missing_aqi_measurements_airnow_realtime_stage_ .............. [RUN]
[0m14:32:47.669117 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c'
[0m14:32:47.669908 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c
[0m14:32:47.732631 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c"
[0m14:32:47.732631 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c
[0m14:32:47.750381 [debug] [Thread-1 (]: Writing runtime sql for node "test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c"
[0m14:32:47.750381 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:32:47.754251 [debug] [Thread-1 (]: On test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH observations_count AS (
    SELECT
        DateObserved,
        HourObserved,
        COUNTIF(ParameterName = 'PM2.5') AS pm25_count,
        COUNTIF(ParameterName = 'PM10') AS pm10_count,
        COUNTIF(ParameterName IN ('O3', 'OZONE')) AS o3_count
    FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
    GROUP BY
        1, 2
)

SELECT
    DateObserved,
    HourObserved,
    CASE
        WHEN pm25_count = 0 THEN 'PM2.5 is missing'
        WHEN pm10_count = 0 THEN 'PM10 is missing'
        WHEN o3_count = 0 THEN 'O3 is missing'
        ELSE 'All observations present'
    END AS missing_observation
FROM observations_count
WHERE
    pm25_count = 0 OR
    pm10_count = 0 OR
    03_count = 0


      
    ) dbt_internal_test
[0m14:32:48.271183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:33cb35a0-1c37-4de4-ac26-822eb8da584c&page=queryresults
[0m14:32:48.271183 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Missing whitespace between literal and alias at [34:7]; reason: invalidQuery, location: query, message: Syntax error: Missing whitespace between literal and alias at [34:7]')
[0m14:32:49.288980 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:0b1a483f-280b-4fad-8d23-c2afe3861b72&page=queryresults
[0m14:32:49.288980 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:0b1a483f-280b-4fad-8d23-c2afe3861b72&page=queryresults
[0m14:32:49.298951 [debug] [Thread-1 (]: Database Error in test missing_aqi_measurements_airnow_realtime_stage_ (models\airnow_staging\schema.yml)
  Syntax error: Missing whitespace between literal and alias at [34:7]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\schema.yml\missing_aqi_measurements_airnow_realtime_stage_.sql
[0m14:32:49.298951 [error] [Thread-1 (]: 1 of 1 ERROR missing_aqi_measurements_airnow_realtime_stage_ ................... [[31mERROR[0m in 1.64s]
[0m14:32:49.298951 [debug] [Thread-1 (]: Finished running node test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c
[0m14:32:49.303147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:49.305501 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m14:32:49.305501 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m14:32:49.305501 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m14:32:49.305501 [debug] [MainThread]: Connection 'test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c' was properly closed.
[0m14:32:49.305501 [info ] [MainThread]: 
[0m14:32:49.305501 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m14:32:49.307589 [debug] [MainThread]: Command end result
[0m14:32:49.329760 [info ] [MainThread]: 
[0m14:32:49.329760 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:32:49.329760 [info ] [MainThread]: 
[0m14:32:49.329760 [error] [MainThread]:   Database Error in test missing_aqi_measurements_airnow_realtime_stage_ (models\airnow_staging\schema.yml)
  Syntax error: Missing whitespace between literal and alias at [34:7]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\schema.yml\missing_aqi_measurements_airnow_realtime_stage_.sql
[0m14:32:49.329760 [info ] [MainThread]: 
[0m14:32:49.329760 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:32:49.329760 [debug] [MainThread]: Command `cli test` failed at 14:32:49.329760 after 4.71 seconds
[0m14:32:49.329760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BA2FD460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BA529BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3BA529BE0>]}
[0m14:32:49.329760 [debug] [MainThread]: Flushing usage events
[0m14:34:04.047885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013507E0B560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001350767A270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135045547A0>]}


============================== 14:34:04.051607 | 08e1ac2e-65f7-4642-bf76-f36496333aa8 ==============================
[0m14:34:04.051607 [info ] [MainThread]: Running with dbt=1.8.6
[0m14:34:04.051607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m14:34:04.917887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08e1ac2e-65f7-4642-bf76-f36496333aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001353274F6B0>]}
[0m14:34:04.951335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08e1ac2e-65f7-4642-bf76-f36496333aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001353263D2B0>]}
[0m14:34:04.951335 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m14:34:04.967767 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m14:34:05.067688 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:34:05.067688 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m14:34:05.083275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '08e1ac2e-65f7-4642-bf76-f36496333aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001352FCEF770>]}
[0m14:34:05.893161 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:34:05.893161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '08e1ac2e-65f7-4642-bf76-f36496333aa8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001353291CB00>]}
[0m14:34:06.060888 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.airnow_dbt.airnow_analytics
[0m14:34:06.067346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08e1ac2e-65f7-4642-bf76-f36496333aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013530D60590>]}
[0m14:34:06.150112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08e1ac2e-65f7-4642-bf76-f36496333aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013532C43BC0>]}
[0m14:34:06.150112 [info ] [MainThread]: Found 6 models, 6 data tests, 2 sources, 475 macros
[0m14:34:06.150112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08e1ac2e-65f7-4642-bf76-f36496333aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013532EA3A40>]}
[0m14:34:06.150112 [info ] [MainThread]: 
[0m14:34:06.150112 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:34:06.150112 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m14:34:06.150112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:06.150112 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m14:34:06.150112 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m14:34:06.184563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:06.185727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:07.040268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08e1ac2e-65f7-4642-bf76-f36496333aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013532B351C0>]}
[0m14:34:07.040268 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:34:07.040268 [info ] [MainThread]: 
[0m14:34:07.050229 [debug] [Thread-1 (]: Began running node test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c
[0m14:34:07.050229 [info ] [Thread-1 (]: 1 of 1 START test missing_aqi_measurements_airnow_realtime_stage_ .............. [RUN]
[0m14:34:07.050229 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c'
[0m14:34:07.050229 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c
[0m14:34:07.055989 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c"
[0m14:34:07.055989 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c
[0m14:34:07.070601 [debug] [Thread-1 (]: Writing runtime sql for node "test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c"
[0m14:34:07.070601 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:34:07.070601 [debug] [Thread-1 (]: On test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH observations_count AS (
    SELECT
        DateObserved,
        HourObserved,
        COUNTIF(ParameterName = 'PM2.5') AS pm25_count,
        COUNTIF(ParameterName = 'PM10') AS pm10_count,
        COUNTIF(ParameterName IN ('O3', 'OZONE')) AS o3_count
    FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
    GROUP BY
        1, 2
)

SELECT
    DateObserved,
    HourObserved,
    CASE
        WHEN pm25_count = 0 THEN 'PM2.5 is missing'
        WHEN pm10_count = 0 THEN 'PM10 is missing'
        WHEN o3_count = 0 THEN 'O3 is missing'
        ELSE 'All observations present'
    END AS missing_observation
FROM observations_count
WHERE
    pm25_count = 0 OR
    pm10_count = 0 OR
    o3_count = 0


      
    ) dbt_internal_test
[0m14:34:08.050379 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:bfcd2b5d-55b9-4b02-beb9-1310e14c138d&page=queryresults
[0m14:34:08.934428 [error] [Thread-1 (]: 1 of 1 FAIL 24 missing_aqi_measurements_airnow_realtime_stage_ ................. [[31mFAIL 24[0m in 1.88s]
[0m14:34:08.934428 [debug] [Thread-1 (]: Finished running node test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c
[0m14:34:08.934428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:08.934428 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m14:34:08.947436 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m14:34:08.948726 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m14:34:08.949281 [debug] [MainThread]: Connection 'test.airnow_dbt.missing_aqi_measurements_airnow_realtime_stage_.9fce540a5c' was properly closed.
[0m14:34:08.949281 [info ] [MainThread]: 
[0m14:34:08.949281 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m14:34:08.951897 [debug] [MainThread]: Command end result
[0m14:34:08.972370 [info ] [MainThread]: 
[0m14:34:08.972370 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:34:08.972370 [info ] [MainThread]: 
[0m14:34:08.972370 [error] [MainThread]: [31mFailure in test missing_aqi_measurements_airnow_realtime_stage_ (models\airnow_staging\schema.yml)[0m
[0m14:34:08.972370 [error] [MainThread]:   Got 24 results, configured to fail if != 0
[0m14:34:08.972370 [info ] [MainThread]: 
[0m14:34:08.972370 [info ] [MainThread]:   compiled code at target\compiled\airnow_dbt\models\airnow_staging\schema.yml\missing_aqi_measurements_airnow_realtime_stage_.sql
[0m14:34:08.972370 [info ] [MainThread]: 
[0m14:34:08.972370 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:34:08.972370 [debug] [MainThread]: Command `cli test` failed at 14:34:08.972370 after 5.09 seconds
[0m14:34:08.972370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013507C39250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013507DC4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013507DC63C0>]}
[0m14:34:08.981967 [debug] [MainThread]: Flushing usage events
[0m17:20:26.729295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BCDA415B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BCDA24E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BCD4C5D30>]}


============================== 17:20:26.746098 | 8f37e341-d6f6-4575-8457-80c09a2644c0 ==============================
[0m17:20:26.746098 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:20:26.746098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:20:28.611761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f37e341-d6f6-4575-8457-80c09a2644c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BCCF423F0>]}
[0m17:20:28.644888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f37e341-d6f6-4575-8457-80c09a2644c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF8807980>]}
[0m17:20:28.644888 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:20:28.657975 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:20:28.728210 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:20:28.728210 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:20:28.728210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8f37e341-d6f6-4575-8457-80c09a2644c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF8A1D4F0>]}
[0m17:20:29.511498 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:20:29.511498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8f37e341-d6f6-4575-8457-80c09a2644c0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF8A6E120>]}
[0m17:20:29.744276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f37e341-d6f6-4575-8457-80c09a2644c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF8911310>]}
[0m17:20:29.927437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f37e341-d6f6-4575-8457-80c09a2644c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF8D1E360>]}
[0m17:20:29.927437 [info ] [MainThread]: Found 7 models, 7 data tests, 2 sources, 475 macros
[0m17:20:29.927437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f37e341-d6f6-4575-8457-80c09a2644c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF8B538F0>]}
[0m17:20:29.927437 [info ] [MainThread]: 
[0m17:20:29.927437 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:20:29.927437 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:20:29.927437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:30.544176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m17:20:30.544176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m17:20:30.544176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:30.544176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m17:20:30.544176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:30.577336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:31.211624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f37e341-d6f6-4575-8457-80c09a2644c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF6E763C0>]}
[0m17:20:31.211624 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:20:31.211624 [info ] [MainThread]: 
[0m17:20:31.261436 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_realtime_stage
[0m17:20:31.275523 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_realtime_stage .............. [RUN]
[0m17:20:31.277124 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_realtime_stage'
[0m17:20:31.277124 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_realtime_stage
[0m17:20:31.293272 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_realtime_stage"
[0m17:20:31.300200 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_realtime_stage
[0m17:20:31.311612 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:20:31.826501 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_realtime_stage"
[0m17:20:31.826501 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_realtime_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_realtime_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Real-time Observations Staging Model ***/
/**
The below model converts all columns, except for 'DataPulledAt' and 'DateObserved,' to the correct data type.
'DataPulledAt' and 'DateObserverd' are already TIMESTAMP data types.
**/



WITH airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_raw_realtime`
),

airnow_realtime_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_realtime_source
),

airnow_realtime_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        AVG(Latitude_update) AS Latitude,
        AVG(Longitude_update) AS Longitude,
        ParameterName,
        AVG(AQI_update) AS AQI,
        AQICategory,
        AVG(AQICategoryNumber) AS AQICategoryNumber
    FROM airnow_realtime_update
    GROUP BY
        DateObserved,
        HourObserved_update,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName,
        AQICategory
        
)

SELECT
    *
FROM airnow_realtime_final
    );
  
[0m17:20:32.368345 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:fd30a167-a177-4efb-9287-1f3a54301781&page=queryresults
[0m17:21:05.545597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f37e341-d6f6-4575-8457-80c09a2644c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BF6DE2090>]}
[0m17:21:05.545597 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_realtime_stage ......... [[32mCREATE TABLE (319.0 rows, 57.3 KiB processed)[0m in 34.27s]
[0m17:21:05.545597 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_realtime_stage
[0m17:21:05.561818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:05.562020 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m17:21:05.562020 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m17:21:05.562020 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m17:21:05.562020 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m17:21:05.562020 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_realtime_stage' was properly closed.
[0m17:21:05.562020 [info ] [MainThread]: 
[0m17:21:05.562020 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 35.63 seconds (35.63s).
[0m17:21:05.562020 [debug] [MainThread]: Command end result
[0m17:21:05.660053 [info ] [MainThread]: 
[0m17:21:05.662468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:05.662468 [info ] [MainThread]: 
[0m17:21:05.662468 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:21:05.662468 [debug] [MainThread]: Command `cli run` succeeded at 17:21:05.662468 after 39.09 seconds
[0m17:21:05.668300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BCD300B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BCDDE7FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017BCDDE4FB0>]}
[0m17:21:05.668300 [debug] [MainThread]: Flushing usage events
[0m17:31:05.251078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE5C756A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE8CB6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE8CB6150>]}


============================== 17:31:05.256911 | 924ed623-b05c-428c-9369-8c2395d56d3a ==============================
[0m17:31:05.256911 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:31:05.256911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:31:06.140067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '924ed623-b05c-428c-9369-8c2395d56d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE703E2D0>]}
[0m17:31:06.181038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '924ed623-b05c-428c-9369-8c2395d56d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE8688DA0>]}
[0m17:31:06.181038 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:31:06.189984 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:31:06.258704 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:31:06.258704 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:31:06.258704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '924ed623-b05c-428c-9369-8c2395d56d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AFFC87770>]}
[0m17:31:07.039755 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:31:07.039755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '924ed623-b05c-428c-9369-8c2395d56d3a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE5C289E0>]}
[0m17:31:07.269297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '924ed623-b05c-428c-9369-8c2395d56d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A9406D2E0>]}
[0m17:31:07.355893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '924ed623-b05c-428c-9369-8c2395d56d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A94369280>]}
[0m17:31:07.355893 [info ] [MainThread]: Found 7 models, 7 data tests, 2 sources, 475 macros
[0m17:31:07.355893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '924ed623-b05c-428c-9369-8c2395d56d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A941F9340>]}
[0m17:31:07.355893 [info ] [MainThread]: 
[0m17:31:07.355893 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:31:07.355893 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:31:07.355893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:08.071984 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m17:31:08.072665 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m17:31:08.072665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:08.072665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:08.072665 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m17:31:08.105769 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m17:31:08.122348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:08.136372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:08.784824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '924ed623-b05c-428c-9369-8c2395d56d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A94158AA0>]}
[0m17:31:08.789535 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:31:08.789535 [info ] [MainThread]: 
[0m17:31:08.789535 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_all_observations_analytics
[0m17:31:08.789535 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_analytics.airnow_all_observations_analytics  [RUN]
[0m17:31:08.789535 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_all_observations_analytics'
[0m17:31:08.801000 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_all_observations_analytics
[0m17:31:08.808740 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m17:31:08.808740 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_all_observations_analytics
[0m17:31:08.838527 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m17:31:08.838527 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:31:08.838527 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_all_observations_analytics: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_all_observations_analytics"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
      
    
    

    OPTIONS()
    as (
      /*** AirNow All Observations (Historical and Real-time) ***/
/**
Model UNIONs together historical and real-time AirNow observations. Real-time observations are averaged by day. 'HourObserved' column left out as data is at the day level.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
),

airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
),

airnow_all_observations AS (
    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude,
        Longitude,
        ParameterName,
        AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_source

    UNION ALL 

    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        MIN(Latitude) AS Latitude
        MIN(Longitude) AS Longitude,
        ParameterName,
        ROUND(AVG(AQI)) AS AQI,
        MIN(AQICategory) AS AQICategory,
        ROUND(AVG(AQICategoryNumber)) AS AQICategoryNumber
    FROM airnow_realtime_source
    GROUP BY
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName
)
    );
  
[0m17:31:09.688133 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:eaf88ef8-0750-4ef0-990a-06adcc52aebd&page=queryresults
[0m17:31:09.688133 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword MIN at [50:9]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got keyword MIN at [50:9]')
[0m17:31:10.622276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:ff528cd2-bb1e-4434-a23f-20d46d23a923&page=queryresults
[0m17:31:10.633863 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:ff528cd2-bb1e-4434-a23f-20d46d23a923&page=queryresults
[0m17:31:10.705307 [debug] [Thread-1 (]: Database Error in model airnow_all_observations_analytics (models\airnow_analytics\airnow_all_observations_analytics.sql)
  Syntax error: Expected ")" but got keyword MIN at [50:9]
  compiled Code at target\run\airnow_dbt\models\airnow_analytics\airnow_all_observations_analytics.sql
[0m17:31:10.705307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '924ed623-b05c-428c-9369-8c2395d56d3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029A94355C70>]}
[0m17:31:10.705307 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model airnow_analytics.airnow_all_observations_analytics  [[31mERROR[0m in 1.92s]
[0m17:31:10.705307 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_all_observations_analytics
[0m17:31:10.705307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:10.705307 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m17:31:10.705307 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m17:31:10.705307 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m17:31:10.705307 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m17:31:10.718854 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m17:31:10.718854 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_all_observations_analytics' was properly closed.
[0m17:31:10.718854 [info ] [MainThread]: 
[0m17:31:10.718854 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m17:31:10.720528 [debug] [MainThread]: Command end result
[0m17:31:10.739293 [info ] [MainThread]: 
[0m17:31:10.743222 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:31:10.743804 [info ] [MainThread]: 
[0m17:31:10.743804 [error] [MainThread]:   Database Error in model airnow_all_observations_analytics (models\airnow_analytics\airnow_all_observations_analytics.sql)
  Syntax error: Expected ")" but got keyword MIN at [50:9]
  compiled Code at target\run\airnow_dbt\models\airnow_analytics\airnow_all_observations_analytics.sql
[0m17:31:10.743804 [info ] [MainThread]: 
[0m17:31:10.743804 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:31:10.743804 [debug] [MainThread]: Command `cli run` failed at 17:31:10.743804 after 5.64 seconds
[0m17:31:10.743804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE9483E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE841EAE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029AE8D1A7E0>]}
[0m17:31:10.743804 [debug] [MainThread]: Flushing usage events
[0m17:31:32.187409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AA5582FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AA1E4E660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AA1FF8FB0>]}


============================== 17:31:32.187409 | 1a582c63-585e-462a-bbd5-74aafaa62915 ==============================
[0m17:31:32.187409 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:31:32.187409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m17:31:33.056213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a582c63-585e-462a-bbd5-74aafaa62915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AD02D43B0>]}
[0m17:31:33.097927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a582c63-585e-462a-bbd5-74aafaa62915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ACEC2B2C0>]}
[0m17:31:33.097927 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:31:33.097927 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:31:33.180334 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:31:33.180737 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:31:33.180737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1a582c63-585e-462a-bbd5-74aafaa62915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AD04F1700>]}
[0m17:31:33.964238 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:31:33.964238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1a582c63-585e-462a-bbd5-74aafaa62915', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AD03D07A0>]}
[0m17:31:34.197646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a582c63-585e-462a-bbd5-74aafaa62915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AD046A270>]}
[0m17:31:34.275188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a582c63-585e-462a-bbd5-74aafaa62915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AD0796CC0>]}
[0m17:31:34.275188 [info ] [MainThread]: Found 7 models, 7 data tests, 2 sources, 475 macros
[0m17:31:34.275188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a582c63-585e-462a-bbd5-74aafaa62915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AD044F590>]}
[0m17:31:34.275188 [info ] [MainThread]: 
[0m17:31:34.280263 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:31:34.280739 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:31:34.280739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:34.783079 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m17:31:34.784086 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m17:31:34.785176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m17:31:34.785176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:34.786234 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m17:31:34.787243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:34.788381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:34.815442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:35.379935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a582c63-585e-462a-bbd5-74aafaa62915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AD05FEAB0>]}
[0m17:31:35.380736 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:31:35.380736 [info ] [MainThread]: 
[0m17:31:35.388246 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_all_observations_analytics
[0m17:31:35.390741 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_analytics.airnow_all_observations_analytics  [RUN]
[0m17:31:35.393087 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_all_observations_analytics'
[0m17:31:35.393087 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_all_observations_analytics
[0m17:31:35.400986 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m17:31:35.402091 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_all_observations_analytics
[0m17:31:35.430097 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m17:31:35.431323 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:31:35.431323 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_all_observations_analytics: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_all_observations_analytics"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
      
    
    

    OPTIONS()
    as (
      /*** AirNow All Observations (Historical and Real-time) ***/
/**
Model UNIONs together historical and real-time AirNow observations. Real-time observations are averaged by day. 'HourObserved' column left out as data is at the day level.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
),

airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
),

airnow_all_observations AS (
    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude,
        Longitude,
        ParameterName,
        AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_source

    UNION ALL 

    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        MIN(Latitude) AS Latitude,
        MIN(Longitude) AS Longitude,
        ParameterName,
        ROUND(AVG(AQI)) AS AQI,
        MIN(AQICategory) AS AQICategory,
        ROUND(AVG(AQICategoryNumber)) AS AQICategoryNumber
    FROM airnow_realtime_source
    GROUP BY
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName
)
    );
  
[0m17:31:35.900405 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:cb140067-58f3-4848-80fd-a926898c07c9&page=queryresults
[0m17:31:35.909356 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [63:5]; reason: invalidQuery, location: query, message: Syntax error: Unexpected ")" at [63:5]')
[0m17:31:36.563888 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:bc00f702-646a-4018-a447-07173e5a1678&page=queryresults
[0m17:31:36.563888 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:bc00f702-646a-4018-a447-07173e5a1678&page=queryresults
[0m17:31:36.563888 [debug] [Thread-1 (]: Database Error in model airnow_all_observations_analytics (models\airnow_analytics\airnow_all_observations_analytics.sql)
  Syntax error: Unexpected ")" at [63:5]
  compiled Code at target\run\airnow_dbt\models\airnow_analytics\airnow_all_observations_analytics.sql
[0m17:31:36.577079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a582c63-585e-462a-bbd5-74aafaa62915', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AD0812EA0>]}
[0m17:31:36.577079 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model airnow_analytics.airnow_all_observations_analytics  [[31mERROR[0m in 1.17s]
[0m17:31:36.578831 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_all_observations_analytics
[0m17:31:36.578831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:36.578831 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m17:31:36.578831 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m17:31:36.578831 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m17:31:36.578831 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m17:31:36.578831 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m17:31:36.582842 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_all_observations_analytics' was properly closed.
[0m17:31:36.582842 [info ] [MainThread]: 
[0m17:31:36.582842 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m17:31:36.584969 [debug] [MainThread]: Command end result
[0m17:31:36.598442 [info ] [MainThread]: 
[0m17:31:36.608949 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:31:36.608949 [info ] [MainThread]: 
[0m17:31:36.608949 [error] [MainThread]:   Database Error in model airnow_all_observations_analytics (models\airnow_analytics\airnow_all_observations_analytics.sql)
  Syntax error: Unexpected ")" at [63:5]
  compiled Code at target\run\airnow_dbt\models\airnow_analytics\airnow_all_observations_analytics.sql
[0m17:31:36.608949 [info ] [MainThread]: 
[0m17:31:36.611558 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:31:36.612512 [debug] [MainThread]: Command `cli run` failed at 17:31:36.612512 after 4.57 seconds
[0m17:31:36.612512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AA51276E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AA5085C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017AA48221B0>]}
[0m17:31:36.613920 [debug] [MainThread]: Flushing usage events
[0m17:32:27.164568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B7B985820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B7B08EE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B7BBAD130>]}


============================== 17:32:27.169006 | 5dc0fc1a-7e58-45e9-a0dc-f2fcab9022f5 ==============================
[0m17:32:27.169006 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:32:27.169006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:32:28.054648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dc0fc1a-7e58-45e9-a0dc-f2fcab9022f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B7FB76750>]}
[0m17:32:28.085205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dc0fc1a-7e58-45e9-a0dc-f2fcab9022f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B79849610>]}
[0m17:32:28.085205 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:32:28.100829 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:32:28.169297 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:32:28.169297 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:32:28.169297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5dc0fc1a-7e58-45e9-a0dc-f2fcab9022f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B26911B50>]}
[0m17:32:28.927915 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:32:28.927915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5dc0fc1a-7e58-45e9-a0dc-f2fcab9022f5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B26A11910>]}
[0m17:32:29.173527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dc0fc1a-7e58-45e9-a0dc-f2fcab9022f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B269D4A70>]}
[0m17:32:29.251328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dc0fc1a-7e58-45e9-a0dc-f2fcab9022f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B26BB76B0>]}
[0m17:32:29.251328 [info ] [MainThread]: Found 7 models, 7 data tests, 2 sources, 475 macros
[0m17:32:29.251328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dc0fc1a-7e58-45e9-a0dc-f2fcab9022f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B269E0110>]}
[0m17:32:29.251328 [info ] [MainThread]: 
[0m17:32:29.251328 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:32:29.251328 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:32:29.251328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:29.802294 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m17:32:29.802294 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m17:32:29.802294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:29.802294 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m17:32:29.802294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:29.802294 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m17:32:29.814303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:29.861516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:30.463337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dc0fc1a-7e58-45e9-a0dc-f2fcab9022f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B26804530>]}
[0m17:32:30.463337 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:32:30.463337 [info ] [MainThread]: 
[0m17:32:30.466071 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_all_observations_analytics
[0m17:32:30.466071 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_analytics.airnow_all_observations_analytics  [RUN]
[0m17:32:30.474675 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_all_observations_analytics'
[0m17:32:30.474675 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_all_observations_analytics
[0m17:32:30.474675 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m17:32:30.474675 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_all_observations_analytics
[0m17:32:30.501312 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m17:32:30.501312 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:30.501312 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_all_observations_analytics: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_all_observations_analytics"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
      
    
    

    OPTIONS()
    as (
      /*** AirNow All Observations (Historical and Real-time) ***/
/**
Model UNIONs together historical and real-time AirNow observations. Real-time observations are averaged by day. 'HourObserved' column left out as data is at the day level.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
),

airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
),

airnow_all_observations AS (
    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude,
        Longitude,
        ParameterName,
        AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_source

    UNION ALL 

    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        MIN(Latitude) AS Latitude,
        MIN(Longitude) AS Longitude,
        ParameterName,
        ROUND(AVG(AQI)) AS AQI,
        MIN(AQICategory) AS AQICategory,
        ROUND(AVG(AQICategoryNumber)) AS AQICategoryNumber
    FROM airnow_realtime_source
    GROUP BY
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName
)

SELECT * FROM airnow_all_observations
    );
  
[0m17:32:31.346643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:8d88ace2-6fea-4a5a-8070-60c8fe7ac514&page=queryresults
[0m17:33:45.197876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dc0fc1a-7e58-45e9-a0dc-f2fcab9022f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B269EEDE0>]}
[0m17:33:45.197876 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_analytics.airnow_all_observations_analytics  [[32mCREATE TABLE (5.8k rows, 571.8 KiB processed)[0m in 74.73s]
[0m17:33:45.197876 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_all_observations_analytics
[0m17:33:45.205528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:45.205528 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m17:33:45.205528 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m17:33:45.205528 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m17:33:45.205528 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m17:33:45.205528 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m17:33:45.205528 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_all_observations_analytics' was properly closed.
[0m17:33:45.213537 [info ] [MainThread]: 
[0m17:33:45.213537 [info ] [MainThread]: Finished running 1 table model in 0 hours 1 minutes and 15.96 seconds (75.96s).
[0m17:33:45.213537 [debug] [MainThread]: Command end result
[0m17:33:45.275020 [info ] [MainThread]: 
[0m17:33:45.275020 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:45.275020 [info ] [MainThread]: 
[0m17:33:45.275020 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:33:45.283029 [debug] [MainThread]: Command `cli run` succeeded at 17:33:45.283029 after 78.26 seconds
[0m17:33:45.284938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B7BCA8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B79277FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016B7939FFE0>]}
[0m17:33:45.284938 [debug] [MainThread]: Flushing usage events
[0m17:36:08.249341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBEE3BBE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBF0DB6780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBF0DB4620>]}


============================== 17:36:08.260848 | 47ad3915-3aaf-4cc9-bb20-0a345ab1327f ==============================
[0m17:36:08.260848 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:36:08.260848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:36:09.138385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47ad3915-3aaf-4cc9-bb20-0a345ab1327f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBEE90E330>]}
[0m17:36:09.174573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47ad3915-3aaf-4cc9-bb20-0a345ab1327f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBFF7760F0>]}
[0m17:36:09.174573 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:36:09.181959 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:36:09.249189 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:36:09.249189 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:36:09.249189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '47ad3915-3aaf-4cc9-bb20-0a345ab1327f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBF05ED0D0>]}
[0m17:36:09.990182 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:36:09.990182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '47ad3915-3aaf-4cc9-bb20-0a345ab1327f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9BB119A0>]}
[0m17:36:10.231483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47ad3915-3aaf-4cc9-bb20-0a345ab1327f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9BA93E00>]}
[0m17:36:10.310675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47ad3915-3aaf-4cc9-bb20-0a345ab1327f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9BCCE150>]}
[0m17:36:10.314877 [info ] [MainThread]: Found 7 models, 7 data tests, 2 sources, 475 macros
[0m17:36:10.314877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47ad3915-3aaf-4cc9-bb20-0a345ab1327f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9BA68B00>]}
[0m17:36:10.314877 [info ] [MainThread]: 
[0m17:36:10.314877 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:36:10.314877 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:36:10.319008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:10.898288 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m17:36:10.898288 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m17:36:10.898288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:10.898288 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m17:36:10.898288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:10.898288 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m17:36:10.931262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:10.947868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:12.087131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47ad3915-3aaf-4cc9-bb20-0a345ab1327f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9BAE2D20>]}
[0m17:36:12.090270 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:36:12.090270 [info ] [MainThread]: 
[0m17:36:12.092911 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_all_observations_analytics
[0m17:36:12.097341 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_analytics.airnow_all_observations_analytics  [RUN]
[0m17:36:12.098401 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_all_observations_analytics'
[0m17:36:12.099223 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_all_observations_analytics
[0m17:36:12.100755 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m17:36:12.100755 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_all_observations_analytics
[0m17:36:12.119617 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:36:12.577097 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m17:36:12.577097 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_all_observations_analytics: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_all_observations_analytics"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
      
    
    

    OPTIONS()
    as (
      /*** AirNow All Observations (Historical and Real-time) ***/
/**
Model UNIONs together historical and real-time AirNow observations. Real-time observations are averaged by day. 'HourObserved' column left out as data is at the day level.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
),

airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
),

airnow_all_observations AS (
    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        MIN(Latitude) AS Latitude,
        MIN(Longitude) AS Longitude,
        ParameterName,
        ROUND(AVG(AQI)) AS AQI,
        MIN(AQICategory) AS AQICategory,
        ROUND(AVG(AQICategoryNumber)) AS AQICategoryNumber
    FROM airnow_hist_source

    UNION ALL 

    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        MIN(Latitude) AS Latitude,
        MIN(Longitude) AS Longitude,
        ParameterName,
        ROUND(AVG(AQI)) AS AQI,
        MIN(AQICategory) AS AQICategory,
        ROUND(AVG(AQICategoryNumber)) AS AQICategoryNumber
    FROM airnow_realtime_source
    GROUP BY
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName
)

SELECT * FROM airnow_all_observations
    );
  
[0m17:36:13.248145 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:4ff6d7a6-0ccc-4a7f-aed7-31dc205773fa&page=queryresults
[0m17:36:13.429978 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column DateObserved which is neither grouped nor aggregated at [30:9]; reason: invalidQuery, location: query, message: SELECT list expression references column DateObserved which is neither grouped nor aggregated at [30:9]')
[0m17:36:14.196046 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:927cbf75-ea2f-4cf5-9a8b-24f3820fc143&page=queryresults
[0m17:36:14.348481 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:927cbf75-ea2f-4cf5-9a8b-24f3820fc143&page=queryresults
[0m17:36:14.362016 [debug] [Thread-1 (]: Database Error in model airnow_all_observations_analytics (models\airnow_analytics\airnow_all_observations_analytics.sql)
  SELECT list expression references column DateObserved which is neither grouped nor aggregated at [30:9]
  compiled Code at target\run\airnow_dbt\models\airnow_analytics\airnow_all_observations_analytics.sql
[0m17:36:14.362016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47ad3915-3aaf-4cc9-bb20-0a345ab1327f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9B832600>]}
[0m17:36:14.365388 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model airnow_analytics.airnow_all_observations_analytics  [[31mERROR[0m in 2.26s]
[0m17:36:14.365388 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_all_observations_analytics
[0m17:36:14.367493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:14.367493 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m17:36:14.367493 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m17:36:14.367493 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m17:36:14.367493 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m17:36:14.367493 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m17:36:14.367493 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_all_observations_analytics' was properly closed.
[0m17:36:14.367493 [info ] [MainThread]: 
[0m17:36:14.367493 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m17:36:14.367493 [debug] [MainThread]: Command end result
[0m17:36:14.396099 [info ] [MainThread]: 
[0m17:36:14.396099 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:36:14.397105 [info ] [MainThread]: 
[0m17:36:14.397105 [error] [MainThread]:   Database Error in model airnow_all_observations_analytics (models\airnow_analytics\airnow_all_observations_analytics.sql)
  SELECT list expression references column DateObserved which is neither grouped nor aggregated at [30:9]
  compiled Code at target\run\airnow_dbt\models\airnow_analytics\airnow_all_observations_analytics.sql
[0m17:36:14.398277 [info ] [MainThread]: 
[0m17:36:14.398277 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:36:14.398277 [debug] [MainThread]: Command `cli run` failed at 17:36:14.398277 after 6.28 seconds
[0m17:36:14.398277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBF063DF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9B8E3E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9BCC4650>]}
[0m17:36:14.398277 [debug] [MainThread]: Flushing usage events
[0m17:38:55.525735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158980AFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021589769D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021589769E80>]}


============================== 17:38:55.525735 | c4ea8f91-c084-48b6-8d6a-049a477f51ac ==============================
[0m17:38:55.525735 [info ] [MainThread]: Running with dbt=1.8.6
[0m17:38:55.525735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:38:56.433471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4ea8f91-c084-48b6-8d6a-049a477f51ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215B4918890>]}
[0m17:38:56.475159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4ea8f91-c084-48b6-8d6a-049a477f51ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215B2FB5250>]}
[0m17:38:56.475159 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m17:38:56.475159 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m17:38:56.553481 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m17:38:56.553481 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m17:38:56.553481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c4ea8f91-c084-48b6-8d6a-049a477f51ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021589ED16A0>]}
[0m17:38:57.308185 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m17:38:57.308185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c4ea8f91-c084-48b6-8d6a-049a477f51ac', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215B4C28B60>]}
[0m17:38:57.533444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4ea8f91-c084-48b6-8d6a-049a477f51ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215B4C6FD70>]}
[0m17:38:57.608446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4ea8f91-c084-48b6-8d6a-049a477f51ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215B4ABC860>]}
[0m17:38:57.608446 [info ] [MainThread]: Found 7 models, 7 data tests, 2 sources, 475 macros
[0m17:38:57.608446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4ea8f91-c084-48b6-8d6a-049a477f51ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215B4DFAE70>]}
[0m17:38:57.608446 [info ] [MainThread]: 
[0m17:38:57.608446 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:38:57.608446 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m17:38:57.608446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:58.701020 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m17:38:58.701020 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m17:38:58.701020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:58.701020 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m17:38:58.701020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:58.701020 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m17:38:58.724055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:58.757460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:59.258154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4ea8f91-c084-48b6-8d6a-049a477f51ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215B49EE1B0>]}
[0m17:38:59.291648 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:38:59.291648 [info ] [MainThread]: 
[0m17:38:59.291648 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_all_observations_analytics
[0m17:38:59.305737 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_analytics.airnow_all_observations_analytics  [RUN]
[0m17:38:59.309555 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_all_observations_analytics'
[0m17:38:59.309555 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_all_observations_analytics
[0m17:38:59.314138 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m17:38:59.314138 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_all_observations_analytics
[0m17:38:59.327245 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:38:59.842822 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m17:38:59.842822 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_all_observations_analytics: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_all_observations_analytics"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
      
    
    

    OPTIONS()
    as (
      /*** AirNow All Observations (Historical and Real-time) ***/
/**
Model UNIONs together historical and real-time AirNow observations. Real-time observations are averaged by day. 'HourObserved' column left out as data is at the day level.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
),

airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
),

airnow_hist_agg AS (
    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        MIN(Latitude) AS Latitude,
        MIN(Longitude) AS Longitude,
        ParameterName,
        ROUND(AVG(AQI)) AS AQI,
        MIN(AQICategory) AS AQICategory,
        ROUND(AVG(AQICategoryNumber)) AS AQICategoryNumber
    FROM airnow_hist_source
    GROUP BY
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName

),

airnow_realtime_agg AS (
    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        MIN(Latitude) AS Latitude,
        MIN(Longitude) AS Longitude,
        ParameterName,
        ROUND(AVG(AQI)) AS AQI,
        MIN(AQICategory) AS AQICategory,
        ROUND(AVG(AQICategoryNumber)) AS AQICategoryNumber
    FROM airnow_realtime_source
    GROUP BY
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName
),

airnow_all_observations_final AS (
    SELECT * FROM airnow_hist_agg
    UNION All
    SELECT * FROM airnow_realtime_agg
)


SELECT * FROM airnow_all_observations_final
    );
  
[0m17:39:00.336500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:7a8cf5f3-5d38-4201-8d7c-4e8a1ba4c227&page=queryresults
[0m17:39:02.589084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c4ea8f91-c084-48b6-8d6a-049a477f51ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215B2F22660>]}
[0m17:39:02.589084 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_analytics.airnow_all_observations_analytics  [[32mCREATE TABLE (5.8k rows, 571.8 KiB processed)[0m in 3.28s]
[0m17:39:02.589084 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_all_observations_analytics
[0m17:39:02.603590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:02.604308 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m17:39:02.605499 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m17:39:02.605499 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m17:39:02.605499 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m17:39:02.605499 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m17:39:02.605499 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_all_observations_analytics' was properly closed.
[0m17:39:02.605499 [info ] [MainThread]: 
[0m17:39:02.605499 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m17:39:02.608917 [debug] [MainThread]: Command end result
[0m17:39:02.628771 [info ] [MainThread]: 
[0m17:39:02.628771 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:39:02.628771 [info ] [MainThread]: 
[0m17:39:02.628771 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:39:02.628771 [debug] [MainThread]: Command `cli run` succeeded at 17:39:02.628771 after 7.24 seconds
[0m17:39:02.628771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215B4735D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215B4A46FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215B4E05EE0>]}
[0m17:39:02.628771 [debug] [MainThread]: Flushing usage events
[0m15:30:41.465768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201041A6C30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201041A5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201041A5280>]}


============================== 15:30:41.473862 | 091708ee-8102-4936-81bf-041ebf6c4c4a ==============================
[0m15:30:41.473862 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:30:41.473862 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:30:42.581723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '091708ee-8102-4936-81bf-041ebf6c4c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201020FE1B0>]}
[0m15:30:42.620333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '091708ee-8102-4936-81bf-041ebf6c4c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012CE580B0>]}
[0m15:30:42.621326 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:30:42.627258 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m15:30:42.694945 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:30:42.695939 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m15:30:42.695939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '091708ee-8102-4936-81bf-041ebf6c4c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201046ACA10>]}
[0m15:30:43.439049 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:30:43.440129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '091708ee-8102-4936-81bf-041ebf6c4c4a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012F1DC2C0>]}
[0m15:30:43.663251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '091708ee-8102-4936-81bf-041ebf6c4c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012F270BC0>]}
[0m15:30:43.765740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '091708ee-8102-4936-81bf-041ebf6c4c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012F3E5A30>]}
[0m15:30:43.766737 [info ] [MainThread]: Found 7 models, 8 data tests, 2 sources, 475 macros
[0m15:30:43.766737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '091708ee-8102-4936-81bf-041ebf6c4c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012F021EB0>]}
[0m15:30:43.767734 [info ] [MainThread]: 
[0m15:30:43.768825 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:30:43.772442 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m15:30:43.772442 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m15:30:43.773464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:43.773464 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m15:30:43.774460 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m15:30:43.774460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:43.775589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:43.775589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:44.425855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '091708ee-8102-4936-81bf-041ebf6c4c4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002012F2899D0>]}
[0m15:30:44.426926 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:30:44.427881 [info ] [MainThread]: 
[0m15:30:44.431987 [debug] [Thread-1 (]: Began running node test.airnow_dbt.missing_aqi_measurements_airnow_all_observations_analytics_.2508a53249
[0m15:30:44.433019 [debug] [Thread-2 (]: Began running node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:30:44.433019 [info ] [Thread-1 (]: 1 of 2 START test missing_aqi_measurements_airnow_all_observations_analytics_ .. [RUN]
[0m15:30:44.434009 [info ] [Thread-2 (]: 2 of 2 START test missing_dates_airnow_all_observations_analytics_DateObserved . [RUN]
[0m15:30:44.434009 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_aqi_measurements_airnow_all_observations_analytics_.2508a53249'
[0m15:30:44.434929 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8'
[0m15:30:44.434929 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.missing_aqi_measurements_airnow_all_observations_analytics_.2508a53249
[0m15:30:44.435993 [debug] [Thread-2 (]: Began compiling node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:30:44.443146 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.missing_aqi_measurements_airnow_all_observations_analytics_.2508a53249"
[0m15:30:44.446125 [debug] [Thread-2 (]: Writing injected SQL for node "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"
[0m15:30:44.449331 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.missing_aqi_measurements_airnow_all_observations_analytics_.2508a53249
[0m15:30:44.450437 [debug] [Thread-2 (]: Began executing node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:30:44.466375 [debug] [Thread-1 (]: Writing runtime sql for node "test.airnow_dbt.missing_aqi_measurements_airnow_all_observations_analytics_.2508a53249"
[0m15:30:44.467462 [debug] [Thread-2 (]: Writing runtime sql for node "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"
[0m15:30:44.471270 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:30:44.472256 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:30:44.473243 [debug] [Thread-2 (]: On test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH date_spine AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_test`.`date_spine`
),

missing_dates AS (
    SELECT
        ds.date_day
    FROM
        date_spine ds
    LEFT JOIN (
        SELECT
            DISTINCT DATE(DateObserved) AS date_day
        FROM
            `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
    ) AS model_dates
    ON ds.date_day = model_dates.date_day
    WHERE model_dates.date_day IS NULL
)

SELECT *
FROM missing_dates


      
    ) dbt_internal_test
[0m15:30:44.475253 [debug] [Thread-1 (]: On test.airnow_dbt.missing_aqi_measurements_airnow_all_observations_analytics_.2508a53249: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_aqi_measurements_airnow_all_observations_analytics_.2508a53249"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH observations_count AS (
    SELECT
        DateObserved,
        HourObserved,
        COUNTIF(ParameterName = 'PM2.5') AS pm25_count,
        COUNTIF(ParameterName = 'PM10') AS pm10_count,
        COUNTIF(ParameterName IN ('O3', 'OZONE')) AS o3_count
    FROM `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
    GROUP BY
        1, 2
)

SELECT
    DateObserved,
    HourObserved,
    CASE
        WHEN pm25_count = 0 THEN 'PM2.5 is missing'
        WHEN pm10_count = 0 THEN 'PM10 is missing'
        WHEN o3_count = 0 THEN 'O3 is missing'
        ELSE 'All observations present'
    END AS missing_observation
FROM observations_count
WHERE
    pm25_count = 0 OR
    pm10_count = 0 OR
    o3_count = 0


      
    ) dbt_internal_test
[0m15:30:45.169871 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:fa607db7-ca57-4ac4-a2dc-d737b51b9fda&page=queryresults
[0m15:30:45.169871 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: HourObserved; Did you mean DateObserved? at [12:9]; reason: invalidQuery, location: query, message: Unrecognized name: HourObserved; Did you mean DateObserved? at [12:9]')
[0m15:30:45.561473 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:a44aeee7-d8b3-4849-8cd5-8b5c64e6498f&page=queryresults
[0m15:30:46.126516 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:84954889-846f-4f7b-af95-61a5ca1c6904&page=queryresults
[0m15:30:46.127576 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:84954889-846f-4f7b-af95-61a5ca1c6904&page=queryresults
[0m15:30:46.148759 [debug] [Thread-1 (]: Database Error in test missing_aqi_measurements_airnow_all_observations_analytics_ (models\airnow_analytics\schema.yml)
  Unrecognized name: HourObserved; Did you mean DateObserved? at [12:9]
  compiled Code at target\run\airnow_dbt\models\airnow_analytics\schema.yml\missing_aqi_measurements_airnow_all_observations_analytics_.sql
[0m15:30:46.149795 [error] [Thread-1 (]: 1 of 2 ERROR missing_aqi_measurements_airnow_all_observations_analytics_ ....... [[31mERROR[0m in 1.72s]
[0m15:30:46.149795 [debug] [Thread-1 (]: Finished running node test.airnow_dbt.missing_aqi_measurements_airnow_all_observations_analytics_.2508a53249
[0m15:30:46.277515 [error] [Thread-2 (]: 2 of 2 FAIL 1 missing_dates_airnow_all_observations_analytics_DateObserved ..... [[31mFAIL 1[0m in 1.84s]
[0m15:30:46.279019 [debug] [Thread-2 (]: Finished running node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:30:46.282038 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:46.283043 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m15:30:46.284039 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m15:30:46.284039 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m15:30:46.285028 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m15:30:46.286024 [debug] [MainThread]: Connection 'test.airnow_dbt.missing_aqi_measurements_airnow_all_observations_analytics_.2508a53249' was properly closed.
[0m15:30:46.286024 [debug] [MainThread]: Connection 'test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8' was properly closed.
[0m15:30:46.287021 [info ] [MainThread]: 
[0m15:30:46.288018 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m15:30:46.289523 [debug] [MainThread]: Command end result
[0m15:30:46.313820 [info ] [MainThread]: 
[0m15:30:46.314817 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:30:46.314817 [info ] [MainThread]: 
[0m15:30:46.314817 [error] [MainThread]:   Database Error in test missing_aqi_measurements_airnow_all_observations_analytics_ (models\airnow_analytics\schema.yml)
  Unrecognized name: HourObserved; Did you mean DateObserved? at [12:9]
  compiled Code at target\run\airnow_dbt\models\airnow_analytics\schema.yml\missing_aqi_measurements_airnow_all_observations_analytics_.sql
[0m15:30:46.315813 [info ] [MainThread]: 
[0m15:30:46.315813 [error] [MainThread]: [31mFailure in test missing_dates_airnow_all_observations_analytics_DateObserved (models\airnow_analytics\schema.yml)[0m
[0m15:30:46.316810 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:30:46.316810 [info ] [MainThread]: 
[0m15:30:46.316810 [info ] [MainThread]:   compiled code at target\compiled\airnow_dbt\models\airnow_analytics\schema.yml\missing_dates_airnow_all_observations_analytics_DateObserved.sql
[0m15:30:46.316810 [info ] [MainThread]: 
[0m15:30:46.317807 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:30:46.318643 [debug] [MainThread]: Command `cli test` failed at 15:30:46.318643 after 5.01 seconds
[0m15:30:46.318643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020104565640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201045644D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020103C20830>]}
[0m15:30:46.318643 [debug] [MainThread]: Flushing usage events
[0m15:42:12.874979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021315B04DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021315FAAFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213166D3740>]}


============================== 15:42:12.880962 | 721d67a0-2021-4428-8fda-279f3fb7528a ==============================
[0m15:42:12.880962 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:42:12.882986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:42:13.932531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '721d67a0-2021-4428-8fda-279f3fb7528a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021341104D40>]}
[0m15:42:13.970939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '721d67a0-2021-4428-8fda-279f3fb7528a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002133F1252B0>]}
[0m15:42:13.972094 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:42:13.977501 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m15:42:14.042527 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:42:14.042527 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m15:42:14.043453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '721d67a0-2021-4428-8fda-279f3fb7528a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021340FF0080>]}
[0m15:42:14.765995 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:42:14.766992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '721d67a0-2021-4428-8fda-279f3fb7528a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021316423C50>]}
[0m15:42:14.974297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '721d67a0-2021-4428-8fda-279f3fb7528a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002134157BA40>]}
[0m15:42:15.071012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '721d67a0-2021-4428-8fda-279f3fb7528a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021341643E60>]}
[0m15:42:15.072144 [info ] [MainThread]: Found 7 models, 8 data tests, 2 sources, 476 macros
[0m15:42:15.072144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '721d67a0-2021-4428-8fda-279f3fb7528a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213417F1D60>]}
[0m15:42:15.073142 [info ] [MainThread]: 
[0m15:42:15.074295 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:15.077379 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m15:42:15.078396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:15.078396 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m15:42:15.079363 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m15:42:15.079363 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m15:42:15.080367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:15.103059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:15.103985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:16.127726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '721d67a0-2021-4428-8fda-279f3fb7528a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213417F3920>]}
[0m15:42:16.128805 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:42:16.129797 [info ] [MainThread]: 
[0m15:42:16.135266 [debug] [Thread-1 (]: Began running node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:42:16.136361 [debug] [Thread-2 (]: Began running node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:42:16.137276 [info ] [Thread-1 (]: 1 of 2 START test missing_aqi_measurements_daily_airnow_all_observations_analytics_  [RUN]
[0m15:42:16.138350 [info ] [Thread-2 (]: 2 of 2 START test missing_dates_airnow_all_observations_analytics_DateObserved . [RUN]
[0m15:42:16.139268 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419'
[0m15:42:16.141289 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8'
[0m15:42:16.142261 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:42:16.143263 [debug] [Thread-2 (]: Began compiling node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:42:16.148317 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419"
[0m15:42:16.156401 [debug] [Thread-2 (]: Writing injected SQL for node "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"
[0m15:42:16.160391 [debug] [Thread-2 (]: Began executing node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:42:16.172716 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:42:16.175738 [debug] [Thread-2 (]: Writing runtime sql for node "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"
[0m15:42:16.177730 [debug] [Thread-1 (]: Writing runtime sql for node "test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419"
[0m15:42:16.178720 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:42:16.180721 [debug] [Thread-2 (]: On test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH date_spine AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_test`.`date_spine`
),

missing_dates AS (
    SELECT
        ds.date_day
    FROM
        date_spine ds
    LEFT JOIN (
        SELECT
            DISTINCT DATE(DateObserved) AS date_day
        FROM
            `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
    ) AS model_dates
    ON ds.date_day = model_dates.date_day
    WHERE model_dates.date_day IS NULL
)

SELECT *
FROM missing_dates


      
    ) dbt_internal_test
[0m15:42:16.206528 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:42:16.208532 [debug] [Thread-1 (]: On test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH observations_count AS (
    SELECT
        DateObserved,
        COUNTIF(ParameterName = 'PM2.5') AS pm25_count,
        COUNTIF(ParameterName = 'PM10') AS pm10_count,
        COUNTIF(ParameterName IN ('O3', 'OZONE')) AS o3_count
    FROM `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
    GROUP BY
        1, 2
)

SELECT
    DateObserved,
    CASE
        WHEN pm25_count = 0 THEN 'PM2.5 is missing'
        WHEN pm10_count = 0 THEN 'PM10 is missing'
        WHEN o3_count = 0 THEN 'O3 is missing'
        ELSE 'All observations present'
    END AS missing_observation
FROM observations_count
WHERE
    pm25_count = 0 OR
    pm10_count = 0 OR
    o3_count = 0


      
    ) dbt_internal_test
[0m15:42:16.836872 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:c807bda6-36ff-422c-9e71-1aef6cb8e1cb&page=queryresults
[0m15:42:16.837651 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column 2 contains an aggregation function, which is not allowed in GROUP BY at [17:12]; reason: invalidQuery, location: query, message: Column 2 contains an aggregation function, which is not allowed in GROUP BY at [17:12]')
[0m15:42:23.806092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C11A3F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BF6CC2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C1E9C7A0>]}


============================== 15:42:23.811752 | 0cc1e2cb-a75d-4b2b-aadc-321dafe3031f ==============================
[0m15:42:23.811752 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:42:23.812735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:42:24.648984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cc1e2cb-a75d-4b2b-aadc-321dafe3031f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201EB4381A0>]}
[0m15:42:24.688388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cc1e2cb-a75d-4b2b-aadc-321dafe3031f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BFC75580>]}
[0m15:42:24.689347 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:42:24.695556 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m15:42:24.816070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:24.817065 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:24.846881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cc1e2cb-a75d-4b2b-aadc-321dafe3031f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201ECB5D760>]}
[0m15:42:24.922738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cc1e2cb-a75d-4b2b-aadc-321dafe3031f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201ECDA3E00>]}
[0m15:42:24.922738 [info ] [MainThread]: Found 7 models, 8 data tests, 2 sources, 476 macros
[0m15:42:24.922738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cc1e2cb-a75d-4b2b-aadc-321dafe3031f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BFC49AF0>]}
[0m15:42:24.922738 [info ] [MainThread]: 
[0m15:42:24.922738 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:24.936061 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m15:42:24.936061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:24.937116 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m15:42:24.960501 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m15:42:24.961543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:24.961543 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m15:42:24.962556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:24.986721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:25.553169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cc1e2cb-a75d-4b2b-aadc-321dafe3031f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201ECF6B980>]}
[0m15:42:25.555161 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:42:25.556213 [info ] [MainThread]: 
[0m15:42:25.564132 [debug] [Thread-1 (]: Began running node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:42:25.565128 [debug] [Thread-2 (]: Began running node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:42:25.565736 [info ] [Thread-1 (]: 1 of 2 START test missing_aqi_measurements_daily_airnow_all_observations_analytics_  [RUN]
[0m15:42:25.566741 [info ] [Thread-2 (]: 2 of 2 START test missing_dates_airnow_all_observations_analytics_DateObserved . [RUN]
[0m15:42:25.568734 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419'
[0m15:42:25.569730 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8'
[0m15:42:25.570779 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:42:25.571723 [debug] [Thread-2 (]: Began compiling node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:42:25.586673 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419"
[0m15:42:25.591732 [debug] [Thread-2 (]: Writing injected SQL for node "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"
[0m15:42:25.592651 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:42:25.593648 [debug] [Thread-2 (]: Began executing node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:42:25.608922 [debug] [Thread-1 (]: Writing runtime sql for node "test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419"
[0m15:42:25.609966 [debug] [Thread-2 (]: Writing runtime sql for node "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"
[0m15:42:25.612212 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:42:25.612714 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:42:25.613956 [debug] [Thread-1 (]: On test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH observations_count AS (
    SELECT
        DateObserved,
        COUNTIF(ParameterName = 'PM2.5') AS pm25_count,
        COUNTIF(ParameterName = 'PM10') AS pm10_count,
        COUNTIF(ParameterName IN ('O3', 'OZONE')) AS o3_count
    FROM `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
    GROUP BY
        1, 2
)

SELECT
    DateObserved,
    CASE
        WHEN pm25_count = 0 THEN 'PM2.5 is missing'
        WHEN pm10_count = 0 THEN 'PM10 is missing'
        WHEN o3_count = 0 THEN 'O3 is missing'
        ELSE 'All observations present'
    END AS missing_observation
FROM observations_count
WHERE
    pm25_count = 0 OR
    pm10_count = 0 OR
    o3_count = 0


      
    ) dbt_internal_test
[0m15:42:25.636669 [debug] [Thread-2 (]: On test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH date_spine AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_test`.`date_spine`
),

missing_dates AS (
    SELECT
        ds.date_day
    FROM
        date_spine ds
    LEFT JOIN (
        SELECT
            DISTINCT DATE(DateObserved) AS date_day
        FROM
            `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
    ) AS model_dates
    ON ds.date_day = model_dates.date_day
    WHERE model_dates.date_day IS NULL
)

SELECT *
FROM missing_dates


      
    ) dbt_internal_test
[0m15:42:26.578886 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:7b1ee6ca-959d-4c33-814c-e027004dbb4a&page=queryresults
[0m15:42:26.579966 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column 2 contains an aggregation function, which is not allowed in GROUP BY at [17:12]; reason: invalidQuery, location: query, message: Column 2 contains an aggregation function, which is not allowed in GROUP BY at [17:12]')
[0m15:42:26.615660 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:b0983217-c12c-41c5-82af-fd5d571aa2e5&page=queryresults
[0m15:42:26.986168 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:47ded172-3933-41ab-9cd3-8400dd9398a8&page=queryresults
[0m15:42:26.987213 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:47ded172-3933-41ab-9cd3-8400dd9398a8&page=queryresults
[0m15:42:26.995234 [debug] [Thread-1 (]: Database Error in test missing_aqi_measurements_daily_airnow_all_observations_analytics_ (models\airnow_analytics\schema.yml)
  Column 2 contains an aggregation function, which is not allowed in GROUP BY at [17:12]
  compiled Code at target\run\airnow_dbt\models\airnow_analytics\schema.yml\missing_aqi_measurements_daily_63d5d9517b82a46d71cb52e6c98fb32b.sql
[0m15:42:26.996213 [error] [Thread-1 (]: 1 of 2 ERROR missing_aqi_measurements_daily_airnow_all_observations_analytics_ . [[31mERROR[0m in 1.43s]
[0m15:42:26.996457 [debug] [Thread-1 (]: Finished running node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:42:27.773723 [error] [Thread-2 (]: 2 of 2 FAIL 1 missing_dates_airnow_all_observations_analytics_DateObserved ..... [[31mFAIL 1[0m in 2.20s]
[0m15:42:27.775631 [debug] [Thread-2 (]: Finished running node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:42:27.778623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:27.779629 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m15:42:27.779629 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m15:42:27.780617 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m15:42:27.781612 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m15:42:27.781612 [debug] [MainThread]: Connection 'test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419' was properly closed.
[0m15:42:27.782617 [debug] [MainThread]: Connection 'test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8' was properly closed.
[0m15:42:27.783613 [info ] [MainThread]: 
[0m15:42:27.783613 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m15:42:27.785600 [debug] [MainThread]: Command end result
[0m15:42:27.809740 [info ] [MainThread]: 
[0m15:42:27.810719 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:42:27.810719 [info ] [MainThread]: 
[0m15:42:27.811716 [error] [MainThread]:   Database Error in test missing_aqi_measurements_daily_airnow_all_observations_analytics_ (models\airnow_analytics\schema.yml)
  Column 2 contains an aggregation function, which is not allowed in GROUP BY at [17:12]
  compiled Code at target\run\airnow_dbt\models\airnow_analytics\schema.yml\missing_aqi_measurements_daily_63d5d9517b82a46d71cb52e6c98fb32b.sql
[0m15:42:27.811716 [info ] [MainThread]: 
[0m15:42:27.812713 [error] [MainThread]: [31mFailure in test missing_dates_airnow_all_observations_analytics_DateObserved (models\airnow_analytics\schema.yml)[0m
[0m15:42:27.812713 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:42:27.812713 [info ] [MainThread]: 
[0m15:42:27.812713 [info ] [MainThread]:   compiled code at target\compiled\airnow_dbt\models\airnow_analytics\schema.yml\missing_dates_airnow_all_observations_analytics_DateObserved.sql
[0m15:42:27.814218 [info ] [MainThread]: 
[0m15:42:27.814218 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:42:27.815219 [debug] [MainThread]: Command `cli test` failed at 15:42:27.815219 after 4.16 seconds
[0m15:42:27.815219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BE7EA0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201BE7E8E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C1875340>]}
[0m15:42:27.816216 [debug] [MainThread]: Flushing usage events
[0m15:42:51.874136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F3C57E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F2D98EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F5D82540>]}


============================== 15:42:51.880142 | 60ee66d4-fb69-4384-9d1e-c0c427082d13 ==============================
[0m15:42:51.880142 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:42:51.882137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:42:52.711179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60ee66d4-fb69-4384-9d1e-c0c427082d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2A1130B90>]}
[0m15:42:52.748208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60ee66d4-fb69-4384-9d1e-c0c427082d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2FF650B90>]}
[0m15:42:52.749314 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:42:52.755297 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m15:42:52.818314 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:42:52.819228 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m15:42:52.819228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '60ee66d4-fb69-4384-9d1e-c0c427082d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F5D00590>]}
[0m15:42:53.544680 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:42:53.545676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '60ee66d4-fb69-4384-9d1e-c0c427082d13', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2A10A04A0>]}
[0m15:42:53.763730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60ee66d4-fb69-4384-9d1e-c0c427082d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2A13FB3B0>]}
[0m15:42:53.844732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60ee66d4-fb69-4384-9d1e-c0c427082d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2A1541DC0>]}
[0m15:42:53.846404 [info ] [MainThread]: Found 7 models, 8 data tests, 2 sources, 476 macros
[0m15:42:53.846404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60ee66d4-fb69-4384-9d1e-c0c427082d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2A141B980>]}
[0m15:42:53.848408 [info ] [MainThread]: 
[0m15:42:53.848496 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:53.852484 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m15:42:53.852484 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m15:42:53.853486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:53.853486 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m15:42:53.854376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:53.854918 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m15:42:53.877523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:53.901105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:54.475461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60ee66d4-fb69-4384-9d1e-c0c427082d13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2A1559430>]}
[0m15:42:54.477452 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:42:54.478449 [info ] [MainThread]: 
[0m15:42:54.485424 [debug] [Thread-1 (]: Began running node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:42:54.486502 [debug] [Thread-2 (]: Began running node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:42:54.487414 [info ] [Thread-1 (]: 1 of 2 START test missing_aqi_measurements_daily_airnow_all_observations_analytics_  [RUN]
[0m15:42:54.488410 [info ] [Thread-2 (]: 2 of 2 START test missing_dates_airnow_all_observations_analytics_DateObserved . [RUN]
[0m15:42:54.489443 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419'
[0m15:42:54.491406 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8'
[0m15:42:54.492398 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:42:54.492398 [debug] [Thread-2 (]: Began compiling node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:42:54.501621 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419"
[0m15:42:54.505533 [debug] [Thread-2 (]: Writing injected SQL for node "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"
[0m15:42:54.506312 [debug] [Thread-2 (]: Began executing node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:42:54.507396 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:42:54.520362 [debug] [Thread-2 (]: Writing runtime sql for node "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"
[0m15:42:54.522919 [debug] [Thread-1 (]: Writing runtime sql for node "test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419"
[0m15:42:54.523969 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:42:54.523969 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:42:54.524987 [debug] [Thread-1 (]: On test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH observations_count AS (
    SELECT
        DateObserved,
        COUNTIF(ParameterName = 'PM2.5') AS pm25_count,
        COUNTIF(ParameterName = 'PM10') AS pm10_count,
        COUNTIF(ParameterName IN ('O3', 'OZONE')) AS o3_count
    FROM `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
    GROUP BY
        1
)

SELECT
    DateObserved,
    CASE
        WHEN pm25_count = 0 THEN 'PM2.5 is missing'
        WHEN pm10_count = 0 THEN 'PM10 is missing'
        WHEN o3_count = 0 THEN 'O3 is missing'
        ELSE 'All observations present'
    END AS missing_observation
FROM observations_count
WHERE
    pm25_count = 0 OR
    pm10_count = 0 OR
    o3_count = 0


      
    ) dbt_internal_test
[0m15:42:54.552117 [debug] [Thread-2 (]: On test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH date_spine AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_test`.`date_spine`
),

missing_dates AS (
    SELECT
        ds.date_day
    FROM
        date_spine ds
    LEFT JOIN (
        SELECT
            DISTINCT DATE(DateObserved) AS date_day
        FROM
            `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
    ) AS model_dates
    ON ds.date_day = model_dates.date_day
    WHERE model_dates.date_day IS NULL
)

SELECT *
FROM missing_dates


      
    ) dbt_internal_test
[0m15:42:55.172970 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:9c3ff5d9-d544-4098-9d46-a953434a4f4c&page=queryresults
[0m15:42:55.360328 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:f9fd23d5-0efa-41aa-b8c7-4b84718f1162&page=queryresults
[0m15:42:55.753667 [error] [Thread-2 (]: 2 of 2 FAIL 1 missing_dates_airnow_all_observations_analytics_DateObserved ..... [[31mFAIL 1[0m in 1.26s]
[0m15:42:55.754658 [debug] [Thread-2 (]: Finished running node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:42:55.938122 [error] [Thread-1 (]: 1 of 2 FAIL 409 missing_aqi_measurements_daily_airnow_all_observations_analytics_  [[31mFAIL 409[0m in 1.45s]
[0m15:42:55.940020 [debug] [Thread-1 (]: Finished running node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:42:55.943010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:55.944006 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m15:42:55.944006 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m15:42:55.945003 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m15:42:55.946157 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m15:42:55.946285 [debug] [MainThread]: Connection 'test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419' was properly closed.
[0m15:42:55.947291 [debug] [MainThread]: Connection 'test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8' was properly closed.
[0m15:42:55.947291 [info ] [MainThread]: 
[0m15:42:55.947291 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m15:42:55.949801 [debug] [MainThread]: Command end result
[0m15:42:55.973925 [info ] [MainThread]: 
[0m15:42:55.974921 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:42:55.974921 [info ] [MainThread]: 
[0m15:42:55.974921 [error] [MainThread]: [31mFailure in test missing_dates_airnow_all_observations_analytics_DateObserved (models\airnow_analytics\schema.yml)[0m
[0m15:42:55.975918 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:42:55.975918 [info ] [MainThread]: 
[0m15:42:55.975918 [info ] [MainThread]:   compiled code at target\compiled\airnow_dbt\models\airnow_analytics\schema.yml\missing_dates_airnow_all_observations_analytics_DateObserved.sql
[0m15:42:55.976914 [info ] [MainThread]: 
[0m15:42:55.976914 [error] [MainThread]: [31mFailure in test missing_aqi_measurements_daily_airnow_all_observations_analytics_ (models\airnow_analytics\schema.yml)[0m
[0m15:42:55.976914 [error] [MainThread]:   Got 409 results, configured to fail if != 0
[0m15:42:55.977911 [info ] [MainThread]: 
[0m15:42:55.977911 [info ] [MainThread]:   compiled code at target\compiled\airnow_dbt\models\airnow_analytics\schema.yml\missing_aqi_measurements_daily_63d5d9517b82a46d71cb52e6c98fb32b.sql
[0m15:42:55.977911 [info ] [MainThread]: 
[0m15:42:55.978908 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:42:55.979905 [debug] [MainThread]: Command `cli test` failed at 15:42:55.979905 after 4.26 seconds
[0m15:42:55.979905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F640A8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F5751910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2F5753650>]}
[0m15:42:55.980901 [debug] [MainThread]: Flushing usage events
[0m15:48:02.846337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE5A33DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE5A32270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE5A30BC0>]}


============================== 15:48:02.850524 | fde66020-600e-4218-946d-5e49165fc68a ==============================
[0m15:48:02.850524 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:48:02.851606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m15:48:03.683976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fde66020-600e-4218-946d-5e49165fc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AFE86F320>]}
[0m15:48:03.722003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fde66020-600e-4218-946d-5e49165fc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AFFE052E0>]}
[0m15:48:03.722003 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:48:03.728223 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m15:48:03.791630 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:48:03.792628 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m15:48:03.792628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fde66020-600e-4218-946d-5e49165fc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A91611A30>]}
[0m15:48:04.521706 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:48:04.521706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fde66020-600e-4218-946d-5e49165fc68a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A914EBE00>]}
[0m15:48:04.739738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fde66020-600e-4218-946d-5e49165fc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A918006E0>]}
[0m15:48:04.817225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fde66020-600e-4218-946d-5e49165fc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9165CB30>]}
[0m15:48:04.818222 [info ] [MainThread]: Found 7 models, 8 data tests, 2 sources, 476 macros
[0m15:48:04.818222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fde66020-600e-4218-946d-5e49165fc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A91754C80>]}
[0m15:48:04.819219 [info ] [MainThread]: 
[0m15:48:04.820215 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:48:04.823416 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m15:48:04.824413 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m15:48:04.824413 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m15:48:04.825409 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m15:48:04.825409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:04.825409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:04.826406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:04.826406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:05.407249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fde66020-600e-4218-946d-5e49165fc68a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A916D8080>]}
[0m15:48:05.408320 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:48:05.409339 [info ] [MainThread]: 
[0m15:48:05.415321 [debug] [Thread-1 (]: Began running node test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99
[0m15:48:05.416301 [info ] [Thread-1 (]: 1 of 1 START test missing_dates_airnow_hist_stage_DateObserved ................. [RUN]
[0m15:48:05.417291 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99'
[0m15:48:05.417291 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99
[0m15:48:05.425271 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99"
[0m15:48:05.427181 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99
[0m15:48:05.441134 [debug] [Thread-1 (]: Writing runtime sql for node "test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99"
[0m15:48:05.443492 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:48:05.445574 [debug] [Thread-1 (]: On test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH date_range AS (
    -- Dynamically calculate the minimum and maximum dates in the data
    SELECT
        MIN(DATE(DateObserved)) AS start_date,
        MAX(DATE(DateObserved)) AS end_date
    FROM
        `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
),

date_spine AS (
    -- Generate a date spine based on the calculated start and end dates
    SELECT
        start_date + INTERVAL n DAY AS date_day
    FROM
        date_range,
        UNNEST(GENERATE_ARRAY(0, DATE_DIFF(end_date, start_date, DAY))) AS n
),

missing_dates AS (
    -- Find the missing dates by performing a LEFT JOIN between the date spine and the actual data
    SELECT
        ds.date_day
    FROM
        date_spine ds
    LEFT JOIN (
        SELECT DISTINCT DATE(DateObserved) AS date_day
        FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
    ) AS model_dates
    ON ds.date_day = model_dates.date_day
    WHERE model_dates.date_day IS NULL
)

-- Return the missing dates
SELECT *
FROM missing_dates;


      
    ) dbt_internal_test
[0m15:48:05.872865 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:e48211a9-dc3f-4c82-a4b3-6b62bd645ed7&page=queryresults
[0m15:48:05.872865 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [43:19]; reason: invalidQuery, location: query, message: Syntax error: Expected ")" but got ";" at [43:19]')
[0m15:48:06.720273 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:980f0b72-f608-400d-8aee-208f257f7420&page=queryresults
[0m15:48:06.722314 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:980f0b72-f608-400d-8aee-208f257f7420&page=queryresults
[0m15:48:06.732308 [debug] [Thread-1 (]: Database Error in test missing_dates_airnow_hist_stage_DateObserved (models\airnow_staging\schema.yml)
  Syntax error: Expected ")" but got ";" at [43:19]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\schema.yml\missing_dates_airnow_hist_stage_DateObserved.sql
[0m15:48:06.733315 [error] [Thread-1 (]: 1 of 1 ERROR missing_dates_airnow_hist_stage_DateObserved ...................... [[31mERROR[0m in 1.32s]
[0m15:48:06.734230 [debug] [Thread-1 (]: Finished running node test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99
[0m15:48:06.737216 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:06.737216 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m15:48:06.738213 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m15:48:06.738213 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m15:48:06.739209 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m15:48:06.739209 [debug] [MainThread]: Connection 'test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99' was properly closed.
[0m15:48:06.740207 [info ] [MainThread]: 
[0m15:48:06.740207 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m15:48:06.741203 [debug] [MainThread]: Command end result
[0m15:48:06.765853 [info ] [MainThread]: 
[0m15:48:06.765853 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:48:06.766888 [info ] [MainThread]: 
[0m15:48:06.766888 [error] [MainThread]:   Database Error in test missing_dates_airnow_hist_stage_DateObserved (models\airnow_staging\schema.yml)
  Syntax error: Expected ")" but got ";" at [43:19]
  compiled Code at target\run\airnow_dbt\models\airnow_staging\schema.yml\missing_dates_airnow_hist_stage_DateObserved.sql
[0m15:48:06.766888 [info ] [MainThread]: 
[0m15:48:06.767850 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:48:06.767850 [debug] [MainThread]: Command `cli test` failed at 15:48:06.767850 after 4.08 seconds
[0m15:48:06.768857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE6925520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE6A82BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020AE30A8EF0>]}
[0m15:48:06.768857 [debug] [MainThread]: Flushing usage events
[0m15:48:20.455165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBAA389B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECB8E9BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECB7B30EF0>]}


============================== 15:48:20.458217 | 50b6201d-ea90-43ae-9405-dab5ce1058da ==============================
[0m15:48:20.458217 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:48:20.459212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:21.305751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50b6201d-ea90-43ae-9405-dab5ce1058da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBAA38E90>]}
[0m15:48:21.344830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50b6201d-ea90-43ae-9405-dab5ce1058da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE4A228D0>]}
[0m15:48:21.349155 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:48:21.355134 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m15:48:21.420916 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:48:21.421915 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m15:48:21.421915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '50b6201d-ea90-43ae-9405-dab5ce1058da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBB9F8740>]}
[0m15:48:22.149368 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:48:22.149368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '50b6201d-ea90-43ae-9405-dab5ce1058da', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE62232C0>]}
[0m15:48:22.370485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50b6201d-ea90-43ae-9405-dab5ce1058da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE6720E30>]}
[0m15:48:22.451275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50b6201d-ea90-43ae-9405-dab5ce1058da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE6719D60>]}
[0m15:48:22.452261 [info ] [MainThread]: Found 7 models, 8 data tests, 2 sources, 476 macros
[0m15:48:22.452261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50b6201d-ea90-43ae-9405-dab5ce1058da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE6614B30>]}
[0m15:48:22.453259 [info ] [MainThread]: 
[0m15:48:22.454267 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:48:22.457253 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m15:48:22.458557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:22.458557 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m15:48:22.459360 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m15:48:22.460359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:22.460359 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m15:48:22.483667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:22.508762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:23.035876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50b6201d-ea90-43ae-9405-dab5ce1058da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECE698BA40>]}
[0m15:48:23.036911 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:48:23.037903 [info ] [MainThread]: 
[0m15:48:23.047118 [debug] [Thread-1 (]: Began running node test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99
[0m15:48:23.048357 [info ] [Thread-1 (]: 1 of 1 START test missing_dates_airnow_hist_stage_DateObserved ................. [RUN]
[0m15:48:23.049353 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99'
[0m15:48:23.050353 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99
[0m15:48:23.061001 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99"
[0m15:48:23.061997 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99
[0m15:48:23.077132 [debug] [Thread-1 (]: Writing runtime sql for node "test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99"
[0m15:48:23.078130 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:48:23.079118 [debug] [Thread-1 (]: On test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH date_range AS (
    -- Dynamically calculate the minimum and maximum dates in the data
    SELECT
        MIN(DATE(DateObserved)) AS start_date,
        MAX(DATE(DateObserved)) AS end_date
    FROM
        `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
),

date_spine AS (
    -- Generate a date spine based on the calculated start and end dates
    SELECT
        start_date + INTERVAL n DAY AS date_day
    FROM
        date_range,
        UNNEST(GENERATE_ARRAY(0, DATE_DIFF(end_date, start_date, DAY))) AS n
),

missing_dates AS (
    -- Find the missing dates by performing a LEFT JOIN between the date spine and the actual data
    SELECT
        ds.date_day
    FROM
        date_spine ds
    LEFT JOIN (
        SELECT DISTINCT DATE(DateObserved) AS date_day
        FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
    ) AS model_dates
    ON ds.date_day = model_dates.date_day
    WHERE model_dates.date_day IS NULL
)

-- Return the missing dates
SELECT *
FROM missing_dates


      
    ) dbt_internal_test
[0m15:48:24.179611 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:c8b96391-30ec-4dc7-9a40-25e02f131dac&page=queryresults
[0m15:48:24.783784 [error] [Thread-1 (]: 1 of 1 FAIL 1 missing_dates_airnow_hist_stage_DateObserved ..................... [[31mFAIL 1[0m in 1.73s]
[0m15:48:24.785778 [debug] [Thread-1 (]: Finished running node test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99
[0m15:48:24.787798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:24.787798 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m15:48:24.788873 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m15:48:24.788873 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m15:48:24.790173 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m15:48:24.790173 [debug] [MainThread]: Connection 'test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99' was properly closed.
[0m15:48:24.791176 [info ] [MainThread]: 
[0m15:48:24.792172 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m15:48:24.793168 [debug] [MainThread]: Command end result
[0m15:48:24.817090 [info ] [MainThread]: 
[0m15:48:24.817090 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:48:24.818088 [info ] [MainThread]: 
[0m15:48:24.818088 [error] [MainThread]: [31mFailure in test missing_dates_airnow_hist_stage_DateObserved (models\airnow_staging\schema.yml)[0m
[0m15:48:24.819083 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:48:24.819083 [info ] [MainThread]: 
[0m15:48:24.819083 [info ] [MainThread]:   compiled code at target\compiled\airnow_dbt\models\airnow_staging\schema.yml\missing_dates_airnow_hist_stage_DateObserved.sql
[0m15:48:24.820080 [info ] [MainThread]: 
[0m15:48:24.820080 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:48:24.821255 [debug] [MainThread]: Command `cli test` failed at 15:48:24.821255 after 4.50 seconds
[0m15:48:24.821255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBB64A840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBB9B1A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECBAA389B0>]}
[0m15:48:24.822253 [debug] [MainThread]: Flushing usage events
[0m15:48:42.377692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6B4E7E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6DBD3CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6DBD3830>]}


============================== 15:48:42.384672 | 4907066e-2999-483c-8bda-19a87bfcd818 ==============================
[0m15:48:42.384672 [info ] [MainThread]: Running with dbt=1.8.6
[0m15:48:42.385669 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:43.213407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4907066e-2999-483c-8bda-19a87bfcd818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1720E060>]}
[0m15:48:43.251023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4907066e-2999-483c-8bda-19a87bfcd818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1699CEF0>]}
[0m15:48:43.252020 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m15:48:43.258000 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m15:48:43.379126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:43.380226 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:43.409813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4907066e-2999-483c-8bda-19a87bfcd818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6E001AF0>]}
[0m15:48:43.490399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4907066e-2999-483c-8bda-19a87bfcd818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB1829EFC0>]}
[0m15:48:43.490399 [info ] [MainThread]: Found 7 models, 8 data tests, 2 sources, 476 macros
[0m15:48:43.491395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4907066e-2999-483c-8bda-19a87bfcd818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB18953E30>]}
[0m15:48:43.492393 [info ] [MainThread]: 
[0m15:48:43.492393 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:48:43.496580 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m15:48:43.496580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:43.497576 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m15:48:43.497576 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m15:48:43.498979 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m15:48:43.499565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:43.522719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:43.523680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:44.117335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4907066e-2999-483c-8bda-19a87bfcd818', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB16F326F0>]}
[0m15:48:44.118327 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:48:44.119324 [info ] [MainThread]: 
[0m15:48:44.125622 [debug] [Thread-1 (]: Began running node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:48:44.126621 [debug] [Thread-2 (]: Began running node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:48:44.127617 [info ] [Thread-1 (]: 1 of 2 START test missing_aqi_measurements_daily_airnow_all_observations_analytics_  [RUN]
[0m15:48:44.128619 [info ] [Thread-2 (]: 2 of 2 START test missing_dates_airnow_all_observations_analytics_DateObserved . [RUN]
[0m15:48:44.129619 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419'
[0m15:48:44.130623 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8'
[0m15:48:44.131612 [debug] [Thread-1 (]: Began compiling node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:48:44.132610 [debug] [Thread-2 (]: Began compiling node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:48:44.146018 [debug] [Thread-1 (]: Writing injected SQL for node "test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419"
[0m15:48:44.151002 [debug] [Thread-2 (]: Writing injected SQL for node "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"
[0m15:48:44.151991 [debug] [Thread-1 (]: Began executing node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:48:44.166942 [debug] [Thread-1 (]: Writing runtime sql for node "test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419"
[0m15:48:44.167939 [debug] [Thread-2 (]: Began executing node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:48:44.170016 [debug] [Thread-2 (]: Writing runtime sql for node "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"
[0m15:48:44.170273 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:48:44.171271 [debug] [Thread-1 (]: On test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH observations_count AS (
    SELECT
        DateObserved,
        COUNTIF(ParameterName = 'PM2.5') AS pm25_count,
        COUNTIF(ParameterName = 'PM10') AS pm10_count,
        COUNTIF(ParameterName IN ('O3', 'OZONE')) AS o3_count
    FROM `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
    GROUP BY
        1
)

SELECT
    DateObserved,
    CASE
        WHEN pm25_count = 0 THEN 'PM2.5 is missing'
        WHEN pm10_count = 0 THEN 'PM10 is missing'
        WHEN o3_count = 0 THEN 'O3 is missing'
        ELSE 'All observations present'
    END AS missing_observation
FROM observations_count
WHERE
    pm25_count = 0 OR
    pm10_count = 0 OR
    o3_count = 0


      
    ) dbt_internal_test
[0m15:48:44.172268 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:48:44.196365 [debug] [Thread-2 (]: On test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

WITH date_range AS (
    -- Dynamically calculate the minimum and maximum dates in the data
    SELECT
        MIN(DATE(DateObserved)) AS start_date,
        MAX(DATE(DateObserved)) AS end_date
    FROM
        `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
),

date_spine AS (
    -- Generate a date spine based on the calculated start and end dates
    SELECT
        start_date + INTERVAL n DAY AS date_day
    FROM
        date_range,
        UNNEST(GENERATE_ARRAY(0, DATE_DIFF(end_date, start_date, DAY))) AS n
),

missing_dates AS (
    -- Find the missing dates by performing a LEFT JOIN between the date spine and the actual data
    SELECT
        ds.date_day
    FROM
        date_spine ds
    LEFT JOIN (
        SELECT DISTINCT DATE(DateObserved) AS date_day
        FROM `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
    ) AS model_dates
    ON ds.date_day = model_dates.date_day
    WHERE model_dates.date_day IS NULL
)

-- Return the missing dates
SELECT *
FROM missing_dates


      
    ) dbt_internal_test
[0m15:48:44.929067 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:cad63adc-7e5e-471a-af9d-5cce38bde014&page=queryresults
[0m15:48:45.190056 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:200a42ad-2dc1-4024-9768-e561cf173726&page=queryresults
[0m15:48:45.656935 [error] [Thread-1 (]: 1 of 2 FAIL 409 missing_aqi_measurements_daily_airnow_all_observations_analytics_  [[31mFAIL 409[0m in 1.53s]
[0m15:48:45.658988 [debug] [Thread-1 (]: Finished running node test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419
[0m15:48:45.859480 [error] [Thread-2 (]: 2 of 2 FAIL 30 missing_dates_airnow_all_observations_analytics_DateObserved .... [[31mFAIL 30[0m in 1.73s]
[0m15:48:45.861391 [debug] [Thread-2 (]: Finished running node test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8
[0m15:48:45.863430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:45.864456 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m15:48:45.865452 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m15:48:45.865452 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m15:48:45.866468 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m15:48:45.867457 [debug] [MainThread]: Connection 'test.airnow_dbt.missing_aqi_measurements_daily_airnow_all_observations_analytics_.0c309a8419' was properly closed.
[0m15:48:45.867457 [debug] [MainThread]: Connection 'test.airnow_dbt.missing_dates_airnow_all_observations_analytics_DateObserved.cc0dc1caa8' was properly closed.
[0m15:48:45.868448 [info ] [MainThread]: 
[0m15:48:45.869447 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m15:48:45.870616 [debug] [MainThread]: Command end result
[0m15:48:45.895682 [info ] [MainThread]: 
[0m15:48:45.895682 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:48:45.896679 [info ] [MainThread]: 
[0m15:48:45.896679 [error] [MainThread]: [31mFailure in test missing_aqi_measurements_daily_airnow_all_observations_analytics_ (models\airnow_analytics\schema.yml)[0m
[0m15:48:45.897675 [error] [MainThread]:   Got 409 results, configured to fail if != 0
[0m15:48:45.897675 [info ] [MainThread]: 
[0m15:48:45.897675 [info ] [MainThread]:   compiled code at target\compiled\airnow_dbt\models\airnow_analytics\schema.yml\missing_aqi_measurements_daily_63d5d9517b82a46d71cb52e6c98fb32b.sql
[0m15:48:45.898672 [info ] [MainThread]: 
[0m15:48:45.898733 [error] [MainThread]: [31mFailure in test missing_dates_airnow_all_observations_analytics_DateObserved (models\airnow_analytics\schema.yml)[0m
[0m15:48:45.898733 [error] [MainThread]:   Got 30 results, configured to fail if != 0
[0m15:48:45.898733 [info ] [MainThread]: 
[0m15:48:45.899730 [info ] [MainThread]:   compiled code at target\compiled\airnow_dbt\models\airnow_analytics\schema.yml\missing_dates_airnow_all_observations_analytics_DateObserved.sql
[0m15:48:45.899730 [info ] [MainThread]: 
[0m15:48:45.899730 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:48:45.900727 [debug] [MainThread]: Command `cli test` failed at 15:48:45.900727 after 3.68 seconds
[0m15:48:45.901733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6D4DD580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6DEA7D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB6DEA5430>]}
[0m15:48:45.901733 [debug] [MainThread]: Flushing usage events
[0m19:14:38.423334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589AA55760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589E352FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589EA4F770>]}


============================== 19:14:38.423334 | 61dc5764-9aac-4008-993a-852a7fd6bce6 ==============================
[0m19:14:38.423334 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:14:38.423334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:14:39.572095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61dc5764-9aac-4008-993a-852a7fd6bce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C94DB8F0>]}
[0m19:14:39.615198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61dc5764-9aac-4008-993a-852a7fd6bce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C7C84EF0>]}
[0m19:14:39.615198 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m19:14:39.622178 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m19:14:39.689423 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:14:39.689423 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m19:14:39.689423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '61dc5764-9aac-4008-993a-852a7fd6bce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C9835610>]}
[0m19:14:40.455641 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:14:40.455641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '61dc5764-9aac-4008-993a-852a7fd6bce6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C97066C0>]}
[0m19:14:40.688548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61dc5764-9aac-4008-993a-852a7fd6bce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C947E750>]}
[0m19:14:40.772693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61dc5764-9aac-4008-993a-852a7fd6bce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C998B500>]}
[0m19:14:40.772693 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 476 macros
[0m19:14:40.772693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61dc5764-9aac-4008-993a-852a7fd6bce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C9906840>]}
[0m19:14:40.772693 [info ] [MainThread]: 
[0m19:14:40.772693 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:14:40.772693 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m19:14:40.772693 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:41.439528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_key-polymer-434418-m6, now create_key-polymer-434418-m6_airnow)
[0m19:14:41.439528 [debug] [ThreadPool]: Creating schema "database: "key-polymer-434418-m6"
schema: "airnow"
"
[0m19:14:41.454895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:41.454895 [debug] [ThreadPool]: On create_key-polymer-434418-m6_airnow: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "connection_name": "create_key-polymer-434418-m6_airnow"} */
create schema if not exists `key-polymer-434418-m6`.`airnow`
  
[0m19:14:42.155285 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:8a2405cb-43ce-428c-9b0f-08b6230a93e7&page=queryresults
[0m19:14:42.990187 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m19:14:42.991430 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m19:14:42.992649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:42.993775 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m19:14:42.994973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:42.996188 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m19:14:43.021328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:43.048908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:44.106320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61dc5764-9aac-4008-993a-852a7fd6bce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C9AF8CB0>]}
[0m19:14:44.118901 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:14:44.118901 [info ] [MainThread]: 
[0m19:14:44.120407 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_realtime_analytics
[0m19:14:44.120407 [info ] [Thread-1 (]: 1 of 1 START sql view model airnow.airnow_realtime_analytics ................... [RUN]
[0m19:14:44.120407 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_realtime_analytics'
[0m19:14:44.120407 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_realtime_analytics
[0m19:14:44.127883 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_realtime_analytics"
[0m19:14:44.135885 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_realtime_analytics
[0m19:14:44.153561 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_realtime_analytics"
[0m19:14:44.155592 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:14:44.155592 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_realtime_analytics: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_realtime_analytics"} */


  create or replace view `key-polymer-434418-m6`.`airnow`.`airnow_realtime_analytics`
  OPTIONS()
  as /*** AirNow Real-time Analytics Model ***/
/**
Model selects everything from the 'airnow_realtime_staging' table. This model/table will serve as the data source for the air quality notification script.
**/

WITH airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
)

SELECT * FROM airnow_realtime_source;


[0m19:14:45.071132 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:b1b74fe4-42aa-4704-b26e-9fc224d44a82&page=queryresults
[0m19:14:45.748683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61dc5764-9aac-4008-993a-852a7fd6bce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258C7BEE180>]}
[0m19:14:45.753054 [info ] [Thread-1 (]: 1 of 1 OK created sql view model airnow.airnow_realtime_analytics .............. [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m19:14:45.753054 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_realtime_analytics
[0m19:14:45.753054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:45.753054 [debug] [MainThread]: Connection 'create_key-polymer-434418-m6_airnow' was properly closed.
[0m19:14:45.753054 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m19:14:45.753054 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m19:14:45.753054 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m19:14:45.753054 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m19:14:45.753054 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_realtime_analytics' was properly closed.
[0m19:14:45.753054 [info ] [MainThread]: 
[0m19:14:45.753054 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.98 seconds (4.98s).
[0m19:14:45.760673 [debug] [MainThread]: Command end result
[0m19:14:45.785835 [info ] [MainThread]: 
[0m19:14:45.785835 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:45.785835 [info ] [MainThread]: 
[0m19:14:45.785835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:14:45.785835 [debug] [MainThread]: Command `cli run` succeeded at 19:14:45.785835 after 7.52 seconds
[0m19:14:45.785835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589E48DD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589B349190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002589DCD2B10>]}
[0m19:14:45.785835 [debug] [MainThread]: Flushing usage events
[0m19:15:46.863610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001432728A0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014324B82A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143272266F0>]}


============================== 19:15:46.880524 | 4cf8c0de-dc1a-48fe-91bf-df2594d40406 ==============================
[0m19:15:46.880524 [info ] [MainThread]: Running with dbt=1.8.6
[0m19:15:46.880524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:15:47.762876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cf8c0de-dc1a-48fe-91bf-df2594d40406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014350AE45C0>]}
[0m19:15:47.796192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cf8c0de-dc1a-48fe-91bf-df2594d40406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143522D52B0>]}
[0m19:15:47.796192 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m19:15:47.812959 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m19:15:47.880168 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:15:47.880168 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m19:15:47.880168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4cf8c0de-dc1a-48fe-91bf-df2594d40406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014352691CA0>]}
[0m19:15:48.646622 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m19:15:48.646622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4cf8c0de-dc1a-48fe-91bf-df2594d40406', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143525DC7D0>]}
[0m19:15:48.862777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cf8c0de-dc1a-48fe-91bf-df2594d40406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143528D8AD0>]}
[0m19:15:48.946004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cf8c0de-dc1a-48fe-91bf-df2594d40406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143527E8560>]}
[0m19:15:48.946004 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 476 macros
[0m19:15:48.946004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cf8c0de-dc1a-48fe-91bf-df2594d40406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143527664E0>]}
[0m19:15:48.946004 [info ] [MainThread]: 
[0m19:15:48.946004 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:15:48.946004 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m19:15:48.946004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:49.445791 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m19:15:49.445791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:49.465068 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m19:15:49.473155 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m19:15:49.473155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:49.473155 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m19:15:49.473155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:49.495531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:50.062591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cf8c0de-dc1a-48fe-91bf-df2594d40406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014352947350>]}
[0m19:15:50.062591 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:15:50.062591 [info ] [MainThread]: 
[0m19:15:50.072596 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_realtime_analytics
[0m19:15:50.072596 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_analytics.airnow_realtime_analytics ........ [RUN]
[0m19:15:50.096313 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_realtime_analytics'
[0m19:15:50.096313 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_realtime_analytics
[0m19:15:50.104317 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_realtime_analytics"
[0m19:15:50.104317 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_realtime_analytics
[0m19:15:50.122070 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_realtime_analytics"
[0m19:15:50.122070 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:15:50.122070 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_realtime_analytics: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_realtime_analytics"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_analytics`.`airnow_realtime_analytics`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Real-time Analytics Model ***/
/**
Model selects everything from the 'airnow_realtime_staging' table. This model/table will serve as the data source for the air quality notification script.
**/



WITH airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
)

SELECT * FROM airnow_realtime_source
    );
  
[0m19:15:50.851370 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:0c9bd8cb-19da-4a87-8480-6c9a5e8d152b&page=queryresults
[0m19:15:53.273026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cf8c0de-dc1a-48fe-91bf-df2594d40406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143527E9B20>]}
[0m19:15:53.273026 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_analytics.airnow_realtime_analytics ... [[32mCREATE TABLE (319.0 rows, 32.0 KiB processed)[0m in 3.18s]
[0m19:15:53.273026 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_realtime_analytics
[0m19:15:53.273026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:53.273026 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m19:15:53.273026 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m19:15:53.273026 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m19:15:53.273026 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m19:15:53.273026 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m19:15:53.273026 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_realtime_analytics' was properly closed.
[0m19:15:53.273026 [info ] [MainThread]: 
[0m19:15:53.273026 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m19:15:53.273026 [debug] [MainThread]: Command end result
[0m19:15:53.299002 [info ] [MainThread]: 
[0m19:15:53.299002 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:53.306550 [info ] [MainThread]: 
[0m19:15:53.306550 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:15:53.306550 [debug] [MainThread]: Command `cli run` succeeded at 19:15:53.306550 after 6.57 seconds
[0m19:15:53.306550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014327A20200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014327A217F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143278C5CA0>]}
[0m19:15:53.306550 [debug] [MainThread]: Flushing usage events
[0m18:53:47.935851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CCE217FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CCFC7FBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CCFC7DCD0>]}


============================== 18:53:47.940864 | b35f1f60-43a6-4102-95d5-c51424b9904b ==============================
[0m18:53:47.940864 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:53:47.940864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m18:53:49.140356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b35f1f60-43a6-4102-95d5-c51424b9904b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD0D32BA0>]}
[0m18:53:49.172479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b35f1f60-43a6-4102-95d5-c51424b9904b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CCE7E93A0>]}
[0m18:53:49.172479 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:53:49.189970 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:53:49.264866 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:53:49.264866 [debug] [MainThread]: previous checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, current checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887
[0m18:53:49.264866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b35f1f60-43a6-4102-95d5-c51424b9904b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFB8559A0>]}
[0m18:53:50.100267 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:53:50.100267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b35f1f60-43a6-4102-95d5-c51424b9904b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD044FF20>]}
[0m18:53:50.372682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b35f1f60-43a6-4102-95d5-c51424b9904b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFBAA30E0>]}
[0m18:53:50.456100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b35f1f60-43a6-4102-95d5-c51424b9904b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFBAA10A0>]}
[0m18:53:50.456100 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 476 macros
[0m18:53:50.456100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b35f1f60-43a6-4102-95d5-c51424b9904b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFB77ED50>]}
[0m18:53:50.456100 [info ] [MainThread]: 
[0m18:53:50.456100 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:53:50.456100 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m18:53:50.456100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:50.991602 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m18:53:50.991602 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m18:53:50.991602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:50.991602 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m18:53:50.991602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:50.991602 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m18:53:50.991602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:51.018769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:51.505725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b35f1f60-43a6-4102-95d5-c51424b9904b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CFB9105C0>]}
[0m18:53:51.505725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:53:51.505725 [info ] [MainThread]: 
[0m18:53:51.526024 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m18:53:51.526024 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_hist_stage .................. [RUN]
[0m18:53:51.528469 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m18:53:51.528469 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m18:53:51.528469 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m18:53:51.536478 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m18:53:51.542288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:53:52.005393 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m18:53:52.022106 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Historical Observations Staging Model ***/
/**
The below model converts all columns, except for 'DateObserved,' to the correct data type. 'DateObserved' is already
a TIMESTAMP data type.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT 
    * 
FROM airnow_hist_final
    );
  
[0m18:53:52.588593 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:e44aa14b-4e65-4eee-bc89-dbf8e4e188e2&page=queryresults
[0m18:53:56.786625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b35f1f60-43a6-4102-95d5-c51424b9904b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CF9C12510>]}
[0m18:53:56.786625 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_hist_stage ............. [[32mCREATE TABLE (5.9k rows, 573.9 KiB processed)[0m in 5.25s]
[0m18:53:56.786625 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m18:53:56.786625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:56.786625 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m18:53:56.786625 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m18:53:56.786625 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m18:53:56.786625 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m18:53:56.786625 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m18:53:56.786625 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m18:53:56.786625 [info ] [MainThread]: 
[0m18:53:56.786625 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 6.33 seconds (6.33s).
[0m18:53:56.794650 [debug] [MainThread]: Command end result
[0m18:53:56.819595 [info ] [MainThread]: 
[0m18:53:56.819595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:56.819595 [info ] [MainThread]: 
[0m18:53:56.819595 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:53:56.819595 [debug] [MainThread]: Command `cli run` succeeded at 18:53:56.819595 after 9.06 seconds
[0m18:53:56.823977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD051B050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD0D32C60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012CD0BB03E0>]}
[0m18:53:56.823977 [debug] [MainThread]: Flushing usage events
[0m18:54:04.342552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9A57A600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9C57DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9C57DB50>]}


============================== 18:54:05.084322 | 7fd63108-9f0f-454e-ae27-69d04473d247 ==============================
[0m18:54:05.084322 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:54:05.084322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:54:06.092852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fd63108-9f0f-454e-ae27-69d04473d247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9CD8B890>]}
[0m18:54:06.141697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fd63108-9f0f-454e-ae27-69d04473d247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9A919280>]}
[0m18:54:06.141697 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:54:06.155913 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:54:06.293058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:06.293058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:06.325419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fd63108-9f0f-454e-ae27-69d04473d247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC77D2BD0>]}
[0m18:54:06.418249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fd63108-9f0f-454e-ae27-69d04473d247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC7A8E300>]}
[0m18:54:06.418249 [info ] [MainThread]: Found 8 models, 8 data tests, 2 sources, 476 macros
[0m18:54:06.418249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fd63108-9f0f-454e-ae27-69d04473d247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC7A74200>]}
[0m18:54:06.418249 [info ] [MainThread]: 
[0m18:54:06.418249 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:54:06.418249 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m18:54:06.418249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:06.883587 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m18:54:06.883587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:06.883587 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_test'
[0m18:54:06.883587 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m18:54:06.883587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:06.883587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:06.908530 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m18:54:06.958780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:07.391325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fd63108-9f0f-454e-ae27-69d04473d247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC77D1AF0>]}
[0m18:54:07.391325 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:54:07.391325 [info ] [MainThread]: 
[0m18:54:07.408374 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_realtime_stage
[0m18:54:07.408374 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_realtime_stage .............. [RUN]
[0m18:54:07.408374 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_realtime_stage'
[0m18:54:07.410487 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_realtime_stage
[0m18:54:07.414994 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_realtime_stage"
[0m18:54:07.414994 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_realtime_stage
[0m18:54:07.429264 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:54:08.074208 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_realtime_stage"
[0m18:54:08.083215 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_realtime_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_realtime_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Real-time Observations Staging Model ***/
/**
The below model converts all columns, except for 'DataPulledAt' and 'DateObserved,' to the correct data type.
'DataPulledAt' and 'DateObserverd' are already TIMESTAMP data types.
**/



WITH airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_raw_realtime`
),

airnow_realtime_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_realtime_source
),

airnow_realtime_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        AVG(Latitude_update) AS Latitude,
        AVG(Longitude_update) AS Longitude,
        ParameterName,
        AVG(AQI_update) AS AQI,
        AQICategory,
        AVG(AQICategoryNumber) AS AQICategoryNumber
    FROM airnow_realtime_update
    GROUP BY
        DateObserved,
        HourObserved_update,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName,
        AQICategory
        
)

SELECT
    *
FROM airnow_realtime_final
    );
  
[0m18:54:08.775693 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:2b52feb1-e05c-4f78-9d4c-6c5514742fad&page=queryresults
[0m18:54:10.935768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fd63108-9f0f-454e-ae27-69d04473d247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022CC5D321B0>]}
[0m18:54:10.936282 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_realtime_stage ......... [[32mCREATE TABLE (522.0 rows, 93.5 KiB processed)[0m in 3.53s]
[0m18:54:10.936797 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_realtime_stage
[0m18:54:10.937311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:10.937311 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m18:54:10.937311 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m18:54:10.939503 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_test' was properly closed.
[0m18:54:10.939503 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m18:54:10.939503 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m18:54:10.939503 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_realtime_stage' was properly closed.
[0m18:54:10.939503 [info ] [MainThread]: 
[0m18:54:10.939503 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m18:54:10.939503 [debug] [MainThread]: Command end result
[0m18:54:10.959946 [info ] [MainThread]: 
[0m18:54:10.959946 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:54:10.959946 [info ] [MainThread]: 
[0m18:54:10.959946 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:54:10.959946 [debug] [MainThread]: Command `cli run` succeeded at 18:54:10.959946 after 6.77 seconds
[0m18:54:10.959946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9C1CDD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9C0E7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C9CD44AD0>]}
[0m18:54:10.959946 [debug] [MainThread]: Flushing usage events
[0m18:54:43.408024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9A76BA720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9A92CD370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9A92CD8B0>]}


============================== 18:54:43.408024 | 0ccdb425-f184-4263-ae3b-5d539303dd46 ==============================
[0m18:54:43.408024 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:54:43.408024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:54:44.524372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ccdb425-f184-4263-ae3b-5d539303dd46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D473CC80>]}
[0m18:54:44.575212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ccdb425-f184-4263-ae3b-5d539303dd46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9AA8D4470>]}
[0m18:54:44.575212 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:54:44.575212 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:54:44.724017 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m18:54:44.724017 [debug] [MainThread]: Partial parsing: deleted file: airnow_dbt://models\airnow_staging\date_spine.sql
[0m18:54:44.724017 [debug] [MainThread]: Partial parsing: deleted file: airnow_dbt://models\airnow_staging\airnow_test_model.sql
[0m18:54:44.790893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ccdb425-f184-4263-ae3b-5d539303dd46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D48DFE00>]}
[0m18:54:44.869543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ccdb425-f184-4263-ae3b-5d539303dd46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D49DD5B0>]}
[0m18:54:44.869543 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 476 macros
[0m18:54:44.873285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ccdb425-f184-4263-ae3b-5d539303dd46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D48DF890>]}
[0m18:54:44.873744 [info ] [MainThread]: 
[0m18:54:44.873744 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:54:44.873744 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m18:54:44.873744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:45.440736 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m18:54:45.440736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:45.440736 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m18:54:45.440736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:45.467021 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m18:54:45.467021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:45.941801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ccdb425-f184-4263-ae3b-5d539303dd46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D49DE210>]}
[0m18:54:45.941801 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:54:45.941801 [info ] [MainThread]: 
[0m18:54:45.957041 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_realtime_stage
[0m18:54:45.957041 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_realtime_stage .............. [RUN]
[0m18:54:45.957041 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_realtime_stage'
[0m18:54:45.968056 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_realtime_stage
[0m18:54:45.978229 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_realtime_stage"
[0m18:54:45.978229 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_realtime_stage
[0m18:54:45.989730 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:54:46.423495 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_realtime_stage"
[0m18:54:46.423495 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_realtime_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_realtime_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Real-time Observations Staging Model ***/
/**
The below model converts all columns, except for 'DataPulledAt' and 'DateObserved,' to the correct data type.
'DataPulledAt' and 'DateObserverd' are already TIMESTAMP data types.
**/



WITH airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_raw_realtime`
),

airnow_realtime_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_realtime_source
),

airnow_realtime_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        AVG(Latitude_update) AS Latitude,
        AVG(Longitude_update) AS Longitude,
        ParameterName,
        AVG(AQI_update) AS AQI,
        AQICategory,
        AVG(AQICategoryNumber) AS AQICategoryNumber
    FROM airnow_realtime_update
    GROUP BY
        DateObserved,
        HourObserved_update,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName,
        AQICategory
        
)

SELECT
    *
FROM airnow_realtime_final
    );
  
[0m18:54:47.083113 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:25f2a6a2-165e-4ef5-a80d-1e27b9bb59b2&page=queryresults
[0m18:54:49.448054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ccdb425-f184-4263-ae3b-5d539303dd46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9D292CB00>]}
[0m18:54:49.448054 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_realtime_stage ......... [[32mCREATE TABLE (522.0 rows, 93.5 KiB processed)[0m in 3.49s]
[0m18:54:49.448054 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_realtime_stage
[0m18:54:49.448054 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:49.448054 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m18:54:49.448054 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m18:54:49.448054 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m18:54:49.448054 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m18:54:49.448054 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_realtime_stage' was properly closed.
[0m18:54:49.448054 [info ] [MainThread]: 
[0m18:54:49.448054 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m18:54:49.455059 [debug] [MainThread]: Command end result
[0m18:54:49.475991 [info ] [MainThread]: 
[0m18:54:49.475991 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:54:49.475991 [info ] [MainThread]: 
[0m18:54:49.475991 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:54:49.475991 [debug] [MainThread]: Command `cli run` succeeded at 18:54:49.475991 after 6.22 seconds
[0m18:54:49.475991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9A93C79B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9A93C4530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9A93C5130>]}
[0m18:54:49.475991 [debug] [MainThread]: Flushing usage events
[0m18:56:19.935881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EC08C860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EC12AFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EBB86420>]}


============================== 18:56:19.935881 | 0f0c61c8-69a7-4a52-996f-b1586cc8689a ==============================
[0m18:56:19.935881 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:56:19.935881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:56:21.003691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f0c61c8-69a7-4a52-996f-b1586cc8689a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170FFECFA10>]}
[0m18:56:21.043871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f0c61c8-69a7-4a52-996f-b1586cc8689a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170FFDFFFE0>]}
[0m18:56:21.043871 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:56:21.043871 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:56:21.170402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:56:21.170402 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:56:21.201917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f0c61c8-69a7-4a52-996f-b1586cc8689a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170FE7C5670>]}
[0m18:56:21.280279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f0c61c8-69a7-4a52-996f-b1586cc8689a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170FFE6B050>]}
[0m18:56:21.280279 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 476 macros
[0m18:56:21.280279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f0c61c8-69a7-4a52-996f-b1586cc8689a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170FFE3A120>]}
[0m18:56:21.280279 [info ] [MainThread]: 
[0m18:56:21.287292 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:56:21.287292 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m18:56:21.287292 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:21.772553 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m18:56:21.772553 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m18:56:21.772553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:21.772553 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m18:56:21.772553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:21.806180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:22.308485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f0c61c8-69a7-4a52-996f-b1586cc8689a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170FF87E9F0>]}
[0m18:56:22.309761 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:56:22.310857 [info ] [MainThread]: 
[0m18:56:22.310857 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_all_observations_analytics
[0m18:56:22.318868 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_analytics.airnow_all_observations_analytics  [RUN]
[0m18:56:22.320248 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_all_observations_analytics'
[0m18:56:22.321194 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_all_observations_analytics
[0m18:56:22.327401 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m18:56:22.327401 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_all_observations_analytics
[0m18:56:22.344071 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:56:22.745997 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m18:56:22.745997 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_all_observations_analytics: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_all_observations_analytics"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
      
    
    

    OPTIONS()
    as (
      /*** AirNow All Observations (Historical and Real-time) ***/
/**
Model UNIONs together historical and real-time AirNow observations. Real-time observations are averaged by day. 'HourObserved' column left out as data is at the day level.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
),

airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
),

airnow_hist_agg AS (
    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        MIN(Latitude) AS Latitude,
        MIN(Longitude) AS Longitude,
        ParameterName,
        ROUND(AVG(AQI)) AS AQI,
        MIN(AQICategory) AS AQICategory,
        ROUND(AVG(AQICategoryNumber)) AS AQICategoryNumber
    FROM airnow_hist_source
    GROUP BY
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName

),

airnow_realtime_agg AS (
    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        MIN(Latitude) AS Latitude,
        MIN(Longitude) AS Longitude,
        ParameterName,
        ROUND(AVG(AQI)) AS AQI,
        MIN(AQICategory) AS AQICategory,
        ROUND(AVG(AQICategoryNumber)) AS AQICategoryNumber
    FROM airnow_realtime_source
    GROUP BY
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName
),

airnow_all_observations_final AS (
    SELECT * FROM airnow_hist_agg
    UNION All
    SELECT * FROM airnow_realtime_agg
)


SELECT * FROM airnow_all_observations_final
    );
  
[0m18:56:23.619947 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:2cb9180a-2537-4a29-9ae6-04b93e027e54&page=queryresults
[0m18:56:25.784862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f0c61c8-69a7-4a52-996f-b1586cc8689a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170FF860440>]}
[0m18:56:25.784862 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_analytics.airnow_all_observations_analytics  [[32mCREATE TABLE (5.9k rows, 600.4 KiB processed)[0m in 3.46s]
[0m18:56:25.784862 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_all_observations_analytics
[0m18:56:25.784862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:56:25.792885 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m18:56:25.792885 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m18:56:25.792885 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m18:56:25.792885 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m18:56:25.792885 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_all_observations_analytics' was properly closed.
[0m18:56:25.792885 [info ] [MainThread]: 
[0m18:56:25.792885 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m18:56:25.792885 [debug] [MainThread]: Command end result
[0m18:56:25.817528 [info ] [MainThread]: 
[0m18:56:25.819623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:56:25.819831 [info ] [MainThread]: 
[0m18:56:25.819831 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:56:25.819831 [debug] [MainThread]: Command `cli run` succeeded at 18:56:25.819831 after 6.03 seconds
[0m18:56:25.819831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EBE26FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EB6EE0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000170EC029B50>]}
[0m18:56:25.819831 [debug] [MainThread]: Flushing usage events
[0m18:56:34.107794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C3AFA5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C38C7D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C5906480>]}


============================== 18:56:34.112513 | 1396fb32-975d-47a7-b97d-5edd623c7202 ==============================
[0m18:56:34.112513 [info ] [MainThread]: Running with dbt=1.8.6
[0m18:56:34.112513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m18:56:35.003777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1396fb32-975d-47a7-b97d-5edd623c7202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C38C7D70>]}
[0m18:56:35.051055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1396fb32-975d-47a7-b97d-5edd623c7202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201EED58860>]}
[0m18:56:35.052176 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m18:56:35.058480 [debug] [MainThread]: checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194, vars: {}, profile: , target: , version: 1.8.6
[0m18:56:35.187722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:56:35.187722 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:56:35.211561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1396fb32-975d-47a7-b97d-5edd623c7202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201EED8D670>]}
[0m18:56:35.294635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1396fb32-975d-47a7-b97d-5edd623c7202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F0D93D10>]}
[0m18:56:35.294635 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 476 macros
[0m18:56:35.294635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1396fb32-975d-47a7-b97d-5edd623c7202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F0C82F90>]}
[0m18:56:35.294635 [info ] [MainThread]: 
[0m18:56:35.294635 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:56:35.294635 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m18:56:35.294635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:36.137936 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m18:56:36.137936 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m18:56:36.137936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:36.137936 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m18:56:36.137936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:36.170193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:56:36.679394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1396fb32-975d-47a7-b97d-5edd623c7202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C3E996D0>]}
[0m18:56:36.679394 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:56:36.679394 [info ] [MainThread]: 
[0m18:56:36.690483 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_realtime_analytics
[0m18:56:36.690483 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_analytics.airnow_realtime_analytics ........ [RUN]
[0m18:56:36.690483 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_realtime_analytics'
[0m18:56:36.690483 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_realtime_analytics
[0m18:56:36.698093 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_realtime_analytics"
[0m18:56:36.698093 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_realtime_analytics
[0m18:56:36.711843 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:56:37.243758 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_realtime_analytics"
[0m18:56:37.243758 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_realtime_analytics: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_realtime_analytics"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_analytics`.`airnow_realtime_analytics`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Real-time Analytics Model ***/
/**
Model selects everything from the 'airnow_realtime_staging' table. This model/table will serve as the data source for the air quality notification script.
**/



WITH airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
)

SELECT * FROM airnow_realtime_source
    );
  
[0m18:56:37.659372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:50ebccf3-bffc-4695-892e-7d8437449d10&page=queryresults
[0m18:56:39.825298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1396fb32-975d-47a7-b97d-5edd623c7202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201EF2B20F0>]}
[0m18:56:39.825298 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_analytics.airnow_realtime_analytics ... [[32mCREATE TABLE (522.0 rows, 52.4 KiB processed)[0m in 3.13s]
[0m18:56:39.825298 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_realtime_analytics
[0m18:56:39.825298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:56:39.825298 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m18:56:39.825298 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m18:56:39.825298 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m18:56:39.825298 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m18:56:39.825298 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_realtime_analytics' was properly closed.
[0m18:56:39.825298 [info ] [MainThread]: 
[0m18:56:39.825298 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m18:56:39.825298 [debug] [MainThread]: Command end result
[0m18:56:39.853828 [info ] [MainThread]: 
[0m18:56:39.853828 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:56:39.853828 [info ] [MainThread]: 
[0m18:56:39.853828 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:56:39.861438 [debug] [MainThread]: Command `cli run` succeeded at 18:56:39.861438 after 5.89 seconds
[0m18:56:39.861438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C56955E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201F0E0C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201C3FB6600>]}
[0m18:56:39.863177 [debug] [MainThread]: Flushing usage events
[0m20:00:16.213249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C1B027FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C1B024350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C1B024AA0>]}


============================== 20:00:16.213249 | 51632643-672a-4b74-a0af-419581e4acca ==============================
[0m20:00:16.213249 [info ] [MainThread]: Running with dbt=1.8.6
[0m20:00:16.213249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:00:17.404421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51632643-672a-4b74-a0af-419581e4acca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C458D2510>]}
[0m20:00:17.451917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51632643-672a-4b74-a0af-419581e4acca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C42FA6CC0>]}
[0m20:00:17.451917 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m20:00:17.451917 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m20:00:17.526546 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m20:00:17.526546 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m20:00:17.526546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '51632643-672a-4b74-a0af-419581e4acca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C441AF260>]}
[0m20:00:18.299742 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:00:18.299742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '51632643-672a-4b74-a0af-419581e4acca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C45CF5040>]}
[0m20:00:18.547672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51632643-672a-4b74-a0af-419581e4acca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C45D3F950>]}
[0m20:00:18.626453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51632643-672a-4b74-a0af-419581e4acca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C45F37740>]}
[0m20:00:18.626453 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 476 macros
[0m20:00:18.626453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51632643-672a-4b74-a0af-419581e4acca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C1B141A60>]}
[0m20:00:18.626453 [info ] [MainThread]: 
[0m20:00:18.626453 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:00:18.626453 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m20:00:18.626453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:19.122756 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m20:00:19.122756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:19.122756 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m20:00:19.122756 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m20:00:19.122756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:19.154005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:19.709410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51632643-672a-4b74-a0af-419581e4acca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C45A338F0>]}
[0m20:00:19.710509 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:00:19.710677 [info ] [MainThread]: 
[0m20:00:19.717677 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_all_observations_analytics
[0m20:00:19.718770 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_analytics.airnow_all_observations_analytics  [RUN]
[0m20:00:19.718770 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_all_observations_analytics'
[0m20:00:19.720269 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_all_observations_analytics
[0m20:00:19.730043 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m20:00:19.730043 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_all_observations_analytics
[0m20:00:19.743103 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:00:20.269355 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m20:00:20.269355 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_all_observations_analytics: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_all_observations_analytics"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
      
    
    

    OPTIONS()
    as (
      /*** AirNow All Observations (Historical and Real-time) ***/
/**
Model UNIONs together historical and real-time AirNow observations. Real-time observations are averaged by day. 'HourObserved' column left out as data is at the day level.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
),

airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
),

airnow_hist_agg AS (
    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        MIN(Latitude) AS Latitude,
        MIN(Longitude) AS Longitude,
        CASE
            WHEN ParameterName = 'OZONE' THEN 'O3'
            ELSE ParameterName
        END AS ParameterName,
        ROUND(AVG(AQI)) AS AQI,
        MIN(AQICategory) AS AQICategory,
        ROUND(AVG(AQICategoryNumber)) AS AQICategoryNumber
    FROM airnow_hist_source
    GROUP BY
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName

),

airnow_realtime_agg AS (
    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        MIN(Latitude) AS Latitude,
        MIN(Longitude) AS Longitude,
        ParameterName,
        ROUND(AVG(AQI)) AS AQI,
        MIN(AQICategory) AS AQICategory,
        ROUND(AVG(AQICategoryNumber)) AS AQICategoryNumber
    FROM airnow_realtime_source
    GROUP BY
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName
),

airnow_all_observations_final AS (
    SELECT * FROM airnow_hist_agg
    UNION All
    SELECT * FROM airnow_realtime_agg
)


SELECT * FROM airnow_all_observations_final
    );
  
[0m20:00:20.859715 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:50bf9802-30ab-4dfa-8cac-ebdc0dfe2506&page=queryresults
[0m20:00:23.741368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51632643-672a-4b74-a0af-419581e4acca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C4403C440>]}
[0m20:00:23.741368 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_analytics.airnow_all_observations_analytics  [[32mCREATE TABLE (5.9k rows, 600.4 KiB processed)[0m in 4.02s]
[0m20:00:23.741368 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_all_observations_analytics
[0m20:00:23.746877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:23.747712 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m20:00:23.747712 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m20:00:23.747712 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m20:00:23.747712 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m20:00:23.747712 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_all_observations_analytics' was properly closed.
[0m20:00:23.747712 [info ] [MainThread]: 
[0m20:00:23.747712 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.12 seconds (5.12s).
[0m20:00:23.747712 [debug] [MainThread]: Command end result
[0m20:00:23.771106 [info ] [MainThread]: 
[0m20:00:23.773674 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:23.774773 [info ] [MainThread]: 
[0m20:00:23.775252 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:00:23.775252 [debug] [MainThread]: Command `cli run` succeeded at 20:00:23.775252 after 7.70 seconds
[0m20:00:23.777033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C1B069C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C1B069280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029C459715E0>]}
[0m20:00:23.777033 [debug] [MainThread]: Flushing usage events
[0m12:00:41.430153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001930FA43B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001931165BCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019311658470>]}


============================== 12:00:41.485329 | f9518b20-14e8-4f31-b534-23e115d58045 ==============================
[0m12:00:41.485329 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:00:41.485329 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:00:42.384194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9518b20-14e8-4f31-b534-23e115d58045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019311CADF10>]}
[0m12:00:42.434220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9518b20-14e8-4f31-b534-23e115d58045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001933B02DD90>]}
[0m12:00:42.434220 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:00:42.434220 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m12:00:42.500920 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:00:42.500920 [debug] [MainThread]: previous checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, current checksum: 2f2fb10c73cafe3e79aa104295a8244291492b32b5598ce46af770f7d0bd5194
[0m12:00:42.514422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f9518b20-14e8-4f31-b534-23e115d58045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001933D101B20>]}
[0m12:00:43.294401 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m12:00:43.294401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f9518b20-14e8-4f31-b534-23e115d58045', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001933CFD4EC0>]}
[0m12:00:43.535306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9518b20-14e8-4f31-b534-23e115d58045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001933D213170>]}
[0m12:00:43.667827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9518b20-14e8-4f31-b534-23e115d58045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001933D1C9E20>]}
[0m12:00:43.667827 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 476 macros
[0m12:00:43.667827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9518b20-14e8-4f31-b534-23e115d58045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001933D1E8110>]}
[0m12:00:43.667827 [info ] [MainThread]: 
[0m12:00:43.667827 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:00:43.667827 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m12:00:43.667827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:44.284487 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m12:00:44.297304 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m12:00:44.297304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:44.299873 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m12:00:44.300338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:44.316723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:44.900540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9518b20-14e8-4f31-b534-23e115d58045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001933D2566F0>]}
[0m12:00:44.900540 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:00:44.900540 [info ] [MainThread]: 
[0m12:00:44.927810 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_hist_stage
[0m12:00:44.927810 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_hist_stage .................. [RUN]
[0m12:00:44.931627 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_hist_stage'
[0m12:00:44.931902 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_hist_stage
[0m12:00:44.942115 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_hist_stage"
[0m12:00:44.942115 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_hist_stage
[0m12:00:44.954259 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:00:45.449971 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_hist_stage"
[0m12:00:45.449971 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_hist_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_hist_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Historical Observations Staging Model ***/
/**
The below model converts all columns, except for 'DateObserved,' to the correct data type. 'DateObserved' is already
a TIMESTAMP data type.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`
),

airnow_hist_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_hist_source
),

airnow_hist_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        Latitude_update AS Latitude,
        Longitude_update AS Longitude,
        ParameterName,
        AQI_update AS AQI,
        AQICategory,
        AQICategoryNumber
    FROM airnow_hist_update
)

SELECT 
    * 
FROM airnow_hist_final
    );
  
[0m12:00:46.217216 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:cd24f702-cd4f-4f0c-8100-ebae15cb83bc&page=queryresults
[0m12:00:51.160270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9518b20-14e8-4f31-b534-23e115d58045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001933B4C2480>]}
[0m12:00:51.160270 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_hist_stage ............. [[32mCREATE TABLE (5.9k rows, 573.9 KiB processed)[0m in 6.23s]
[0m12:00:51.160270 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_hist_stage
[0m12:00:51.163879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:51.165386 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m12:00:51.165386 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m12:00:51.165386 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m12:00:51.165386 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m12:00:51.165386 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_hist_stage' was properly closed.
[0m12:00:51.165386 [info ] [MainThread]: 
[0m12:00:51.165386 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.50 seconds (7.50s).
[0m12:00:51.168770 [debug] [MainThread]: Command end result
[0m12:00:51.199838 [info ] [MainThread]: 
[0m12:00:51.200784 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:00:51.203183 [info ] [MainThread]: 
[0m12:00:51.204187 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:00:51.205703 [debug] [MainThread]: Command `cli run` succeeded at 12:00:51.205703 after 9.91 seconds
[0m12:00:51.207040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193120B52E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193120B5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000193120B6F30>]}
[0m12:00:51.207040 [debug] [MainThread]: Flushing usage events
[0m12:01:01.020083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016563CDBDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656587E2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165666A1790>]}


============================== 12:01:01.025503 | cc09dcae-9ae2-4217-ab08-f1353da6a266 ==============================
[0m12:01:01.025503 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:01:01.026170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:01:01.891982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc09dcae-9ae2-4217-ab08-f1353da6a266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001657FAE78F0>]}
[0m12:01:01.941998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc09dcae-9ae2-4217-ab08-f1353da6a266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001657FFB0590>]}
[0m12:01:01.941998 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:01:01.941998 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m12:01:02.075090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:01:02.075090 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:01:02.108512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc09dcae-9ae2-4217-ab08-f1353da6a266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656587CD10>]}
[0m12:01:02.191902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc09dcae-9ae2-4217-ab08-f1353da6a266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165113DE030>]}
[0m12:01:02.191902 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 476 macros
[0m12:01:02.191902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc09dcae-9ae2-4217-ab08-f1353da6a266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165110C8A40>]}
[0m12:01:02.191902 [info ] [MainThread]: 
[0m12:01:02.191902 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:01:02.191902 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m12:01:02.191902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:02.820417 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m12:01:02.820417 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m12:01:02.825671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:02.825671 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m12:01:02.825671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:02.854959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:03.409428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc09dcae-9ae2-4217-ab08-f1353da6a266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016511131040>]}
[0m12:01:03.409428 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:01:03.409428 [info ] [MainThread]: 
[0m12:01:03.418469 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_realtime_stage
[0m12:01:03.418469 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_staging.airnow_realtime_stage .............. [RUN]
[0m12:01:03.418469 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_realtime_stage'
[0m12:01:03.424306 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_realtime_stage
[0m12:01:03.426860 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_realtime_stage"
[0m12:01:03.426860 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_realtime_stage
[0m12:01:03.443076 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:01:03.888223 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_realtime_stage"
[0m12:01:03.891101 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_realtime_stage: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_realtime_stage"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Real-time Observations Staging Model ***/
/**
The below model converts all columns, except for 'DataPulledAt' and 'DateObserved,' to the correct data type.
'DataPulledAt' and 'DateObserverd' are already TIMESTAMP data types.
**/



WITH airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_raw_realtime`
),

airnow_realtime_update AS (
    SELECT
        *,
        CAST(HourObserved AS INT) AS HourObserved_update,
        CAST(Latitude AS DECIMAL) AS Latitude_update,
        CAST(Longitude AS DECIMAL) AS Longitude_update,
        CAST(AQI AS INT) AQI_update,
        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,
        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber
    FROM airnow_realtime_source
),

airnow_realtime_final AS (
    SELECT
        DateObserved,
        HourObserved_update AS HourObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        AVG(Latitude_update) AS Latitude,
        AVG(Longitude_update) AS Longitude,
        ParameterName,
        AVG(AQI_update) AS AQI,
        AQICategory,
        AVG(AQICategoryNumber) AS AQICategoryNumber
    FROM airnow_realtime_update
    GROUP BY
        DateObserved,
        HourObserved_update,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName,
        AQICategory
        
)

SELECT
    *
FROM airnow_realtime_final
    );
  
[0m12:01:04.358141 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:a472c935-c7ce-4b2f-8d71-f7b6418bbed7&page=queryresults
[0m12:01:07.237721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc09dcae-9ae2-4217-ab08-f1353da6a266', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001657F6D20F0>]}
[0m12:01:07.239416 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_staging.airnow_realtime_stage ......... [[32mCREATE TABLE (1.8k rows, 318.6 KiB processed)[0m in 3.82s]
[0m12:01:07.239826 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_realtime_stage
[0m12:01:07.239826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:07.239826 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m12:01:07.239826 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m12:01:07.239826 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m12:01:07.239826 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m12:01:07.239826 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_realtime_stage' was properly closed.
[0m12:01:07.239826 [info ] [MainThread]: 
[0m12:01:07.239826 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.05 seconds (5.05s).
[0m12:01:07.245523 [debug] [MainThread]: Command end result
[0m12:01:07.259869 [info ] [MainThread]: 
[0m12:01:07.269372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:01:07.269372 [info ] [MainThread]: 
[0m12:01:07.270540 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:01:07.271294 [debug] [MainThread]: Command `cli run` succeeded at 12:01:07.271294 after 6.40 seconds
[0m12:01:07.271294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001656430A6F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016565B5D400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165663320F0>]}
[0m12:01:07.271294 [debug] [MainThread]: Flushing usage events
[0m12:01:23.430064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002924EAF0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292511B3500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292508C6780>]}


============================== 12:01:23.430064 | 6513a72e-8de2-4486-8d97-c1918f5dba48 ==============================
[0m12:01:23.430064 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:01:23.430064 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:01:24.329177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6513a72e-8de2-4486-8d97-c1918f5dba48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029279EB2CF0>]}
[0m12:01:24.362866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6513a72e-8de2-4486-8d97-c1918f5dba48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029251604FB0>]}
[0m12:01:24.362866 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:01:24.372909 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m12:01:24.513694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:01:24.529525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:01:24.562653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6513a72e-8de2-4486-8d97-c1918f5dba48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002927BFA1AF0>]}
[0m12:01:24.629384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6513a72e-8de2-4486-8d97-c1918f5dba48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002927BFD43E0>]}
[0m12:01:24.629384 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 476 macros
[0m12:01:24.629384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6513a72e-8de2-4486-8d97-c1918f5dba48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002927C1F73E0>]}
[0m12:01:24.629384 [info ] [MainThread]: 
[0m12:01:24.645066 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:01:24.646498 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m12:01:24.647001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:25.279866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m12:01:25.279866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m12:01:25.279866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:25.279866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m12:01:25.279866 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:25.312658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:25.862011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6513a72e-8de2-4486-8d97-c1918f5dba48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002927A556330>]}
[0m12:01:25.862787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:01:25.862787 [info ] [MainThread]: 
[0m12:01:25.862787 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_realtime_analytics
[0m12:01:25.862787 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_analytics.airnow_realtime_analytics ........ [RUN]
[0m12:01:25.862787 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_realtime_analytics'
[0m12:01:25.862787 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_realtime_analytics
[0m12:01:25.883901 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_realtime_analytics"
[0m12:01:25.930587 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_realtime_analytics
[0m12:01:25.945767 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:01:26.497345 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_realtime_analytics"
[0m12:01:26.529001 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_realtime_analytics: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_realtime_analytics"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_analytics`.`airnow_realtime_analytics`
      
    
    

    OPTIONS()
    as (
      /*** AirNow Real-time Analytics Model ***/
/**
Model selects everything from the 'airnow_realtime_staging' table. This model/table will serve as the data source for the air quality notification script.
**/



WITH airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
)

SELECT * FROM airnow_realtime_source
    );
  
[0m12:01:27.390507 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:e57ab2e9-b2dc-4392-a877-03ff2f775152&page=queryresults
[0m12:01:29.660666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6513a72e-8de2-4486-8d97-c1918f5dba48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002927A4C2990>]}
[0m12:01:29.660666 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_analytics.airnow_realtime_analytics ... [[32mCREATE TABLE (1.8k rows, 177.0 KiB processed)[0m in 3.80s]
[0m12:01:29.660666 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_realtime_analytics
[0m12:01:29.660666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:29.660666 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m12:01:29.660666 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m12:01:29.660666 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m12:01:29.660666 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m12:01:29.660666 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_realtime_analytics' was properly closed.
[0m12:01:29.660666 [info ] [MainThread]: 
[0m12:01:29.660666 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m12:01:29.673186 [debug] [MainThread]: Command end result
[0m12:01:29.699367 [info ] [MainThread]: 
[0m12:01:29.699367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:01:29.699367 [info ] [MainThread]: 
[0m12:01:29.699367 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:01:29.699367 [debug] [MainThread]: Command `cli run` succeeded at 12:01:29.699367 after 6.40 seconds
[0m12:01:29.699367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002924EAF0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029250B77410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002924E639D60>]}
[0m12:01:29.699367 [debug] [MainThread]: Flushing usage events
[0m12:01:40.631265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAA5F80050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAA87FAFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAA46C4680>]}


============================== 12:01:40.631718 | fcfd2f26-a463-46f3-8666-98248f1c24d9 ==============================
[0m12:01:40.631718 [info ] [MainThread]: Running with dbt=1.8.6
[0m12:01:40.631718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\logs', 'profiles_dir': 'C:\\Users\\javier.flores\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:01:41.598102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcfd2f26-a463-46f3-8666-98248f1c24d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD3367020>]}
[0m12:01:41.648936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcfd2f26-a463-46f3-8666-98248f1c24d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD13E2930>]}
[0m12:01:41.648936 [info ] [MainThread]: Registered adapter: bigquery=1.8.2
[0m12:01:41.663664 [debug] [MainThread]: checksum: 7f1b5963847f68bbeefdf98b5bcbf66dba848657b49cadc1561f68b0d2bab887, vars: {}, profile: , target: dev, version: 1.8.6
[0m12:01:41.800773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:01:41.800773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:01:41.831619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcfd2f26-a463-46f3-8666-98248f1c24d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD34316A0>]}
[0m12:01:41.914421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcfd2f26-a463-46f3-8666-98248f1c24d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD369E6F0>]}
[0m12:01:41.925923 [info ] [MainThread]: Found 6 models, 8 data tests, 2 sources, 476 macros
[0m12:01:41.925923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcfd2f26-a463-46f3-8666-98248f1c24d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAA8A96810>]}
[0m12:01:41.925923 [info ] [MainThread]: 
[0m12:01:41.925923 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:01:41.933097 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6'
[0m12:01:41.933097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:42.450878 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow'
[0m12:01:42.450878 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_analytics'
[0m12:01:42.450878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:42.450878 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_key-polymer-434418-m6_airnow_staging'
[0m12:01:42.450878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:42.477577 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:01:43.130131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcfd2f26-a463-46f3-8666-98248f1c24d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD365E480>]}
[0m12:01:43.130131 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:01:43.138142 [info ] [MainThread]: 
[0m12:01:43.138142 [debug] [Thread-1 (]: Began running node model.airnow_dbt.airnow_all_observations_analytics
[0m12:01:43.138142 [info ] [Thread-1 (]: 1 of 1 START sql table model airnow_analytics.airnow_all_observations_analytics  [RUN]
[0m12:01:43.138142 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.airnow_dbt.airnow_all_observations_analytics'
[0m12:01:43.143769 [debug] [Thread-1 (]: Began compiling node model.airnow_dbt.airnow_all_observations_analytics
[0m12:01:43.151725 [debug] [Thread-1 (]: Writing injected SQL for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m12:01:43.166392 [debug] [Thread-1 (]: Began executing node model.airnow_dbt.airnow_all_observations_analytics
[0m12:01:43.170543 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:01:43.793463 [debug] [Thread-1 (]: Writing runtime sql for node "model.airnow_dbt.airnow_all_observations_analytics"
[0m12:01:43.793463 [debug] [Thread-1 (]: On model.airnow_dbt.airnow_all_observations_analytics: /* {"app": "dbt", "dbt_version": "1.8.6", "profile_name": "airnow_dbt", "target_name": "dev", "node_id": "model.airnow_dbt.airnow_all_observations_analytics"} */

  
    

    create or replace table `key-polymer-434418-m6`.`airnow_analytics`.`airnow_all_observations_analytics`
      
    
    

    OPTIONS()
    as (
      /*** AirNow All Observations (Historical and Real-time) ***/
/**
Model UNIONs together historical and real-time AirNow observations. Real-time observations are averaged by day. 'HourObserved' column left out as data is at the day level.
**/



WITH airnow_hist_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`
),

airnow_realtime_source AS (
    SELECT * FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_realtime_stage`
),

airnow_hist_agg AS (
    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        MIN(Latitude) AS Latitude,
        MIN(Longitude) AS Longitude,
        CASE
            WHEN ParameterName = 'OZONE' THEN 'O3'
            ELSE ParameterName
        END AS ParameterName,
        ROUND(AVG(AQI)) AS AQI,
        MIN(AQICategory) AS AQICategory,
        ROUND(AVG(AQICategoryNumber)) AS AQICategoryNumber
    FROM airnow_hist_source
    GROUP BY
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName

),

airnow_realtime_agg AS (
    SELECT
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        MIN(Latitude) AS Latitude,
        MIN(Longitude) AS Longitude,
        ParameterName,
        ROUND(AVG(AQI)) AS AQI,
        MIN(AQICategory) AS AQICategory,
        ROUND(AVG(AQICategoryNumber)) AS AQICategoryNumber
    FROM airnow_realtime_source
    GROUP BY
        DateObserved,
        LocalTimeZone,
        ReportingArea,
        StateCode,
        ParameterName
),

airnow_all_observations_final AS (
    SELECT * FROM airnow_hist_agg
    UNION All
    SELECT * FROM airnow_realtime_agg
)


SELECT * FROM airnow_all_observations_final
    );
  
[0m12:01:44.213689 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=key-polymer-434418-m6&j=bq:US:4676bc2b-0082-461e-8399-c81ac78dda60&page=queryresults
[0m12:01:46.807365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcfd2f26-a463-46f3-8666-98248f1c24d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAD3566360>]}
[0m12:01:46.809419 [info ] [Thread-1 (]: 1 of 1 OK created sql table model airnow_analytics.airnow_all_observations_analytics  [[32mCREATE TABLE (6.0k rows, 715.3 KiB processed)[0m in 3.67s]
[0m12:01:46.810435 [debug] [Thread-1 (]: Finished running node model.airnow_dbt.airnow_all_observations_analytics
[0m12:01:46.812759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:01:46.813767 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6' was properly closed.
[0m12:01:46.814792 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow' was properly closed.
[0m12:01:46.815819 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_analytics' was properly closed.
[0m12:01:46.815819 [debug] [MainThread]: Connection 'list_key-polymer-434418-m6_airnow_staging' was properly closed.
[0m12:01:46.815819 [debug] [MainThread]: Connection 'model.airnow_dbt.airnow_all_observations_analytics' was properly closed.
[0m12:01:46.815819 [info ] [MainThread]: 
[0m12:01:46.815819 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m12:01:46.820632 [debug] [MainThread]: Command end result
[0m12:01:46.867107 [info ] [MainThread]: 
[0m12:01:46.877703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:01:46.878529 [info ] [MainThread]: 
[0m12:01:46.879262 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:01:46.879262 [debug] [MainThread]: Command `cli run` succeeded at 12:01:46.879262 after 6.39 seconds
[0m12:01:46.879262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAA50A8F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAA89216A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DAA8709E80>]}
[0m12:01:46.879262 [debug] [MainThread]: Flushing usage events
