{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.6", "generated_at": "2024-10-27T22:40:17.433440Z", "invocation_id": "91353f12-0699-46a0-ada2-8cc9fd359b65", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-10-27T22:40:09.999993Z", "completed_at": "2024-10-27T22:40:10.006112Z"}, {"name": "execute", "started_at": "2024-10-27T22:40:10.006112Z", "completed_at": "2024-10-27T22:40:15.785148Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.796964645385742, "adapter_response": {"_message": "CREATE TABLE (5.9k rows, 573.9 KiB processed)", "code": "CREATE TABLE", "rows_affected": 5877, "bytes_processed": 587686, "bytes_billed": 10485760, "location": "US", "project_id": "key-polymer-434418-m6", "job_id": "20e3888a-5781-4050-ab1b-737a2309ec1e", "slot_ms": 130021}, "message": "CREATE TABLE (5.9k rows, 573.9 KiB processed)", "failures": null, "unique_id": "model.airnow_dbt.airnow_hist_stage", "compiled": true, "compiled_code": "/*** AirNow Historical Observations Staging Model ***/\n/**\nThe below model converts all columns, except for 'DateObserved,' to the correct data type. 'DateObserved' is already\na TIMESTAMP data type.\n**/\n\n\n\nWITH airnow_hist_source AS (\n    SELECT * FROM `key-polymer-434418-m6`.`airnow_raw`.`airnow_hist_raw`\n),\n\nairnow_hist_update AS (\n    SELECT\n        *,\n        CAST(HourObserved AS INT) AS HourObserved_update,\n        CAST(Latitude AS DECIMAL) AS Latitude_update,\n        CAST(Longitude AS DECIMAL) AS Longitude_update,\n        CAST(AQI AS INT) AQI_update,\n        JSON_EXTRACT_SCALAR(Category, '$.Name') AS AQICategory,\n        CAST(JSON_EXTRACT_SCALAR(Category, '$.Number') AS INT) AS AQICategoryNumber\n    FROM airnow_hist_source\n),\n\nairnow_hist_final AS (\n    SELECT\n        DateObserved,\n        HourObserved_update AS HourObserved,\n        LocalTimeZone,\n        ReportingArea,\n        StateCode,\n        Latitude_update AS Latitude,\n        Longitude_update AS Longitude,\n        ParameterName,\n        AQI_update AS AQI,\n        AQICategory,\n        AQICategoryNumber\n    FROM airnow_hist_update\n)\n\nSELECT \n    * \nFROM airnow_hist_final", "relation_name": "`key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`"}, {"status": "warn", "timing": [{"name": "compile", "started_at": "2024-10-27T22:40:15.785148Z", "completed_at": "2024-10-27T22:40:15.806719Z"}, {"name": "execute", "started_at": "2024-10-27T22:40:15.806719Z", "completed_at": "2024-10-27T22:40:17.414844Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.6296956539154053, "adapter_response": {"_message": "SELECT (1.0 rows, 45.9 KiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 47016, "bytes_billed": 10485760, "location": "US", "project_id": "key-polymer-434418-m6", "job_id": "8426345c-7922-42f4-9d0d-b6129beee72d", "slot_ms": 6083}, "message": "Got 1 result, configured to warn if != 0", "failures": 1, "unique_id": "test.airnow_dbt.missing_dates_airnow_hist_stage_DateObserved.bcd36c5d99", "compiled": true, "compiled_code": "\n\n\n\nWITH date_range AS (\n    -- Dynamically calculate the minimum and maximum dates in the data\n    SELECT\n        MIN(DATE(DateObserved)) AS start_date,\n        MAX(DATE(DateObserved)) AS end_date\n    FROM\n        `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`\n),\n\ndate_spine AS (\n    -- Generate a date spine based on the calculated start and end dates\n    SELECT\n        start_date + INTERVAL n DAY AS date_day\n    FROM\n        date_range,\n        UNNEST(GENERATE_ARRAY(0, DATE_DIFF(end_date, start_date, DAY))) AS n\n),\n\nmissing_dates AS (\n    -- Find the missing dates by performing a LEFT JOIN between the date spine and the actual data\n    SELECT\n        ds.date_day\n    FROM\n        date_spine ds\n    LEFT JOIN (\n        SELECT DISTINCT DATE(DateObserved) AS date_day\n        FROM `key-polymer-434418-m6`.`airnow_staging`.`airnow_hist_stage`\n    ) AS model_dates\n    ON ds.date_day = model_dates.date_day\n    WHERE model_dates.date_day IS NULL\n)\n\n-- Return the missing dates\nSELECT *\nFROM missing_dates\n\n", "relation_name": null}], "elapsed_time": 8.411031723022461, "args": {"show_resource_report": false, "log_format_file": "json", "project_dir": "C:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt", "indirect_selection": "eager", "defer": false, "macro_debugging": false, "use_colors_file": true, "target_path": "target\\airnow_dbt_dbt_assets-6230595-e90b308", "favor_state": false, "source_freshness_run_project_hooks": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "json", "printer_width": 80, "resource_types": [], "require_resource_names_without_spaces": false, "vars": {}, "exclude_resource_types": [], "log_level_file": "debug", "exclude": [], "introspect": true, "print": true, "send_anonymous_usage_stats": false, "partial_parse": true, "populate_cache": true, "partial_parse_file_diff": true, "show": false, "quiet": false, "export_saved_queries": false, "enable_legacy_logger": false, "log_file_max_bytes": 10485760, "static_parser": true, "include_saved_query": false, "use_colors": true, "profiles_dir": "C:\\Users\\javier.flores\\.dbt", "version_check": true, "log_path": "C:\\Users\\javier.flores\\Desktop\\Portfolio\\Air Quality Data Streaming and Anomaly Detection\\airnow_dbt\\target\\airnow_dbt_dbt_assets-6230595-e90b308", "warn_error_options": {"include": [], "exclude": []}, "empty": false, "invocation_command": "dbt build --select airnow_dbt.airnow_staging.airnow_hist_stage", "cache_selected_only": false, "select": ["airnow_dbt.airnow_staging.airnow_hist_stage"], "strict_mode": false, "which": "build", "write_json": true, "log_level": "info"}}